
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hurst Exponent &#8212; Quantflow library</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-CM0DR45HDR"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-CM0DR45HDR');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-CM0DR45HDR');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'applications/hurst';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../_static/quantflow-logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Calibration" href="calibration.html" />
    <link rel="prev" title="Volatility Surface" href="volatility_surface.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/quantflow-light.svg" class="logo__image only-light" alt="Quantflow library - Home"/>
    <script>document.write(`<img src="../_static/quantflow-light.svg" class="logo__image only-dark" alt="Quantflow library - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Topic Guides</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../theory/overview.html">Theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/levy.html">LÃ©vy process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/characteristic.html">Characteristic Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/inversion.html">From Characteristic Function to PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/option_pricing.html">Option Pricing</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../models/overview.html">Stochastic Processes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/weiner.html">Weiner Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/poisson.html">Poisson Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/jump_diffusion.html">Jump Diffusion Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/cir.html">CIR process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/ou.html">OU Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/heston.html">Heston Model and Option Pricing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/heston_jumps.html">Heston Model with Jumps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/bns.html">BNS Model</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="overview.html">Applications</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="volatility_surface.html">Volatility Surface</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Hurst Exponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="calibration.html">Calibration</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/overview.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/gaussian_sampling.html">Gaussian Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/exponential_sampling.html">Exponential Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/poisson_sampling.html">Poisson Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/heston_vol_surface.html">HestonJ Volatility Surface</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/sp/index.html">Stochastic Process</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/sp/weiner.html">Weiner process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/sp/poisson.html">Poisson process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/sp/compound_poisson.html">Compound Poisson</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/sp/ou.html">OU Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/sp/cir.html">CIR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/sp/jump_diffusion.html">Jump diffusions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/sp/heston.html">Heston process</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/options/index.html">Option Pricing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/options/vol_surface.html">Vol Surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/options/black.html">Black Pricing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/options/pricer.html">Option Pricer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/options/calibration.html">Vol Model Calibration</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/ta/index.html">Timeseries Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/ta/ohlc.html">OHLC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ta/paths.html">Paths</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/data/index.html">Data fetching</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/data/fmp.html">FMP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data/fed.html">Federal Reserve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data/fred.html">Fred</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data/deribit.html">Deribit</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/utils/index.html">Utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/utils/marginal1d.html">Marginal1D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils/distributions.html">Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils/bins.html">Bins</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/biblio.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/quantmind/quantflow" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/quantmind/quantflow/edit/main/notebooks/applications/hurst.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/quantmind/quantflow/issues/new?title=Issue%20on%20page%20%2Fapplications/hurst.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/applications/hurst.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hurst Exponent</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#study-with-the-weiner-process">Study with the Weiner Process</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#realized-variance">Realized Variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#range-based-variance-estimators">Range-based Variance Estimators</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-reverting-time-series">Mean Reverting Time Series</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hurst-exponent">
<h1>Hurst Exponent<a class="headerlink" href="#hurst-exponent" title="Link to this heading">#</a></h1>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Hurst_exponent">Hurst exponent</a> is used as a measure of long-term memory of time series. It relates to the auto-correlations of the time series, and the rate at which these decrease as the lag between pairs of values increases.
It is a statistics which can be used to test if a time-series is mean reverting or it is trending.</p>
<p>The idea idea behind the Hurst exponent is that if the time-series <span class="math notranslate nohighlight">\(x_t\)</span> follows a Brownian motion (aka Weiner process), than variance between two time points will increase linearly with the time difference. that is to say</p>
<div class="amsmath math notranslate nohighlight" id="equation-7ceb8a45-cbb6-4626-810d-115ad399c95c">
<span class="eqno">(71)<a class="headerlink" href="#equation-7ceb8a45-cbb6-4626-810d-115ad399c95c" title="Permalink to this equation">#</a></span>\[\begin{align}
  \text{Var}(x_{t_2} - x_{t_1}) &amp;\propto t_2 - t_1 \\
  &amp;\propto \Delta t^{2H}\\
  H &amp;= 0.5
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the Hurst exponent.</p>
<p>Trending time-series have a Hurst exponent H &gt; 0.5, while mean reverting time-series have H &lt; 0.5. Understanding in which regime a time-series is can be useful for trading strategies.</p>
<p>These are some references to understand the Hurst exponent and its applications:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://robotwealth.com/demystifying-the-hurst-exponent-part-1/">Hurst Exponent for Algorithmic Trading</a></p></li>
<li><p><a class="reference external" href="https://www.quantstart.com/articles/Basics-of-Statistical-Mean-Reversion-Testing/">Basics of Statistical Mean Reversion Testing</a></p></li>
</ul>
<section id="study-with-the-weiner-process">
<h2>Study with the Weiner Process<a class="headerlink" href="#study-with-the-weiner-process" title="Link to this heading">#</a></h2>
<p>We want to construct a mechanism to estimate the Hurst exponent via OHLC data because it is widely available from data providers and easily constructed as an online signal during trading.</p>
<p>In order to evaluate results against known solutions, we consider the Weiner process as generator of timeseries.</p>
<p>The Weiner process is a continuous-time stochastic process named in honor of Norbert Wiener. It is often also called Brownian motion due to its historical connection with the physical model of Brownian motion of particles in water, named after the botanist Robert Brown.</p>
<p>We use the <strong>WeinerProcess</strong> from the stochastic process library and sample one path over a time horizon of 1 (day) with a time step every second.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quantflow.sp.weiner</span><span class="w"> </span><span class="kn">import</span> <span class="n">WeinerProcess</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">WeinerProcess</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="n">paths</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;A path of Weiner process with sigma=2.0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>In order to down-sample the timeseries, we need to convert it into a dataframe with dates as indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quantflow.utils.dates</span><span class="w"> </span><span class="kn">import</span> <span class="n">start_of_day</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">as_datetime_df</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start_of_day</span><span class="p">(),</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2025-08-09 00:00:00+00:00</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2025-08-09 00:00:01+00:00</td>
      <td>0.001325</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2025-08-09 00:00:02+00:00</td>
      <td>-0.004871</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2025-08-09 00:00:03+00:00</td>
      <td>0.007963</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2025-08-09 00:00:04+00:00</td>
      <td>-0.000483</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>86396</th>
      <td>2025-08-09 23:59:56+00:00</td>
      <td>-1.505411</td>
    </tr>
    <tr>
      <th>86397</th>
      <td>2025-08-09 23:59:57+00:00</td>
      <td>-1.499599</td>
    </tr>
    <tr>
      <th>86398</th>
      <td>2025-08-09 23:59:58+00:00</td>
      <td>-1.497939</td>
    </tr>
    <tr>
      <th>86399</th>
      <td>2025-08-09 23:59:59+00:00</td>
      <td>-1.496327</td>
    </tr>
    <tr>
      <th>86400</th>
      <td>2025-08-10 00:00:00+00:00</td>
      <td>-1.491975</td>
    </tr>
  </tbody>
</table>
<p>86401 rows Ã 2 columns</p>
</div></div></div>
</div>
<section id="realized-variance">
<h3>Realized Variance<a class="headerlink" href="#realized-variance" title="Link to this heading">#</a></h3>
<p>At this point we estimate the standard deviation using the <strong>realized variance</strong> along the path (we use the <strong>scaled</strong> flag so that the standard deviation is scaled by the square-root of time step, in this way it removes the dependency on the time step size).
The value should be close to the <strong>sigma</strong> of the WeinerProcess defined above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">paths_std</span><span class="p">(</span><span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0030783033888
</pre></div>
</div>
</div>
</div>
<p>The evaluation of the hurst exponent is done by calculating the variance for several time windows and by fitting a line to the log-log plot of the variance vs the time window.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paths</span><span class="o">.</span><span class="n">hurst_exponent</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.49287749045851975
</pre></div>
</div>
</div>
</div>
<p>As expected, the Hurst exponent should be close to 0.5, since we have calculated the exponent from the paths of a Weiner process.</p>
</section>
<section id="range-based-variance-estimators">
<h3>Range-based Variance Estimators<a class="headerlink" href="#range-based-variance-estimators" title="Link to this heading">#</a></h3>
<p>We now turn our attention to range-based variance estimators. These estimators depends on OHLC timeseries, which are widely available from data providers such as <a class="reference external" href="https://site.financialmodelingprep.com/">FMP</a>.
To analyze range-based variance estimators, we use he <strong>quantflow.ta.OHLC</strong> tool which allows to down-sample a timeserie to OHLC series and estimate variance with three different estimators</p>
<ul class="simple">
<li><p><strong>Parkinson</strong> (1980)</p></li>
<li><p><strong>Garman &amp; Klass</strong> (1980)</p></li>
<li><p><strong>Rogers &amp; Satchell</strong> (1991)</p></li>
</ul>
<p>See <span id="id1">[<a class="reference internal" href="../reference/biblio.html#id16" title="Peter Molnar. Volatility modeling and forecasting: utilization of realized volatility, implied volatility and the highest and lowest price of the day. Master's thesis, University of Economics in Prague, 2020. URL: https://drive.google.com/file/d/1zCU1OZyrKQLpxaypPv9U5UPbReBDXcMf/view.">Mol20</a>]</span> for a detailed overview of the properties of range-based estimators.</p>
<p>For this we build an OHLC estimator as template and use it to create OHLC estimators for different periods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quantflow.ta.ohlc</span><span class="w"> </span><span class="kn">import</span> <span class="n">OHLC</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">OHLC</span><span class="p">(</span><span class="n">serie</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s2">&quot;10m&quot;</span><span class="p">,</span> <span class="n">rogers_satchell_variance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parkinson_variance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">garman_klass_variance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">seconds_in_day</span> <span class="o">=</span> <span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rstd</span><span class="p">(</span><span class="n">pdf</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">range_seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the standard deviation from a range-based variance estimator&quot;&quot;&quot;</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="c1"># scale the variance by the number of seconds in the period</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="n">seconds_in_day</span> <span class="o">*</span> <span class="n">variance</span> <span class="o">/</span> <span class="n">range_seconds</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;10s&quot;</span><span class="p">,</span> <span class="s2">&quot;20s&quot;</span><span class="p">,</span> <span class="s2">&quot;30s&quot;</span><span class="p">,</span> <span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="s2">&quot;2m&quot;</span><span class="p">,</span> <span class="s2">&quot;3m&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">,</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">):</span>
    <span class="n">ohlc</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">))</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="n">ohlc</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">to_pytimedelta</span><span class="p">()</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="s2">&quot;gk&quot;</span><span class="p">,</span> <span class="s2">&quot;rs&quot;</span><span class="p">):</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">rf</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;0_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">rstd</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">vdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">)</span>
<span class="n">vdf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pk</th>
      <th>gk</th>
      <th>rs</th>
    </tr>
    <tr>
      <th>period</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10s</th>
      <td>1.964045</td>
      <td>1.394519</td>
      <td>1.332869</td>
    </tr>
    <tr>
      <th>20s</th>
      <td>2.139855</td>
      <td>1.587802</td>
      <td>1.535350</td>
    </tr>
    <tr>
      <th>30s</th>
      <td>2.225326</td>
      <td>1.681080</td>
      <td>1.629688</td>
    </tr>
    <tr>
      <th>1m</th>
      <td>2.312271</td>
      <td>1.773782</td>
      <td>1.718732</td>
    </tr>
    <tr>
      <th>2m</th>
      <td>2.369742</td>
      <td>1.836642</td>
      <td>1.781958</td>
    </tr>
    <tr>
      <th>3m</th>
      <td>2.404761</td>
      <td>1.875996</td>
      <td>1.822394</td>
    </tr>
    <tr>
      <th>5m</th>
      <td>2.432797</td>
      <td>1.876433</td>
      <td>1.808954</td>
    </tr>
    <tr>
      <th>10m</th>
      <td>2.420249</td>
      <td>1.899964</td>
      <td>1.867278</td>
    </tr>
    <tr>
      <th>30m</th>
      <td>2.449161</td>
      <td>1.959982</td>
      <td>1.884931</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These numbers are different from the realized variance because they are based on the range of the prices, not on the actual prices. The realized variance is a more direct measure of the volatility of the process, while the range-based estimators are more robust to market microstructure noise.</p>
<p>The Parkinson estimator is always higher than both the Garman-Klass and Rogers-Satchell estimators, the reason is due to the use of the high and low prices only, which are always further apart than the open and close prices. The GK and RS estimators are similar and are more accurate than the Parkinson estimator, especially for greater periods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">backend</span> <span class="o">=</span> <span class="s2">&quot;plotly&quot;</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">vdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Weiner Standard Deviation from Range-based estimators - correct value is 2.0&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>To estimate the Hurst exponent with the range-based estimators, we calculate the variance of the log of the range for different time windows and fit a line to the log-log plot of the variance vs the time window.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequence</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quantflow.ta.ohlc</span><span class="w"> </span><span class="kn">import</span> <span class="n">OHLC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">quantflow.ta.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span>

<span class="n">default_periods</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;10s&quot;</span><span class="p">,</span> <span class="s2">&quot;20s&quot;</span><span class="p">,</span> <span class="s2">&quot;30s&quot;</span><span class="p">,</span> <span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="s2">&quot;2m&quot;</span><span class="p">,</span> <span class="s2">&quot;3m&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">,</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ohlc_hurst_exponent</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">periods</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_periods</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">estimator_names</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="s2">&quot;gk&quot;</span><span class="p">,</span> <span class="s2">&quot;rs&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">OHLC</span><span class="p">(</span>
            <span class="n">serie</span><span class="o">=</span><span class="n">serie</span><span class="p">,</span>
            <span class="n">period</span><span class="o">=</span><span class="s2">&quot;10m&quot;</span><span class="p">,</span>
            <span class="n">rogers_satchell_variance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">parkinson_variance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">garman_klass_variance</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">time_range</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">estimators</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">periods</span><span class="p">:</span>
            <span class="n">ohlc</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">))</span>
            <span class="n">rf</span> <span class="o">=</span> <span class="n">ohlc</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">to_pytimedelta</span><span class="p">()</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
            <span class="n">time_range</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">estimator_names</span><span class="p">:</span>
                <span class="n">estimators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rf</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">serie</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
        <span class="n">results</span><span class="p">[</span><span class="n">serie</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">time_range</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">estimators</span><span class="p">[</span><span class="n">name</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">estimator_names</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">estimator_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ohlc_hurst_exponent</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pk</th>
      <td>0.539031</td>
    </tr>
    <tr>
      <th>gk</th>
      <td>0.558201</td>
    </tr>
    <tr>
      <th>rs</th>
      <td>0.559749</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The Hurst exponent should be close to 0.5, since we have calculated the exponent from the paths of a Weiner process. But the Hurst exponent is not exactly 0.5 because the range-based estimators are not the same as the realized variance. Interestingly, the Parkinson estimator gives a Hurst exponent closer to 0.5 than the Garman-Klass and Rogers-Satchell estimators.</p>
</section>
</section>
<section id="mean-reverting-time-series">
<h2>Mean Reverting Time Series<a class="headerlink" href="#mean-reverting-time-series" title="Link to this heading">#</a></h2>
<p>We now turn our attention to mean reverting time series, where the Hurst exponent is less than 0.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quantflow.sp.ou</span><span class="w"> </span><span class="kn">import</span> <span class="n">Vasicek</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">backend</span> <span class="o">=</span> <span class="s2">&quot;plotly&quot;</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Vasicek</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;kappa=</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">Vasicek</span><span class="p">(</span><span class="n">kappa</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">)}</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span> <span class="n">index</span><span class="o">=</span><span class="n">paths</span><span class="p">[</span><span class="s2">&quot;kappa=1.0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dates</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start_of_day</span><span class="p">()))</span>
<span class="n">pdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>We can now estimate the Hurst exponent from the realized variance. As we can see the Hurst exponent decreases as we increase the mean reversion parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">hurst_exponent</span><span class="p">()]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>kappa=1.0</th>
      <th>kappa=10.0</th>
      <th>kappa=50.0</th>
      <th>kappa=100.0</th>
      <th>kappa=500.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.491</td>
      <td>0.495349</td>
      <td>0.456041</td>
      <td>0.424638</td>
      <td>0.211878</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And we can also estimate the Hurst exponent from the range-based estimators. As we can see the Hurst exponent decreases as we increase the mean reversion parameter along the same lines as the realized variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ohlc_hurst_exponent</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="nb">list</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span> <span class="n">periods</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;10m&quot;</span><span class="p">,</span> <span class="s2">&quot;20m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>kappa=1.0</th>
      <th>kappa=10.0</th>
      <th>kappa=50.0</th>
      <th>kappa=100.0</th>
      <th>kappa=500.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pk</th>
      <td>0.469135</td>
      <td>0.497254</td>
      <td>0.438423</td>
      <td>0.409278</td>
      <td>0.251754</td>
    </tr>
    <tr>
      <th>gk</th>
      <td>0.514849</td>
      <td>0.516890</td>
      <td>0.511329</td>
      <td>0.439485</td>
      <td>0.277252</td>
    </tr>
    <tr>
      <th>rs</th>
      <td>0.534052</td>
      <td>0.511661</td>
      <td>0.555514</td>
      <td>0.440909</td>
      <td>0.274647</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./applications"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="volatility_surface.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Volatility Surface</p>
      </div>
    </a>
    <a class="right-next"
       href="calibration.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Calibration</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#study-with-the-weiner-process">Study with the Weiner Process</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#realized-variance">Realized Variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#range-based-variance-estimators">Range-based Variance Estimators</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-reverting-time-series">Mean Reverting Time Series</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href="https://quantmind.com">quantmind</a>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2014-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>