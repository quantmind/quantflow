const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-Cty9HaeD.js","./click-outside-container-BVQDdpbt.js","./react-BGmjiNul.js","./chunk-LvLJmgfZ.js","./dist-CdBsAJTp.js","./emotion-is-prop-valid.esm-DD4AwVTU.js","./react-dom-C9fstfnp.js","./number-overlay-editor-Ausf18nY.js"])))=>i.map(i=>d[i]);
var C0=Object.defineProperty;var S0=(Kr,Cr,Yr)=>Cr in Kr?C0(Kr,Cr,{enumerable:!0,configurable:!0,writable:!0,value:Yr}):Kr[Cr]=Yr;var tt=(Kr,Cr,Yr)=>S0(Kr,typeof Cr!="symbol"?Cr+"":Cr,Yr);import{s as Gt,t as X}from"./chunk-LvLJmgfZ.js";import{n as k0}from"./useEvent-DO6uJBas.js";import{t as An}from"./react-BGmjiNul.js";import"./react-dom-C9fstfnp.js";import{t as M0}from"./compiler-runtime-DeeZ7FnK.js";import{n as Va}from"./assertNever-CBU83Y6o.js";import{t as R0}from"./capitalize-CmNnkG9y.js";import{d as Wi}from"./hotkeys-BHHWjLlp.js";import{t as E0}from"./ErrorBoundary-ChCiwl15.js";import{t as I0}from"./jsx-runtime-ZmTK25f3.js";import{r as Bi,t as $i}from"./button-YC1gW_kJ.js";import{n as T0,t as O0}from"./useNonce-_Aax6sXd.js";import{c as P0,i as H0,n as D0,s as z0,t as A0}from"./select-V5IdpNiR.js";import{a as Ka,c as Ya,d as Ga,f as Ua,r as L0,s as Xa,t as F0,u as qa}from"./dropdown-menu-B-6unW-7.js";import{t as j0}from"./copy-CQ15EONK.js";import{n as _0,t as Xo}from"./types-CS34eOZi.js";import{t as N0}from"./plus-BD5o34_i.js";import{r as Za}from"./input-pAun1m1X.js";import{t as W0}from"./trash-DMqDgJ5r.js";import{t as Ja}from"./preload-helper-DItdS47A.js";import{t as B0}from"./use-toast-rmUWldD_.js";import{r as $0}from"./useTheme-DUdVAZI8.js";import"./Combination-CMPwuAmi.js";import{t as V0}from"./copy-Bv2DBpIS.js";import{t as K0}from"./prop-types-BiQYf0aU.js";import{t as Vi}from"./label-Be1daUcS.js";import{A as Qa,B as es,C as Y0,D as ts,E as rs,F as G0,G as Zt,H as fn,I as ho,J as U0,K as qo,L as ns,M as os,N as fo,O as X0,P as q0,R as Z0,S as is,T as ls,U as J0,V as as,W as Ln,_ as go,a as Pr,b as po,c as gn,d as nt,f as pe,g as Ki,h as $r,i as Q0,j as Yi,k as ss,m as cs,n as ef,o as fr,p as Vr,q as Zo,r as us,s as ds,t as tf,v as Fn,w as Gi,x as Jo,y as rf,z as hs}from"./click-outside-container-BVQDdpbt.js";import{t as Jt}from"./dist-CdBsAJTp.js";let Ui,fs,nf=(async()=>{const Kr=Jt("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});var Cr=X((e=>{(function(t,r){if(typeof define=="function"&&define.amd)define(["exports","react","prop-types"],r);else if(e!==void 0)r(e,An(),K0());else{var n={exports:{}};r(n.exports,t.react,t.propTypes),t.reactSwipe=n.exports}})(e,function(t,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.setHasSupportToCaptureOption=h;var o=l(r),i=l(n);function l(y){return y&&y.__esModule?y:{default:y}}var a=Object.assign||function(y){for(var k=1;k<arguments.length;k++){var I=arguments[k];for(var O in I)Object.prototype.hasOwnProperty.call(I,O)&&(y[O]=I[O])}return y};function s(y,k){var I={};for(var O in y)k.indexOf(O)>=0||Object.prototype.hasOwnProperty.call(y,O)&&(I[O]=y[O]);return I}function c(y,k){if(!(y instanceof k))throw TypeError("Cannot call a class as a function")}var u=(function(){function y(k,I){for(var O=0;O<I.length;O++){var E=I[O];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(k,E.key,E)}}return function(k,I,O){return I&&y(k.prototype,I),O&&y(k,O),k}})();function f(y,k){if(!y)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:y}function p(y,k){if(typeof k!="function"&&k!==null)throw TypeError("Super expression must either be null or a function, not "+typeof k);y.prototype=Object.create(k&&k.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(y,k):y.__proto__=k)}var m=!1;function h(y){m=y}try{addEventListener("test",null,Object.defineProperty({},"capture",{get:function(){h(!0)}}))}catch{}function v(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{capture:!0};return m?y:y.capture}function S(y){if("touches"in y){var k=y.touches[0];return{x:k.pageX,y:k.pageY}}return{x:y.screenX,y:y.screenY}}var M=(function(y){p(k,y);function k(){var I;c(this,k);var O=[...arguments],E=f(this,(I=k.__proto__||Object.getPrototypeOf(k)).call.apply(I,[this].concat(O)));return E._handleSwipeStart=E._handleSwipeStart.bind(E),E._handleSwipeMove=E._handleSwipeMove.bind(E),E._handleSwipeEnd=E._handleSwipeEnd.bind(E),E._onMouseDown=E._onMouseDown.bind(E),E._onMouseMove=E._onMouseMove.bind(E),E._onMouseUp=E._onMouseUp.bind(E),E._setSwiperRef=E._setSwiperRef.bind(E),E}return u(k,[{key:"componentDidMount",value:function(){this.swiper&&this.swiper.addEventListener("touchmove",this._handleSwipeMove,v({capture:!0,passive:!1}))}},{key:"componentWillUnmount",value:function(){this.swiper&&this.swiper.removeEventListener("touchmove",this._handleSwipeMove,v({capture:!0,passive:!1}))}},{key:"_onMouseDown",value:function(I){this.props.allowMouseEvents&&(this.mouseDown=!0,document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("mousemove",this._onMouseMove),this._handleSwipeStart(I))}},{key:"_onMouseMove",value:function(I){this.mouseDown&&this._handleSwipeMove(I)}},{key:"_onMouseUp",value:function(I){this.mouseDown=!1,document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("mousemove",this._onMouseMove),this._handleSwipeEnd(I)}},{key:"_handleSwipeStart",value:function(I){var O=S(I);this.moveStart={x:O.x,y:O.y},this.props.onSwipeStart(I)}},{key:"_handleSwipeMove",value:function(I){if(this.moveStart){var O=S(I),E=O.x,A=O.y,F=E-this.moveStart.x,C=A-this.moveStart.y;this.moving=!0,this.props.onSwipeMove({x:F,y:C},I)&&I.cancelable&&I.preventDefault(),this.movePosition={deltaX:F,deltaY:C}}}},{key:"_handleSwipeEnd",value:function(I){this.props.onSwipeEnd(I);var O=this.props.tolerance;this.moving&&this.movePosition&&(this.movePosition.deltaX<-O?this.props.onSwipeLeft(1,I):this.movePosition.deltaX>O&&this.props.onSwipeRight(1,I),this.movePosition.deltaY<-O?this.props.onSwipeUp(1,I):this.movePosition.deltaY>O&&this.props.onSwipeDown(1,I)),this.moveStart=null,this.moving=!1,this.movePosition=null}},{key:"_setSwiperRef",value:function(I){this.swiper=I,this.props.innerRef(I)}},{key:"render",value:function(){var I=this.props;I.tagName;var O=I.className,E=I.style,A=I.children;I.allowMouseEvents,I.onSwipeUp,I.onSwipeDown,I.onSwipeLeft,I.onSwipeRight,I.onSwipeStart,I.onSwipeMove,I.onSwipeEnd,I.innerRef,I.tolerance;var F=s(I,["tagName","className","style","children","allowMouseEvents","onSwipeUp","onSwipeDown","onSwipeLeft","onSwipeRight","onSwipeStart","onSwipeMove","onSwipeEnd","innerRef","tolerance"]);return o.default.createElement(this.props.tagName,a({ref:this._setSwiperRef,onMouseDown:this._onMouseDown,onTouchStart:this._handleSwipeStart,onTouchEnd:this._handleSwipeEnd,className:O,style:E},F),A)}}]),k})(r.Component);M.displayName="ReactSwipe",M.propTypes={tagName:i.default.string,className:i.default.string,style:i.default.object,children:i.default.node,allowMouseEvents:i.default.bool,onSwipeUp:i.default.func,onSwipeDown:i.default.func,onSwipeLeft:i.default.func,onSwipeRight:i.default.func,onSwipeStart:i.default.func,onSwipeMove:i.default.func,onSwipeEnd:i.default.func,innerRef:i.default.func,tolerance:i.default.number.isRequired},M.defaultProps={tagName:"div",allowMouseEvents:!1,onSwipeUp:function(){},onSwipeDown:function(){},onSwipeLeft:function(){},onSwipeRight:function(){},onSwipeStart:function(){},onSwipeMove:function(){},onSwipeEnd:function(){},innerRef:function(){},tolerance:0},t.default=M})})),Yr=X((e=>{(function(t,r){if(typeof define=="function"&&define.amd)define(["exports","./react-swipe"],r);else if(e!==void 0)r(e,Cr());else{var n={exports:{}};r(n.exports,t.reactSwipe),t.index=n.exports}})(e,function(t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=o(r);function o(i){return i&&i.__esModule?i:{default:i}}t.default=n.default})})),gs=X(((e,t)=>{(function(){var r={}.hasOwnProperty;function n(){for(var l="",a=0;a<arguments.length;a++){var s=arguments[a];s&&(l=i(l,o(s)))}return l}function o(l){if(typeof l=="string"||typeof l=="number")return l;if(typeof l!="object")return"";if(Array.isArray(l))return n.apply(null,l);if(l.toString!==Object.prototype.toString&&!l.toString.toString().includes("[native code]"))return l.toString();var a="";for(var s in l)r.call(l,s)&&l[s]&&(a=i(a,s));return a}function i(l,a){return a?l?l+" "+a:l+a:l}t!==void 0&&t.exports?(n.default=n,t.exports=n):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return n}):window.classNames=n})()})),Xi=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(gs());function r(o){return o&&o.__esModule?o:{default:o}}function n(o,i,l){return i in o?Object.defineProperty(o,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[i]=l,o}e.default={ROOT:function(o){return(0,t.default)(n({"carousel-root":!0},o||"",!!o))},CAROUSEL:function(o){return(0,t.default)({carousel:!0,"carousel-slider":o})},WRAPPER:function(o,i){return(0,t.default)({"thumbs-wrapper":!o,"slider-wrapper":o,"axis-horizontal":i==="horizontal","axis-vertical":i!=="horizontal"})},SLIDER:function(o,i){return(0,t.default)({thumbs:!o,slider:o,animated:!i})},ITEM:function(o,i,l){return(0,t.default)({thumb:!o,slide:o,selected:i,previous:l})},ARROW_PREV:function(o){return(0,t.default)({"control-arrow control-prev":!0,"control-disabled":o})},ARROW_NEXT:function(o){return(0,t.default)({"control-arrow control-next":!0,"control-disabled":o})},DOT:function(o){return(0,t.default)({dot:!0,selected:o})}}})),ps=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.outerWidth=void 0,e.outerWidth=function(t){var r=t.offsetWidth,n=getComputedStyle(t);return r+=parseInt(n.marginLeft)+parseInt(n.marginRight),r}})),Qo=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=function(t,r,n){var o=t===0?t:t+r;return"translate3d"+("("+(n==="horizontal"?[o,0,0]:[0,o,0]).join(",")+")")}})),qi=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=function(){return window}})),Zi=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=c(An()),r=a(Xi()),n=ps(),o=a(Qo()),i=a(Yr()),l=a(qi());function a(C){return C&&C.__esModule?C:{default:C}}function s(){if(typeof WeakMap!="function")return null;var C=new WeakMap;return s=function(){return C},C}function c(C){if(C&&C.__esModule)return C;if(C===null||u(C)!=="object"&&typeof C!="function")return{default:C};var R=s();if(R&&R.has(C))return R.get(C);var L={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in C)if(Object.prototype.hasOwnProperty.call(C,w)){var T=x?Object.getOwnPropertyDescriptor(C,w):null;T&&(T.get||T.set)?Object.defineProperty(L,w,T):L[w]=C[w]}return L.default=C,R&&R.set(C,L),L}function u(C){"@babel/helpers - typeof";return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},u(C)}function f(){return f=Object.assign||function(C){for(var R=1;R<arguments.length;R++){var L=arguments[R];for(var x in L)Object.prototype.hasOwnProperty.call(L,x)&&(C[x]=L[x])}return C},f.apply(this,arguments)}function p(C,R){if(!(C instanceof R))throw TypeError("Cannot call a class as a function")}function m(C,R){for(var L=0;L<R.length;L++){var x=R[L];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(C,x.key,x)}}function h(C,R,L){return R&&m(C.prototype,R),L&&m(C,L),C}function v(C,R){if(typeof R!="function"&&R!==null)throw TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&S(C,R)}function S(C,R){return S=Object.setPrototypeOf||function(L,x){return L.__proto__=x,L},S(C,R)}function M(C){var R=I();return function(){var L=O(C),x;if(R){var w=O(this).constructor;x=Reflect.construct(L,arguments,w)}else x=L.apply(this,arguments);return y(this,x)}}function y(C,R){return R&&(u(R)==="object"||typeof R=="function")?R:k(C)}function k(C){if(C===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return C}function I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function O(C){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},O(C)}function E(C,R,L){return R in C?Object.defineProperty(C,R,{value:L,enumerable:!0,configurable:!0,writable:!0}):C[R]=L,C}var A=function(C){return C.hasOwnProperty("key")},F=(function(C){v(L,C);var R=M(L);function L(x){var w;return p(this,L),w=R.call(this,x),E(k(w),"itemsWrapperRef",void 0),E(k(w),"itemsListRef",void 0),E(k(w),"thumbsRef",void 0),E(k(w),"setItemsWrapperRef",function(T){w.itemsWrapperRef=T}),E(k(w),"setItemsListRef",function(T){w.itemsListRef=T}),E(k(w),"setThumbsRef",function(T,P){w.thumbsRef||(w.thumbsRef=[]),w.thumbsRef[P]=T}),E(k(w),"updateSizes",function(){if(!(!w.props.children||!w.itemsWrapperRef||!w.thumbsRef)){var T=t.Children.count(w.props.children),P=w.itemsWrapperRef.clientWidth,b=w.props.thumbWidth?w.props.thumbWidth:(0,n.outerWidth)(w.thumbsRef[0]),J=Math.floor(P/b),_=J<T,Z=_?T-J:0;w.setState(function(ee,V){return{itemSize:b,visibleItems:J,firstItem:_?w.getFirstItem(V.selectedItem):0,lastPosition:Z,showArrows:_}})}}),E(k(w),"handleClickItem",function(T,P,b){if(!A(b)||b.key==="Enter"){var J=w.props.onSelectItem;typeof J=="function"&&J(T,P)}}),E(k(w),"onSwipeStart",function(){w.setState({swiping:!0})}),E(k(w),"onSwipeEnd",function(){w.setState({swiping:!1})}),E(k(w),"onSwipeMove",function(T){var P=T.x;if(!w.state.itemSize||!w.itemsWrapperRef||!w.state.visibleItems)return!1;var b=0,J=t.Children.count(w.props.children),_=-(w.state.firstItem*100)/w.state.visibleItems,Z=-Math.max(J-w.state.visibleItems,0)*100/w.state.visibleItems;_===b&&P>0&&(P=0),_===Z&&P<0&&(P=0);var ee=_+100/(w.itemsWrapperRef.clientWidth/P);return w.itemsListRef&&["WebkitTransform","MozTransform","MsTransform","OTransform","transform","msTransform"].forEach(function(V){w.itemsListRef.style[V]=(0,o.default)(ee,"%",w.props.axis)}),!0}),E(k(w),"slideRight",function(T){w.moveTo(w.state.firstItem-(typeof T=="number"?T:1))}),E(k(w),"slideLeft",function(T){w.moveTo(w.state.firstItem+(typeof T=="number"?T:1))}),E(k(w),"moveTo",function(T){T=T<0?0:T,T=T>=w.state.lastPosition?w.state.lastPosition:T,w.setState({firstItem:T})}),w.state={selectedItem:x.selectedItem,swiping:!1,showArrows:!1,firstItem:0,visibleItems:0,lastPosition:0},w}return h(L,[{key:"componentDidMount",value:function(){this.setupThumbs()}},{key:"componentDidUpdate",value:function(x){this.props.selectedItem!==this.state.selectedItem&&this.setState({selectedItem:this.props.selectedItem,firstItem:this.getFirstItem(this.props.selectedItem)}),this.props.children!==x.children&&this.updateSizes()}},{key:"componentWillUnmount",value:function(){this.destroyThumbs()}},{key:"setupThumbs",value:function(){(0,l.default)().addEventListener("resize",this.updateSizes),(0,l.default)().addEventListener("DOMContentLoaded",this.updateSizes),this.updateSizes()}},{key:"destroyThumbs",value:function(){(0,l.default)().removeEventListener("resize",this.updateSizes),(0,l.default)().removeEventListener("DOMContentLoaded",this.updateSizes)}},{key:"getFirstItem",value:function(x){var w=x;return x>=this.state.lastPosition&&(w=this.state.lastPosition),x<this.state.firstItem+this.state.visibleItems&&(w=this.state.firstItem),x<this.state.firstItem&&(w=x),w}},{key:"renderItems",value:function(){var x=this;return this.props.children.map(function(w,T){var P={key:T,ref:function(b){return x.setThumbsRef(b,T)},className:r.default.ITEM(!1,T===x.state.selectedItem),onClick:x.handleClickItem.bind(x,T,x.props.children[T]),onKeyDown:x.handleClickItem.bind(x,T,x.props.children[T]),"aria-label":`${x.props.labels.item} ${T+1}`,style:{width:x.props.thumbWidth}};return t.default.createElement("li",f({},P,{role:"button",tabIndex:0}),w)})}},{key:"render",value:function(){var x=this;if(!this.props.children)return null;var w=t.Children.count(this.props.children)>1,T=this.state.showArrows&&this.state.firstItem>0,P=this.state.showArrows&&this.state.firstItem<this.state.lastPosition,b={},J=-this.state.firstItem*(this.state.itemSize||0),_=(0,o.default)(J,"px",this.props.axis),Z=this.props.transitionTime+"ms";return b={WebkitTransform:_,MozTransform:_,MsTransform:_,OTransform:_,transform:_,msTransform:_,WebkitTransitionDuration:Z,MozTransitionDuration:Z,MsTransitionDuration:Z,OTransitionDuration:Z,transitionDuration:Z,msTransitionDuration:Z},t.default.createElement("div",{className:r.default.CAROUSEL(!1)},t.default.createElement("div",{className:r.default.WRAPPER(!1),ref:this.setItemsWrapperRef},t.default.createElement("button",{type:"button",className:r.default.ARROW_PREV(!T),onClick:function(){return x.slideRight()},"aria-label":this.props.labels.leftArrow}),w?t.default.createElement(i.default,{tagName:"ul",className:r.default.SLIDER(!1,this.state.swiping),onSwipeLeft:this.slideLeft,onSwipeRight:this.slideRight,onSwipeMove:this.onSwipeMove,onSwipeStart:this.onSwipeStart,onSwipeEnd:this.onSwipeEnd,style:b,innerRef:this.setItemsListRef,allowMouseEvents:this.props.emulateTouch},this.renderItems()):t.default.createElement("ul",{className:r.default.SLIDER(!1,this.state.swiping),ref:function(ee){return x.setItemsListRef(ee)},style:b},this.renderItems()),t.default.createElement("button",{type:"button",className:r.default.ARROW_NEXT(!P),onClick:function(){return x.slideLeft()},"aria-label":this.props.labels.rightArrow})))}}]),L})(t.Component);e.default=F,E(F,"displayName","Thumbs"),E(F,"defaultProps",{axis:"horizontal",labels:{leftArrow:"previous slide / item",rightArrow:"next slide / item",item:"slide item"},selectedItem:0,thumbWidth:80,transitionTime:350})})),ms=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=function(){return document}})),Ji=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.setPosition=e.getPosition=e.isKeyboardEvent=e.defaultStatusFormatter=e.noop=void 0;var t=An(),r=n(Qo());function n(o){return o&&o.__esModule?o:{default:o}}e.noop=function(){},e.defaultStatusFormatter=function(o,i){return`${o} of ${i}`},e.isKeyboardEvent=function(o){return o?o.hasOwnProperty("key"):!1},e.getPosition=function(o,i){if(i.infiniteLoop&&++o,o===0)return 0;var l=t.Children.count(i.children);if(i.centerMode&&i.axis==="horizontal"){var a=-o*i.centerSlidePercentage,s=l-1;return o&&(o!==s||i.infiniteLoop)?a+=(100-i.centerSlidePercentage)/2:o===s&&(a+=100-i.centerSlidePercentage),a}return-o*100},e.setPosition=function(o,i){var l={};return["WebkitTransform","MozTransform","MsTransform","OTransform","transform","msTransform"].forEach(function(a){l[a]=(0,r.default)(o,"%",i)}),l}})),vs=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fadeAnimationHandler=e.slideStopSwipingHandler=e.slideSwipeAnimationHandler=e.slideAnimationHandler=void 0;var t=An(),r=o(Qo()),n=Ji();function o(s){return s&&s.__esModule?s:{default:s}}function i(s,c){var u=Object.keys(s);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(s);c&&(f=f.filter(function(p){return Object.getOwnPropertyDescriptor(s,p).enumerable})),u.push.apply(u,f)}return u}function l(s){for(var c=1;c<arguments.length;c++){var u=arguments[c]==null?{}:arguments[c];c%2?i(Object(u),!0).forEach(function(f){a(s,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(u)):i(Object(u)).forEach(function(f){Object.defineProperty(s,f,Object.getOwnPropertyDescriptor(u,f))})}return s}function a(s,c,u){return c in s?Object.defineProperty(s,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[c]=u,s}e.slideAnimationHandler=function(s,c){var u={},f=c.selectedItem,p=f,m=t.Children.count(s.children)-1;if(s.infiniteLoop&&(f<0||f>m))return p<0?s.centerMode&&s.centerSlidePercentage&&s.axis==="horizontal"?u.itemListStyle=(0,n.setPosition)(-(m+2)*s.centerSlidePercentage-(100-s.centerSlidePercentage)/2,s.axis):u.itemListStyle=(0,n.setPosition)(-(m+2)*100,s.axis):p>m&&(u.itemListStyle=(0,n.setPosition)(0,s.axis)),u;var h=(0,n.getPosition)(f,s),v=(0,r.default)(h,"%",s.axis),S=s.transitionTime+"ms";return u.itemListStyle={WebkitTransform:v,msTransform:v,OTransform:v,transform:v},c.swiping||(u.itemListStyle=l(l({},u.itemListStyle),{},{WebkitTransitionDuration:S,MozTransitionDuration:S,OTransitionDuration:S,transitionDuration:S,msTransitionDuration:S})),u},e.slideSwipeAnimationHandler=function(s,c,u,f){var p={},m=c.axis==="horizontal",h=t.Children.count(c.children),v=0,S=(0,n.getPosition)(u.selectedItem,c),M=c.infiniteLoop?(0,n.getPosition)(h-1,c)-100:(0,n.getPosition)(h-1,c),y=m?s.x:s.y,k=y;S===v&&y>0&&(k=0),S===M&&y<0&&(k=0);var I=S+100/(u.itemSize/k),O=Math.abs(y)>c.swipeScrollTolerance;return c.infiniteLoop&&O&&(u.selectedItem===0&&I>-100?I-=h*100:u.selectedItem===h-1&&I<-h*100&&(I+=h*100)),(!c.preventMovementUntilSwipeScrollTolerance||O||u.swipeMovementStarted)&&(u.swipeMovementStarted||f({swipeMovementStarted:!0}),p.itemListStyle=(0,n.setPosition)(I,c.axis)),O&&!u.cancelClick&&f({cancelClick:!0}),p},e.slideStopSwipingHandler=function(s,c){var u=(0,n.getPosition)(c.selectedItem,s);return{itemListStyle:(0,n.setPosition)(u,s.axis)}},e.fadeAnimationHandler=function(s,c){var u=s.transitionTime+"ms",f="ease-in-out",p={position:"absolute",display:"block",zIndex:-2,minHeight:"100%",opacity:0,top:0,right:0,left:0,bottom:0,transitionTimingFunction:f,msTransitionTimingFunction:f,MozTransitionTimingFunction:f,WebkitTransitionTimingFunction:f,OTransitionTimingFunction:f};return c.swiping||(p=l(l({},p),{},{WebkitTransitionDuration:u,MozTransitionDuration:u,OTransitionDuration:u,transitionDuration:u,msTransitionDuration:u})),{slideStyle:p,selectedStyle:l(l({},p),{},{opacity:1,position:"relative"}),prevStyle:l({},p)}}})),ws=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=f(An()),r=c(Yr()),n=c(Xi()),o=c(Zi()),i=c(ms()),l=c(qi()),a=Ji(),s=vs();function c(x){return x&&x.__esModule?x:{default:x}}function u(){if(typeof WeakMap!="function")return null;var x=new WeakMap;return u=function(){return x},x}function f(x){if(x&&x.__esModule)return x;if(x===null||p(x)!=="object"&&typeof x!="function")return{default:x};var w=u();if(w&&w.has(x))return w.get(x);var T={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in x)if(Object.prototype.hasOwnProperty.call(x,b)){var J=P?Object.getOwnPropertyDescriptor(x,b):null;J&&(J.get||J.set)?Object.defineProperty(T,b,J):T[b]=x[b]}return T.default=x,w&&w.set(x,T),T}function p(x){"@babel/helpers - typeof";return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},p(x)}function m(){return m=Object.assign||function(x){for(var w=1;w<arguments.length;w++){var T=arguments[w];for(var P in T)Object.prototype.hasOwnProperty.call(T,P)&&(x[P]=T[P])}return x},m.apply(this,arguments)}function h(x,w){var T=Object.keys(x);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(x);w&&(P=P.filter(function(b){return Object.getOwnPropertyDescriptor(x,b).enumerable})),T.push.apply(T,P)}return T}function v(x){for(var w=1;w<arguments.length;w++){var T=arguments[w]==null?{}:arguments[w];w%2?h(Object(T),!0).forEach(function(P){R(x,P,T[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(T)):h(Object(T)).forEach(function(P){Object.defineProperty(x,P,Object.getOwnPropertyDescriptor(T,P))})}return x}function S(x,w){if(!(x instanceof w))throw TypeError("Cannot call a class as a function")}function M(x,w){for(var T=0;T<w.length;T++){var P=w[T];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(x,P.key,P)}}function y(x,w,T){return w&&M(x.prototype,w),T&&M(x,T),x}function k(x,w){if(typeof w!="function"&&w!==null)throw TypeError("Super expression must either be null or a function");x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),w&&I(x,w)}function I(x,w){return I=Object.setPrototypeOf||function(T,P){return T.__proto__=P,T},I(x,w)}function O(x){var w=F();return function(){var T=C(x),P;if(w){var b=C(this).constructor;P=Reflect.construct(T,arguments,b)}else P=T.apply(this,arguments);return E(this,P)}}function E(x,w){return w&&(p(w)==="object"||typeof w=="function")?w:A(x)}function A(x){if(x===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return x}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function C(x){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)},C(x)}function R(x,w,T){return w in x?Object.defineProperty(x,w,{value:T,enumerable:!0,configurable:!0,writable:!0}):x[w]=T,x}var L=(function(x){k(T,x);var w=O(T);function T(P){var b;S(this,T),b=w.call(this,P),R(A(b),"thumbsRef",void 0),R(A(b),"carouselWrapperRef",void 0),R(A(b),"listRef",void 0),R(A(b),"itemsRef",void 0),R(A(b),"timer",void 0),R(A(b),"animationHandler",void 0),R(A(b),"setThumbsRef",function(_){b.thumbsRef=_}),R(A(b),"setCarouselWrapperRef",function(_){b.carouselWrapperRef=_}),R(A(b),"setListRef",function(_){b.listRef=_}),R(A(b),"setItemsRef",function(_,Z){b.itemsRef||(b.itemsRef=[]),b.itemsRef[Z]=_}),R(A(b),"autoPlay",function(){t.Children.count(b.props.children)<=1||(b.clearAutoPlay(),b.props.autoPlay&&(b.timer=setTimeout(function(){b.increment()},b.props.interval)))}),R(A(b),"clearAutoPlay",function(){b.timer&&clearTimeout(b.timer)}),R(A(b),"resetAutoPlay",function(){b.clearAutoPlay(),b.autoPlay()}),R(A(b),"stopOnHover",function(){b.setState({isMouseEntered:!0},b.clearAutoPlay)}),R(A(b),"startOnLeave",function(){b.setState({isMouseEntered:!1},b.autoPlay)}),R(A(b),"isFocusWithinTheCarousel",function(){return b.carouselWrapperRef?!!((0,i.default)().activeElement===b.carouselWrapperRef||b.carouselWrapperRef.contains((0,i.default)().activeElement)):!1}),R(A(b),"navigateWithKeyboard",function(_){if(b.isFocusWithinTheCarousel()){var Z=b.props.axis==="horizontal",ee={ArrowUp:38,ArrowRight:39,ArrowDown:40,ArrowLeft:37},V=Z?ee.ArrowRight:ee.ArrowDown,ae=Z?ee.ArrowLeft:ee.ArrowUp;V===_.keyCode?b.increment():ae===_.keyCode&&b.decrement()}}),R(A(b),"updateSizes",function(){if(!(!b.state.initialized||!b.itemsRef||b.itemsRef.length===0)){var _=b.props.axis==="horizontal",Z=b.itemsRef[0];if(Z){var ee=_?Z.clientWidth:Z.clientHeight;b.setState({itemSize:ee}),b.thumbsRef&&b.thumbsRef.updateSizes()}}}),R(A(b),"setMountState",function(){b.setState({hasMount:!0}),b.updateSizes()}),R(A(b),"handleClickItem",function(_,Z){if(t.Children.count(b.props.children)!==0){if(b.state.cancelClick){b.setState({cancelClick:!1});return}b.props.onClickItem(_,Z),_!==b.state.selectedItem&&b.setState({selectedItem:_})}}),R(A(b),"handleOnChange",function(_,Z){t.Children.count(b.props.children)<=1||b.props.onChange(_,Z)}),R(A(b),"handleClickThumb",function(_,Z){b.props.onClickThumb(_,Z),b.moveTo(_)}),R(A(b),"onSwipeStart",function(_){b.setState({swiping:!0}),b.props.onSwipeStart(_)}),R(A(b),"onSwipeEnd",function(_){b.setState({swiping:!1,cancelClick:!1,swipeMovementStarted:!1}),b.props.onSwipeEnd(_),b.clearAutoPlay(),b.state.autoPlay&&b.autoPlay()}),R(A(b),"onSwipeMove",function(_,Z){b.props.onSwipeMove(Z);var ee=b.props.swipeAnimationHandler(_,b.props,b.state,b.setState.bind(A(b)));return b.setState(v({},ee)),!!Object.keys(ee).length}),R(A(b),"decrement",function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;b.moveTo(b.state.selectedItem-(typeof _=="number"?_:1))}),R(A(b),"increment",function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;b.moveTo(b.state.selectedItem+(typeof _=="number"?_:1))}),R(A(b),"moveTo",function(_){if(typeof _=="number"){var Z=t.Children.count(b.props.children)-1;_<0&&(_=b.props.infiniteLoop?Z:0),_>Z&&(_=b.props.infiniteLoop?0:Z),b.selectItem({selectedItem:_}),b.state.autoPlay&&b.state.isMouseEntered===!1&&b.resetAutoPlay()}}),R(A(b),"onClickNext",function(){b.increment(1)}),R(A(b),"onClickPrev",function(){b.decrement(1)}),R(A(b),"onSwipeForward",function(){b.increment(1),b.props.emulateTouch&&b.setState({cancelClick:!0})}),R(A(b),"onSwipeBackwards",function(){b.decrement(1),b.props.emulateTouch&&b.setState({cancelClick:!0})}),R(A(b),"changeItem",function(_){return function(Z){(!(0,a.isKeyboardEvent)(Z)||Z.key==="Enter")&&b.moveTo(_)}}),R(A(b),"selectItem",function(_){b.setState(v({previousItem:b.state.selectedItem},_),function(){b.setState(b.animationHandler(b.props,b.state))}),b.handleOnChange(_.selectedItem,t.Children.toArray(b.props.children)[_.selectedItem])}),R(A(b),"getInitialImage",function(){var _=b.props.selectedItem,Z=b.itemsRef&&b.itemsRef[_];return(Z&&Z.getElementsByTagName("img")||[])[0]}),R(A(b),"getVariableItemHeight",function(_){var Z=b.itemsRef&&b.itemsRef[_];if(b.state.hasMount&&Z&&Z.children.length){var ee=Z.children[0].getElementsByTagName("img")||[];if(ee.length>0){var V=ee[0];V.complete||V.addEventListener("load",function ne(){b.forceUpdate(),V.removeEventListener("load",ne)})}var ae=(ee[0]||Z.children[0]).clientHeight;return ae>0?ae:null}return null});var J={initialized:!1,previousItem:P.selectedItem,selectedItem:P.selectedItem,hasMount:!1,isMouseEntered:!1,autoPlay:P.autoPlay,swiping:!1,swipeMovementStarted:!1,cancelClick:!1,itemSize:1,itemListStyle:{},slideStyle:{},selectedStyle:{},prevStyle:{}};return b.animationHandler=typeof P.animationHandler=="function"&&P.animationHandler||P.animationHandler==="fade"&&s.fadeAnimationHandler||s.slideAnimationHandler,b.state=v(v({},J),b.animationHandler(P,J)),b}return y(T,[{key:"componentDidMount",value:function(){this.props.children&&this.setupCarousel()}},{key:"componentDidUpdate",value:function(P,b){!P.children&&this.props.children&&!this.state.initialized&&this.setupCarousel(),!P.autoFocus&&this.props.autoFocus&&this.forceFocus(),b.swiping&&!this.state.swiping&&this.setState(v({},this.props.stopSwipingHandler(this.props,this.state))),(P.selectedItem!==this.props.selectedItem||P.centerMode!==this.props.centerMode)&&(this.updateSizes(),this.moveTo(this.props.selectedItem)),P.autoPlay!==this.props.autoPlay&&(this.props.autoPlay?this.setupAutoPlay():this.destroyAutoPlay(),this.setState({autoPlay:this.props.autoPlay}))}},{key:"componentWillUnmount",value:function(){this.destroyCarousel()}},{key:"setupCarousel",value:function(){var P=this;this.bindEvents(),this.state.autoPlay&&t.Children.count(this.props.children)>1&&this.setupAutoPlay(),this.props.autoFocus&&this.forceFocus(),this.setState({initialized:!0},function(){var b=P.getInitialImage();b&&!b.complete?b.addEventListener("load",P.setMountState):P.setMountState()})}},{key:"destroyCarousel",value:function(){this.state.initialized&&(this.unbindEvents(),this.destroyAutoPlay())}},{key:"setupAutoPlay",value:function(){this.autoPlay();var P=this.carouselWrapperRef;this.props.stopOnHover&&P&&(P.addEventListener("mouseenter",this.stopOnHover),P.addEventListener("mouseleave",this.startOnLeave))}},{key:"destroyAutoPlay",value:function(){this.clearAutoPlay();var P=this.carouselWrapperRef;this.props.stopOnHover&&P&&(P.removeEventListener("mouseenter",this.stopOnHover),P.removeEventListener("mouseleave",this.startOnLeave))}},{key:"bindEvents",value:function(){(0,l.default)().addEventListener("resize",this.updateSizes),(0,l.default)().addEventListener("DOMContentLoaded",this.updateSizes),this.props.useKeyboardArrows&&(0,i.default)().addEventListener("keydown",this.navigateWithKeyboard)}},{key:"unbindEvents",value:function(){(0,l.default)().removeEventListener("resize",this.updateSizes),(0,l.default)().removeEventListener("DOMContentLoaded",this.updateSizes);var P=this.getInitialImage();P&&P.removeEventListener("load",this.setMountState),this.props.useKeyboardArrows&&(0,i.default)().removeEventListener("keydown",this.navigateWithKeyboard)}},{key:"forceFocus",value:function(){var P;(P=this.carouselWrapperRef)==null||P.focus()}},{key:"renderItems",value:function(P){var b=this;return this.props.children?t.Children.map(this.props.children,function(J,_){var Z=_===b.state.selectedItem,ee=_===b.state.previousItem,V=Z&&b.state.selectedStyle||ee&&b.state.prevStyle||b.state.slideStyle||{};b.props.centerMode&&b.props.axis==="horizontal"&&(V=v(v({},V),{},{minWidth:b.props.centerSlidePercentage+"%"})),b.state.swiping&&b.state.swipeMovementStarted&&(V=v(v({},V),{},{pointerEvents:"none"}));var ae={ref:function(ne){return b.setItemsRef(ne,_)},key:"itemKey"+_+(P?"clone":""),className:n.default.ITEM(!0,_===b.state.selectedItem,_===b.state.previousItem),onClick:b.handleClickItem.bind(b,_,J),style:V};return t.default.createElement("li",ae,b.props.renderItem(J,{isSelected:_===b.state.selectedItem,isPrevious:_===b.state.previousItem}))}):[]}},{key:"renderControls",value:function(){var P=this,b=this.props,J=b.showIndicators,_=b.labels,Z=b.renderIndicator,ee=b.children;return J?t.default.createElement("ul",{className:"control-dots"},t.Children.map(ee,function(V,ae){return Z&&Z(P.changeItem(ae),ae===P.state.selectedItem,ae,_.item)})):null}},{key:"renderStatus",value:function(){return this.props.showStatus?t.default.createElement("p",{className:"carousel-status"},this.props.statusFormatter(this.state.selectedItem+1,t.Children.count(this.props.children))):null}},{key:"renderThumbs",value:function(){return!this.props.showThumbs||!this.props.children||t.Children.count(this.props.children)===0?null:t.default.createElement(o.default,{ref:this.setThumbsRef,onSelectItem:this.handleClickThumb,selectedItem:this.state.selectedItem,transitionTime:this.props.transitionTime,thumbWidth:this.props.thumbWidth,labels:this.props.labels,emulateTouch:this.props.emulateTouch},this.props.renderThumbs(this.props.children))}},{key:"render",value:function(){var P=this;if(!this.props.children||t.Children.count(this.props.children)===0)return null;var b=this.props.swipeable&&t.Children.count(this.props.children)>1,J=this.props.axis==="horizontal",_=this.props.showArrows&&t.Children.count(this.props.children)>1,Z=_&&(this.state.selectedItem>0||this.props.infiniteLoop)||!1,ee=_&&(this.state.selectedItem<t.Children.count(this.props.children)-1||this.props.infiniteLoop)||!1,V=this.renderItems(!0),ae=V.shift(),ne=V.pop(),ce={className:n.default.SLIDER(!0,this.state.swiping),onSwipeMove:this.onSwipeMove,onSwipeStart:this.onSwipeStart,onSwipeEnd:this.onSwipeEnd,style:this.state.itemListStyle,tolerance:this.props.swipeScrollTolerance},ue={};return J?(ce.onSwipeLeft=this.onSwipeForward,ce.onSwipeRight=this.onSwipeBackwards,this.props.dynamicHeight&&(ue.height=this.getVariableItemHeight(this.state.selectedItem)||"auto")):(ce.onSwipeUp=this.props.verticalSwipe==="natural"?this.onSwipeBackwards:this.onSwipeForward,ce.onSwipeDown=this.props.verticalSwipe==="natural"?this.onSwipeForward:this.onSwipeBackwards,ce.style=v(v({},ce.style),{},{height:this.state.itemSize}),ue.height=this.state.itemSize),t.default.createElement("div",{"aria-label":this.props.ariaLabel,className:n.default.ROOT(this.props.className),ref:this.setCarouselWrapperRef,tabIndex:this.props.useKeyboardArrows?0:void 0},t.default.createElement("div",{className:n.default.CAROUSEL(!0),style:{width:this.props.width}},this.renderControls(),this.props.renderArrowPrev(this.onClickPrev,Z,this.props.labels.leftArrow),t.default.createElement("div",{className:n.default.WRAPPER(!0,this.props.axis),style:ue},b?t.default.createElement(r.default,m({tagName:"ul",innerRef:this.setListRef},ce,{allowMouseEvents:this.props.emulateTouch}),this.props.infiniteLoop&&ne,this.renderItems(),this.props.infiniteLoop&&ae):t.default.createElement("ul",{className:n.default.SLIDER(!0,this.state.swiping),ref:function(G){return P.setListRef(G)},style:this.state.itemListStyle||{}},this.props.infiniteLoop&&ne,this.renderItems(),this.props.infiniteLoop&&ae)),this.props.renderArrowNext(this.onClickNext,ee,this.props.labels.rightArrow),this.renderStatus()),this.renderThumbs())}}]),T})(t.default.Component);e.default=L,R(L,"displayName","Carousel"),R(L,"defaultProps",{ariaLabel:void 0,axis:"horizontal",centerSlidePercentage:80,interval:3e3,labels:{leftArrow:"previous slide / item",rightArrow:"next slide / item",item:"slide item"},onClickItem:a.noop,onClickThumb:a.noop,onChange:a.noop,onSwipeStart:function(){},onSwipeEnd:function(){},onSwipeMove:function(){return!1},preventMovementUntilSwipeScrollTolerance:!1,renderArrowPrev:function(x,w,T){return t.default.createElement("button",{type:"button","aria-label":T,className:n.default.ARROW_PREV(!w),onClick:x})},renderArrowNext:function(x,w,T){return t.default.createElement("button",{type:"button","aria-label":T,className:n.default.ARROW_NEXT(!w),onClick:x})},renderIndicator:function(x,w,T,P){return t.default.createElement("li",{className:n.default.DOT(w),onClick:x,onKeyDown:x,value:T,key:T,role:"button",tabIndex:0,"aria-label":`${P} ${T+1}`})},renderItem:function(x){return x},renderThumbs:function(x){var w=t.Children.map(x,function(T){var P=T;if(T.type!=="img"&&(P=t.Children.toArray(T.props.children).find(function(b){return b.type==="img"})),P)return P});return w.filter(function(T){return T}).length===0?(console.warn("No images found! Can't build the thumb list without images. If you don't need thumbs, set showThumbs={false} in the Carousel. Note that it's not possible to get images rendered inside custom components. More info at https://github.com/leandrowd/react-responsive-carousel/blob/master/TROUBLESHOOTING.md"),[]):w},statusFormatter:a.defaultStatusFormatter,selectedItem:0,showArrows:!0,showIndicators:!0,showStatus:!0,showThumbs:!0,stopOnHover:!0,swipeScrollTolerance:5,swipeable:!0,transitionTime:350,verticalSwipe:"standard",width:"100%",animationHandler:"slide",swipeAnimationHandler:s.slideSwipeAnimationHandler,stopSwipingHandler:s.slideStopSwipingHandler})})),ys=X((()=>{})),bs=X((e=>{Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Carousel",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"CarouselProps",{enumerable:!0,get:function(){return r.CarouselProps}}),Object.defineProperty(e,"Thumbs",{enumerable:!0,get:function(){return n.default}});var t=o(ws()),r=ys(),n=o(Zi());function o(i){return i&&i.__esModule?i:{default:i}}})),xs=X(((e,t)=>{var r=fn();t.exports=function(){return r.Date.now()}})),Cs=X(((e,t)=>{var r=/\s/;function n(o){for(var i=o.length;i--&&r.test(o.charAt(i)););return i}t.exports=n})),Ss=X(((e,t)=>{var r=Cs(),n=/^\s+/;function o(i){return i&&i.slice(0,r(i)+1).replace(n,"")}t.exports=o})),ei=X(((e,t)=>{var r=Ss(),n=ho(),o=Z0(),i=NaN,l=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt;function u(f){if(typeof f=="number")return f;if(o(f))return i;if(n(f)){var p=typeof f.valueOf=="function"?f.valueOf():f;f=n(p)?p+"":p}if(typeof f!="string")return f===0?f:+f;f=r(f);var m=a.test(f);return m||s.test(f)?c(f.slice(2),m?2:8):l.test(f)?i:+f}t.exports=u})),ti=X(((e,t)=>{var r=ho(),n=xs(),o=ei(),i="Expected a function",l=Math.max,a=Math.min;function s(c,u,f){var p,m,h,v,S,M,y=0,k=!1,I=!1,O=!0;if(typeof c!="function")throw TypeError(i);u=o(u)||0,r(f)&&(k=!!f.leading,I="maxWait"in f,h=I?l(o(f.maxWait)||0,u):h,O="trailing"in f?!!f.trailing:O);function E(P){var b=p,J=m;return p=m=void 0,y=P,v=c.apply(J,b),v}function A(P){return y=P,S=setTimeout(R,u),k?E(P):v}function F(P){var b=P-M,J=P-y,_=u-b;return I?a(_,h-J):_}function C(P){var b=P-M,J=P-y;return M===void 0||b>=u||b<0||I&&J>=h}function R(){var P=n();if(C(P))return L(P);S=setTimeout(R,F(P))}function L(P){return S=void 0,O&&p?E(P):(p=m=void 0,v)}function x(){S!==void 0&&clearTimeout(S),y=0,p=M=m=S=void 0}function w(){return S===void 0?v:L(n())}function T(){var P=n(),b=C(P);if(p=arguments,m=this,M=P,b){if(S===void 0)return A(M);if(I)return clearTimeout(S),S=setTimeout(R,u),E(M)}return S===void 0&&(S=setTimeout(R,u)),v}return T.cancel=x,T.flush=w,T}t.exports=s})),d=Gt(An(),1),ks=Gt(ti(),1);function Ft(e,t,r,n,o=!1){let i=d.useRef();i.current=t,d.useEffect(()=>{if(r===null||r.addEventListener===void 0)return;let l=r,a=s=>{var c;(c=i.current)==null||c.call(l,s)};return l.addEventListener(e,a,{passive:n,capture:o}),()=>{l.removeEventListener(e,a,{capture:o})}},[e,r,n,o])}function Gr(e,t){return e===void 0?void 0:t}var Ms=Math.PI;function Qi(e){return e*Ms/180}const el=(e,t,r)=>({x1:e-r/2,y1:t-r/2,x2:e+r/2,y2:t+r/2}),tl=(e,t,r,n,o)=>{switch(e){case"left":return Math.floor(t)+n+o/2;case"center":return Math.floor(t+r/2);case"right":return Math.floor(t+r)-n-o/2}},rl=(e,t,r)=>Math.min(e,t-r*2),nl=(e,t,r)=>r.x1<=e&&e<=r.x2&&r.y1<=t&&t<=r.y2,ri=e=>{let t=e.fgColor??"currentColor";return d.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),d.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Rs=e=>{let t=e.fgColor??"currentColor";return d.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Es(e,t,r){let[n,o]=d.useState(e),i=d.useRef(!0);d.useEffect(()=>()=>{i.current=!1},[]);let l=d.useRef((0,ks.default)(a=>{i.current&&o(a)},r));return d.useLayoutEffect(()=>{i.current&&l.current(()=>e())},t),n}var Is=RegExp("^[^A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u200E\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF]*[\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC]");function ni(e){return Is.test(e)?"rtl":"not-rtl"}var mo=void 0;function oi(){if(typeof document>"u")return 0;if(mo!==void 0)return mo;let e=document.createElement("p");e.style.width="100%",e.style.height="200px";let t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);let r=e.offsetWidth;t.style.overflow="scroll";let n=e.offsetWidth;return r===n&&(n=t.clientWidth),t.remove(),mo=r-n,mo}var Ur=Symbol();function Ts(e){let t=d.useRef([Ur,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;let[r,n]=d.useState(e),[,o]=d.useState(),i=d.useCallback(a=>{let s=t.current[0];s!==Ur&&(a=typeof a=="function"?a(s):a,a===s)||(s!==Ur&&o({}),n(c=>typeof a=="function"?a(s===Ur?c:s):a),t.current[0]=Ur)},[]),l=d.useCallback(()=>{t.current[0]=Ur,o({})},[]);return[t.current[0]===Ur?r:t.current[0],i,l]}function ol(e){if(e.length===0)return"";let t=0,r=0;for(let n of e){if(r+=n.length,r>1e4)break;t++}return e.slice(0,t).join(", ")}function Os(e){let t=d.useRef(e);return Zo(e,t.current)||(t.current=e),t.current}var Ps=bs();const Hs=e=>{let{urls:t,canWrite:r,onEditClick:n,renderImage:o}=e,i=t.filter(a=>a!=="");if(i.length===0)return null;let l=i.length>1;return d.createElement(Kr,{"data-testid":"GDG-default-image-overlay-editor"},d.createElement(Ps.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},i.map(a=>{let s=(o==null?void 0:o(a))??d.createElement("img",{draggable:!1,src:a});return d.createElement("div",{className:"gdg-centering-container",key:a},s)})),r&&n&&d.createElement("button",{className:"gdg-edit-icon",onClick:n},d.createElement(ri,null)))},Ds=Jt("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});var zs=class extends d.PureComponent{constructor(){super(...arguments);tt(this,"targetElement",null);tt(this,"containerRefHook",t=>{this.targetElement=t,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){let{targetElement:t,props:r}=this;if(t===null)return;let{contents:n,createNode:o}=r,i=T0(n),l=document.createRange();l.selectNodeContents(t),l.deleteContents();let a=o==null?void 0:o(i);if(a===void 0){let c=document.createElement("template");c.innerHTML=i,a=c.content}t.append(a);let s=t.getElementsByTagName("a");for(let c of s)c.target="_blank",c.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),d.createElement(Ds,{ref:this.containerRefHook})}};const As=Jt("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Ls=Jt("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),Fs=Jt("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});var il=0;const vo=e=>{let{placeholder:t,value:r,onKeyDown:n,highlight:o,altNewline:i,validatedSelection:l,...a}=e,{onChange:s,className:c}=a,u=d.useRef(null),f=r??"";Zt(s!==void 0,"GrowingEntry must be a controlled input area");let[p]=d.useState(()=>"input-box-"+(il=(il+1)%1e7));d.useEffect(()=>{let h=u.current;if(h===null||h.disabled)return;let v=f.toString().length;h.focus(),h.setSelectionRange(o?0:v,v)},[]),d.useLayoutEffect(()=>{var h;if(l!==void 0){let v=typeof l=="number"?[l,null]:l;(h=u.current)==null||h.setSelectionRange(v[0],v[1])}},[l]);let m=d.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||(n==null||n(h))},[i,n]);return d.createElement(Fs,{className:"gdg-growing-entry"},d.createElement(Ls,{className:c},f+`
`),d.createElement(As,{...a,className:(c??"")+" gdg-input",id:p,ref:u,onKeyDown:m,value:f,placeholder:t,dir:"auto"}))};var pn=new Map,mn=new Map,ii=new Map;function js(){pn.clear(),ii.clear(),mn.clear()}function _s(e,t,r,n,o){let i=0,l={};for(let s of e)i+=r.get(s)??o,l[s]=(l[s]??0)+1;let a=t-i;for(let s of Object.keys(l)){let c=l[s],u=r.get(s)??o,f=u+a*(u*c/i)*n/c;r.set(s,f)}}function Ns(e,t){let r=new Map,n=0;for(let a of"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890,.-+=?"){let s=e.measureText(a).width;r.set(a,s),n+=s}let o=n/r.size,i=(t/o+3)/4,l=r.keys();for(let a of l)r.set(a,(r.get(a)??o)*i);return r}function jn(e,t,r,n){let o=mn.get(r);if(n&&o!==void 0&&o.count>2e4){let a=ii.get(r);if(a===void 0&&(a=Ns(e,o.size),ii.set(r,a)),o.count>5e5){let c=0;for(let u of t)c+=a.get(u)??o.size;return c*1.01}let s=e.measureText(t);return _s(t,s.width,a,Math.max(.05,1-o.count/2e5),o.size),mn.set(r,{count:o.count+t.length,size:o.size}),s.width}let i=e.measureText(t),l=i.width/t.length;if(((o==null?void 0:o.count)??0)>2e4)return i.width;if(o===void 0)mn.set(r,{count:t.length,size:l});else{let a=l-o.size,s=t.length/(o.count+t.length),c=o.size+a*s;mn.set(r,{count:o.count+t.length,size:c})}return i.width}function Ws(e,t,r,n,o,i,l,a){if(t.length<=1)return t.length;if(o<r)return-1;let s=Math.floor(r/o*i),c=jn(e,t.slice(0,Math.max(0,s)),n,l),u=a==null?void 0:a(t);if(c!==r)if(c<r){for(;c<r;)s++,c=jn(e,t.slice(0,Math.max(0,s)),n,l);s--}else for(;c>r;){let f=u===void 0?t.lastIndexOf(" ",s-1):0;f>0?s=f:s--,c=jn(e,t.slice(0,Math.max(0,s)),n,l)}if(t[s]!==" "){let f=0;if(u===void 0)f=t.lastIndexOf(" ",s);else for(let p of u){if(p>s)break;f=p}f>0&&(s=f)}return s}function Bs(e,t,r,n,o,i){let l=`${t}_${r}_${n}px`,a=pn.get(l);if(a!==void 0)return a;if(n<=0)return[];let s=[],c=t.split(`
`),u=mn.get(r),f=u===void 0?t.length:n/u.size*1.5,p=o&&u!==void 0&&u.count>2e4;for(let m of c){let h=jn(e,m.slice(0,Math.max(0,f)),r,p),v=Math.min(m.length,f);if(h<=n)s.push(m);else{for(;h>n;){let S=Ws(e,m,n,r,h,v,p,i),M=m.slice(0,Math.max(0,S));m=m.slice(M.length),s.push(M),h=jn(e,m.slice(0,Math.max(0,f)),r,p),v=Math.min(m.length,f)}h>0&&s.push(m)}}return s=s.map((m,h)=>h===0?m.trimEnd():m.trim()),pn.set(l,s),pn.size>500&&pn.delete(pn.keys().next().value),s}function $s(e,t){return d.useMemo(()=>e.map((r,n)=>({group:r.group,grow:r.grow,hasMenu:r.hasMenu,icon:r.icon,id:r.id,menuIcon:r.menuIcon,overlayIcon:r.overlayIcon,sourceIndex:n,sticky:n<t,indicatorIcon:r.indicatorIcon,style:r.style,themeOverride:r.themeOverride,title:r.title,trailingRowOptions:r.trailingRowOptions,width:r.width,growOffset:r.growOffset,rowMarker:r.rowMarker,rowMarkerChecked:r.rowMarkerChecked,headerRowMarkerTheme:r.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:r.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:r.headerRowMarkerDisabled})),[e,t])}function Vs(e,t){let[r,n]=t;if(e.columns.hasIndex(r)||e.rows.hasIndex(n))return!0;if(e.current!==void 0){if(Nn(e.current.cell,t))return!0;let o=[e.current.range,...e.current.rangeStack];for(let i of o)if(r>=i.x&&r<i.x+i.width&&n>=i.y&&n<i.y+i.height)return!0}return!1}function _n(e,t){return(e??"")===(t??"")}function Ks(e,t,r){return r.current===void 0||e[1]!==r.current.cell[1]?!1:t.span===void 0?r.current.cell[0]===e[0]:r.current.cell[0]>=t.span[0]&&r.current.cell[0]<=t.span[1]}function ll(e,t){let[r,n]=e;return r>=t.x&&r<t.x+t.width&&n>=t.y&&n<t.y+t.height}function Nn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function al(e){return[e.x+e.width-1,e.y+e.height-1]}function sl(e,t,r){let n=r.x,o=r.x+r.width-1,i=r.y,l=r.y+r.height-1,[a,s]=e;if(s<i||s>l)return!1;if(t.span===void 0)return a>=n&&a<=o;let[c,u]=t.span;return c>=n&&c<=o||u>=n&&c<=o||c<n&&u>o}function Ys(e,t,r,n){let o=0;if(r.current===void 0)return o;let i=r.current.range;(n||i.height*i.width>1)&&sl(e,t,i)&&o++;for(let l of r.current.rangeStack)sl(e,t,l)&&o++;return o}function cl(e,t){let r=e;if(t!==void 0){let n=[...e],o=r[t.src];t.src>t.dest?(n.splice(t.src,1),n.splice(t.dest,0,o)):(n.splice(t.dest+1,0,o),n.splice(t.src,1)),n=n.map((i,l)=>({...i,sticky:e[l].sticky})),r=n}return r}function vn(e,t){let r=0,n=cl(e,t);for(let o=0;o<n.length;o++){let i=n[o];if(i.sticky)r+=i.width;else break}return r}function Xr(e,t,r){if(typeof r=="number")return t*r;{let n=0;for(let o=e-t;o<e;o++)n+=r(o);return n}}function li(e,t,r,n,o){let i=cl(e,n),l=[];for(let c of i)if(c.sticky)l.push(c);else break;if(l.length>0)for(let c of l)r-=c.width;let a=t,s=o??0;for(;s<=r&&a<i.length;)s+=i[a].width,a++;for(let c=t;c<a;c++){let u=i[c];u.sticky||l.push(u)}return l}function Gs(e,t,r){let n=0;for(let o of t){if(e<=(o.sticky?n:n+(r??0))+o.width)return o.sourceIndex;n+=o.width}return-1}function Us(e,t,r,n,o,i,l,a,s,c){let u=n+o;if(r&&e<=o)return-2;if(e<=u)return-1;let f=t;for(let h=0;h<c;h++){let v=i-1-h,S=typeof l=="number"?l:l(v);if(f-=S,e>=f)return v}let p=i-c,m=e-(s??0);if(typeof l=="number"){let h=Math.floor((m-u)/l)+a;return h>=p?void 0:h}else{let h=u;for(let v=a;v<p;v++){let S=l(v);if(m<=h+S)return v;h+=S}return}}var wo=0,Wn={},Xs=typeof window>"u";async function qs(){var e;Xs||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,wo=0,Wn={},js())}qs();function ul(e,t,r,n){return`${e}_${n??(t==null?void 0:t.font)}_${r}`}function wn(e,t,r,n="middle"){let o=ul(e,t,n,r),i=Wn[o];return i===void 0&&(i=t.measureText(e),Wn[o]=i,wo++),wo>1e4&&(Wn={},wo=0),i}function dl(e,t){let r=ul(e,void 0,"middle",t);return Wn[r]}function Hr(e,t){return typeof t!="string"&&(t=t.baseFontFull),Zs(e,t)}function hl(e,t){e.save(),e.textBaseline=t;let r=e.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZ");return e.restore(),r}var fl=[];function Zs(e,t){for(let o of fl)if(o.key===t)return o.val;let r=hl(e,"alphabetic"),n=-(hl(e,"middle").actualBoundingBoxDescent-r.actualBoundingBoxDescent)+r.actualBoundingBoxAscent/2;return fl.push({key:t,val:n}),n}function Js(e,t,r,n,o,i){let{ctx:l,rect:a,theme:s}=e,c=2**53-1;return t!==void 0&&(c=r-t,c<500&&(l.globalAlpha=1-c/500,l.fillStyle=s.bgSearchResult,l.fillRect(a.x+1,a.y+1,a.width-(o?2:1),a.height-(i?2:1)),l.globalAlpha=1,n!==void 0&&(n.fillStyle=s.bgSearchResult))),c<500}function Bn(e,t,r){let{ctx:n,theme:o}=e,i=t??{},l=r??o.textDark;return l!==i.fillStyle&&(n.fillStyle=l,i.fillStyle=l),i}function gl(e,t,r,n,o,i,l,a,s){s==="right"?e.fillText(t,r+o-(a.cellHorizontalPadding+.5),n+i/2+l):s==="center"?e.fillText(t,r+o/2,n+i/2+l):e.fillText(t,r+a.cellHorizontalPadding+.5,n+i/2+l)}function pl(e,t){let r=wn("ABCi09jgqpy",e,t);return r.actualBoundingBoxAscent+r.actualBoundingBoxDescent}function Qs(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);let r=t/4;return e.length>r&&(e=e.slice(0,r)),e}function ec(e,t,r,n,o,i,l,a,s,c){let u=a.baseFontFull,f=Bs(e,t,u,o-a.cellHorizontalPadding*2,c??!1),p=pl(e,u),m=a.lineHeight*p,h=p+m*(f.length-1),v=h+a.cellVerticalPadding>i;v&&(e.save(),e.rect(r,n,o,i),e.clip());let S=n+i/2-h/2,M=Math.max(n+a.cellVerticalPadding,S);for(let y of f)if(gl(e,y,r,M,o,p,l,a,s),M+=m,M>n+i)break;v&&e.restore()}function Sr(e,t,r,n,o){let{ctx:i,rect:l,theme:a}=e,{x:s,y:c,width:u,height:f}=l;n??(n=!1),n||(t=Qs(t,u));let p=Hr(i,a),m=ni(t)==="rtl";if(r===void 0&&m&&(r="right"),m&&(i.direction="rtl"),t.length>0){let h=!1;r==="right"?(i.textAlign="right",h=!0):r!==void 0&&r!=="left"&&(i.textAlign=r,h=!0),n?ec(i,t,s,c,u,f,p,a,r,o):gl(i,t,s,c,u,f,p,a,r),h&&(i.textAlign="start"),m&&(i.direction="inherit")}}function gr(e,t,r,n,o,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,o/2,n/2)),tr:Math.max(0,Math.min(i.tr,o/2,n/2)),bl:Math.max(0,Math.min(i.bl,o/2,n/2)),br:Math.max(0,Math.min(i.br,o/2,n/2))},e.moveTo(t+i.tl,r),e.arcTo(t+n,r,t+n,r+i.tr,i.tr),e.arcTo(t+n,r+o,t+n-i.br,r+o,i.br),e.arcTo(t,r+o,t,r+o-i.bl,i.bl),e.arcTo(t,r,t+i.tl,r,i.tl)}function tc(e,t,r){let n=1.25;e.arc(t,r-n*3.5,n,0,2*Math.PI,!1),e.arc(t,r,n,0,2*Math.PI,!1),e.arc(t,r+n*3.5,n,0,2*Math.PI,!1)}function rc(e,t,r){let n=function(a,s){let c=s.x-a.x,u=s.y-a.y,f=Math.sqrt(c*c+u*u),p=c/f,m=u/f;return{x:c,y:s.y-a.y,len:f,nx:p,ny:m,ang:Math.atan2(m,p)}},o,i=t.length,l=t[i-1];for(let a=0;a<i;a++){let s=t[a%i],c=t[(a+1)%i],u=n(s,l),f=n(s,c),p=u.nx*f.ny-u.ny*f.nx,m=u.nx*f.nx-u.ny*-f.ny,h=Math.asin(p<-1?-1:p>1?1:p),v=1,S=!1;m<0?h<0?h=Math.PI+h:(h=Math.PI-h,v=-1,S=!0):h>0&&(v=-1,S=!0),o=s.radius===void 0?r:s.radius;let M=h/2,y=Math.abs(Math.cos(M)*o/Math.sin(M)),k;y>Math.min(u.len/2,f.len/2)?(y=Math.min(u.len/2,f.len/2),k=Math.abs(y*Math.sin(M)/Math.cos(M))):k=o;let I=s.x+f.nx*y,O=s.y+f.ny*y;I+=-f.ny*k*v,O+=f.nx*k*v,e.arc(I,O,k,u.ang+Math.PI/2*v,f.ang-Math.PI/2*v,S),l=s,s=c}e.closePath()}function ai(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h){let v={x:0,y:i+c,width:0,height:0};if(e>=m.length||t>=u||t<-2||e<0)return v;let S=i-o;if(e>=f){let M=l>e?-1:1,y=vn(m);v.x+=y+s;for(let k=l;k!==e;k+=M)v.x+=m[M===1?k:k-1].width*M}else for(let M=0;M<e;M++)v.x+=m[M].width;if(v.width=m[e].width+1,t===-1)v.y=o,v.height=S;else if(t===-2){v.y=0,v.height=o;let M=e,y=m[e].group,k=m[e].sticky;for(;M>0&&_n(m[M-1].group,y)&&m[M-1].sticky===k;){let O=m[M-1];v.x-=O.width,v.width+=O.width,M--}let I=e;for(;I+1<m.length&&_n(m[I+1].group,y)&&m[I+1].sticky===k;){let O=m[I+1];v.width+=O.width,I++}if(!k){let O=vn(m),E=v.x-O;E<0&&(v.x-=E,v.width+=E),v.x+v.width>r&&(v.width=r-v.x)}}else if(t>=u-p){let M=u-t;for(v.y=n;M>0;){let y=t+M-1;v.height=typeof h=="number"?h:h(y),v.y-=v.height,M--}v.height+=1}else{let M=a>t?-1:1;if(typeof h=="number"){let y=t-a;v.y+=y*h}else for(let y=a;y!==t;y+=M)v.y+=h(y)*M;v.height=(typeof h=="number"?h:h(t))+1}return v}var si=1<<21;function or(e,t){return(t+2)*si+e}function ml(e){return e%si}function ci(e){return Math.floor(e/si)-2}function ui(e){return[ml(e),ci(e)]}var vl=class{constructor(){tt(this,"visibleWindow",{x:0,y:0,width:0,height:0});tt(this,"freezeCols",0);tt(this,"freezeRows",[]);tt(this,"isInWindow",e=>{let t=ml(e),r=ci(e),n=this.visibleWindow,o=t>=n.x&&t<=n.x+n.width||t<this.freezeCols,i=r>=n.y&&r<=n.y+n.height||this.freezeRows.includes(r);return o&&i})}setWindow(e,t,r){this.visibleWindow.x===e.x&&this.visibleWindow.y===e.y&&this.visibleWindow.width===e.width&&this.visibleWindow.height===e.height&&this.freezeCols===t&&Zo(this.freezeRows,r)||(this.visibleWindow=e,this.freezeCols=t,this.freezeRows=r,this.clearOutOfWindow())}},nc=class extends vl{constructor(){super(...arguments);tt(this,"cache",new Map);tt(this,"setValue",(t,r)=>{this.cache.set(or(t[0],t[1]),r)});tt(this,"getValue",t=>this.cache.get(or(t[0],t[1])));tt(this,"clearOutOfWindow",()=>{for(let[t]of this.cache.entries())this.isInWindow(t)||this.cache.delete(t)})}},$n=class{constructor(e=[]){tt(this,"cells");this.cells=new Set(e.map(t=>or(t[0],t[1])))}add(e){this.cells.add(or(e[0],e[1]))}has(e){return e===void 0?!1:this.cells.has(or(e[0],e[1]))}remove(e){this.cells.delete(or(e[0],e[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(let e of this.cells)if(ci(e)<0)return!0;return!1}hasItemInRectangle(e){for(let t=e.y;t<e.y+e.height;t++)for(let r=e.x;r<e.x+e.width;r++)if(this.cells.has(or(r,t)))return!0;return!1}hasItemInRegion(e){for(let t of e)if(this.hasItemInRectangle(t))return!0;return!1}*values(){for(let e of this.cells)yield ui(e)}},di=150;function oc(e,t,r,n){var o,i;return((i=(o=n(t))==null?void 0:o.measure)==null?void 0:i.call(o,e,t,r))??di}function wl(e,t,r,n,o,i,l,a,s){let c=0,u=o===void 0?[]:o.map(p=>{let m=oc(e,p[n],t,s);return c=Math.max(c,m),m});if(u.length>5&&a){c=0;let p=0;for(let h of u)p+=h;let m=p/u.length;for(let h=0;h<u.length;h++)u[h]>=m*2?u[h]=0:c=Math.max(c,u[h])}c=Math.max(c,e.measureText(r.title).width+t.cellHorizontalPadding*2+(r.icon===void 0?0:28));let f=Math.max(Math.ceil(i),Math.min(Math.floor(l),Math.ceil(c)));return{...r,width:f}}function ic(e,t,r,n,o,i,l,a,s){let c=d.useRef(t),u=d.useRef(r),f=d.useRef(l);c.current=t,u.current=r,f.current=l;let[p,m]=d.useMemo(()=>{if(typeof window>"u")return[null,null];let y=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",[y,y.getContext("2d",{alpha:!1})]},[]);d.useLayoutEffect(()=>(p&&document.documentElement.append(p),()=>{p==null||p.remove()}),[p]);let h=d.useRef({}),v=d.useRef(),[S,M]=d.useState();return d.useLayoutEffect(()=>{let y=u.current;if(y===void 0||e.every(Jo))return;let k=Math.max(1,10-Math.floor(e.length/1e4)),I=0;k<c.current&&k>1&&(k--,I=1);let O={x:0,y:0,width:e.length,height:Math.min(c.current,k)},E={x:0,y:c.current-1,width:e.length,height:1};(async()=>{let A=y(O,s.signal),F=I>0?y(E,s.signal):void 0,C;C=typeof A=="object"?A:await is(A),F!==void 0&&(C=typeof F=="object"?[...C,...F]:[...C,...await is(F)]),v.current=e,M(C)})()},[s.signal,e]),d.useMemo(()=>{let y=e.every(Jo)?e:m===null?e.map(E=>Jo(E)?E:{...E,width:di}):(m.font=f.current.baseFontFull,e.map((E,A)=>{if(Jo(E))return E;if(h.current[E.id]!==void 0)return{...E,width:h.current[E.id]};if(S===void 0||v.current!==e||E.id===void 0)return{...E,width:di};let F=wl(m,l,E,A,S,o,i,!0,a);return h.current[E.id]=F.width,F})),k=0,I=0,O=[];for(let[E,A]of y.entries())k+=A.width,A.grow!==void 0&&A.grow>0&&(I+=A.grow,O.push(E));if(k<n&&O.length>0){let E=[...y],A=n-k,F=A;for(let C=0;C<O.length;C++){let R=O[C],L=(y[R].grow??0)/I,x=C===O.length-1?F:Math.min(F,Math.floor(A*L));E[R]={...y[R],growOffset:x,width:y[R].width+x},F-=x}y=E}return{sizedColumns:y,nonGrowWidth:k}},[n,e,m,S,l,o,i,a])}var lc=X(((e,t)=>{function r(n,o,i){return n===n&&(i!==void 0&&(n=n<=i?n:i),o!==void 0&&(n=n>=o?n:o)),n}t.exports=r})),yo=X(((e,t)=>{var r=lc(),n=ei();function o(i,l,a){return a===void 0&&(a=l,l=void 0),a!==void 0&&(a=n(a),a=a===a?a:0),l!==void 0&&(l=n(l),l=l===l?l:0),r(n(i),l,a)}t.exports=o})),ac=X(((e,t)=>{var r="__lodash_hash_undefined__";function n(o){return this.__data__.set(o,r),this}t.exports=n})),sc=X(((e,t)=>{function r(n){return this.__data__.has(n)}t.exports=r})),yl=X(((e,t)=>{var r=ss(),n=ac(),o=sc();function i(l){var a=-1,s=l==null?0:l.length;for(this.__data__=new r;++a<s;)this.add(l[a])}i.prototype.add=i.prototype.push=n,i.prototype.has=o,t.exports=i})),cc=X(((e,t)=>{function r(n,o,i,l){for(var a=n.length,s=i+(l?1:-1);l?s--:++s<a;)if(o(n[s],s,n))return s;return-1}t.exports=r})),uc=X(((e,t)=>{function r(n){return n!==n}t.exports=r})),dc=X(((e,t)=>{function r(n,o,i){for(var l=i-1,a=n.length;++l<a;)if(n[l]===o)return l;return-1}t.exports=r})),hc=X(((e,t)=>{var r=cc(),n=uc(),o=dc();function i(l,a,s){return a===a?o(l,a,s):r(l,n,s)}t.exports=i})),fc=X(((e,t)=>{var r=hc();function n(o,i){return!!(o!=null&&o.length)&&r(o,i,0)>-1}t.exports=n})),gc=X(((e,t)=>{function r(n,o,i){for(var l=-1,a=n==null?0:n.length;++l<a;)if(i(o,n[l]))return!0;return!1}t.exports=r})),bl=X(((e,t)=>{function r(n,o){return n.has(o)}t.exports=r})),xl=X(((e,t)=>{t.exports=fo()(fn(),"Set")})),pc=X(((e,t)=>{function r(){}t.exports=r})),hi=X(((e,t)=>{function r(n){var o=-1,i=Array(n.size);return n.forEach(function(l){i[++o]=l}),i}t.exports=r})),mc=X(((e,t)=>{var r=xl(),n=pc(),o=hi();t.exports=r&&1/o(new r([,-0]))[1]==1/0?function(i){return new r(i)}:n})),vc=X(((e,t)=>{var r=yl(),n=fc(),o=gc(),i=bl(),l=mc(),a=hi(),s=200;function c(u,f,p){var m=-1,h=n,v=u.length,S=!0,M=[],y=M;if(p)S=!1,h=o;else if(v>=s){var k=f?null:l(u);if(k)return a(k);S=!1,h=i,y=new r}else y=f?[]:M;e:for(;++m<v;){var I=u[m],O=f?f(I):I;if(I=p||I!==0?I:0,S&&O===O){for(var E=y.length;E--;)if(y[E]===O)continue e;f&&y.push(O),M.push(I)}else h(y,O,p)||(y!==M&&y.push(O),M.push(I))}return M}t.exports=c})),wc=X(((e,t)=>{var r=vc();function n(o){return o&&o.length?r(o):[]}t.exports=n})),Cl=X(((e,t)=>{function r(n,o){for(var i=-1,l=o.length,a=n.length;++i<l;)n[a+i]=o[i];return n}t.exports=r})),yc=X(((e,t)=>{var r=as(),n=ts(),o=Ln(),i=r?r.isConcatSpreadable:void 0;function l(a){return o(a)||n(a)||!!(i&&a&&a[i])}t.exports=l})),bc=X(((e,t)=>{var r=Cl(),n=yc();function o(i,l,a,s,c){var u=-1,f=i.length;for(a||(a=n),c||(c=[]);++u<f;){var p=i[u];l>0&&a(p)?l>1?o(p,l-1,a,s,c):r(c,p):s||(c[c.length]=p)}return c}t.exports=o})),xc=X(((e,t)=>{var r=bc();function n(o){return o!=null&&o.length?r(o,1):[]}t.exports=n})),Cc=X(((e,t)=>{var r=Math.ceil,n=Math.max;function o(i,l,a,s){for(var c=-1,u=n(r((l-i)/(a||1)),0),f=Array(u);u--;)f[s?u:++c]=i,i+=a;return f}t.exports=o})),fi=X(((e,t)=>{var r=G0(),n=ls();function o(i){return i!=null&&n(i.length)&&!r(i)}t.exports=o})),Sc=X(((e,t)=>{var r=os(),n=fi(),o=rs(),i=ho();function l(a,s,c){if(!i(c))return!1;var u=typeof s;return(u=="number"?n(c)&&o(s,c.length):u=="string"&&s in c)?r(c[s],a):!1}t.exports=l})),kc=X(((e,t)=>{var r=ei(),n=1/0,o=17976931348623157e292;function i(l){return l?(l=r(l),l===n||l===-n?(l<0?-1:1)*o:l===l?l:0):l===0?l:0}t.exports=i})),Mc=X(((e,t)=>{var r=Cc(),n=Sc(),o=kc();function i(l){return function(a,s,c){return c&&typeof c!="number"&&n(a,s,c)&&(s=c=void 0),a=o(a),s===void 0?(s=a,a=0):s=o(s),c=c===void 0?a<s?1:-1:o(c),r(a,s,c,l)}}t.exports=i})),Sl=X(((e,t)=>{t.exports=Mc()()})),ut='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Rc=e=>{let t=e.fgColor;return`
    ${ut}<rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Ec=e=>{let t=e.fgColor;return`
    ${ut}<rect x="2" y="2" width="16" height="16" rx="4" fill="${e.bgColor}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Ic=e=>{let t=e.fgColor;return`${ut}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${e.bgColor}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Tc=e=>{let t=e.fgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${e.bgColor}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Oc=e=>{let t=e.fgColor;return`${ut}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${e.bgColor}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},kl=e=>{let t=e.fgColor;return`${ut}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${e.bgColor}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `};const Pc={headerRowID:Rc,headerNumber:Ic,headerCode:Ec,headerString:Tc,headerBoolean:Oc,headerAudioUri:kl,headerVideoUri:e=>{let t=e.fgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${e.bgColor}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},headerEmoji:e=>{let t=e.fgColor;return`
    ${ut}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${e.bgColor}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},headerImage:e=>{let t=e.fgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${e.bgColor}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},headerUri:kl,headerPhone:e=>`
    ${ut}
    <path fill="${e.fgColor}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${e.bgColor}"/>
  </svg>`,headerMarkdown:e=>{let t=e.fgColor;return`
    ${ut}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${e.bgColor}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},headerDate:e=>{let t=e.fgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${e.bgColor}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},headerTime:e=>{let t=e.fgColor;return`
    ${ut}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${e.bgColor}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},headerEmail:e=>{let t=e.fgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},headerReference:e=>{let t=e.fgColor,r=e.bgColor;return`
    ${ut}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${r}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${r}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},headerIfThenElse:e=>`${ut}
  <path fill="${e.fgColor}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${e.bgColor}"/>
</svg>`,headerSingleValue:e=>{let t=e.fgColor;return`
    ${ut}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},headerLookup:e=>{let t=e.fgColor;return`
    ${ut}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},headerTextTemplate:e=>{let t=e.fgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},headerMath:e=>{let t=e.fgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},headerRollup:e=>{let t=e.fgColor;return`
    ${ut}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${e.bgColor}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},headerJoinStrings:e=>{let t=e.fgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},headerSplitString:e=>{let t=e.fgColor;return`
    ${ut}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},headerGeoDistance:e=>{let t=e.fgColor;return`${ut}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${e.bgColor}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},headerArray:e=>{let t=e.fgColor;return`${ut}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${e.bgColor}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},rowOwnerOverlay:e=>{let t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},protectedColumnOverlay:e=>{let t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},renameIcon:e=>{let t=e.bgColor;return`${ut}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`}};function Hc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}var Dc=class{constructor(e,t){tt(this,"onSettled");tt(this,"spriteMap",new Map);tt(this,"headerIcons");tt(this,"inFlight",0);this.onSettled=t,this.headerIcons=e??{}}drawSprite(e,t,r,n,o,i,l,a=1){let[s,c]=Hc(t,l),u=i*Math.ceil(window.devicePixelRatio),f=`${s}_${c}_${u}_${e}`,p=this.spriteMap.get(f);if(p===void 0){let m=this.headerIcons[e];if(m===void 0)return;p=document.createElement("canvas");let h=p.getContext("2d");if(h===null)return;let v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(m({fgColor:c,bgColor:s}))}`,this.spriteMap.set(f,p);let S=v.decode();if(S===void 0)return;this.inFlight++,S.then(()=>{h.drawImage(v,0,0,u,u)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(r.globalAlpha=a),r.drawImage(p,0,0,u,u,n,o,i,i),a<1&&(r.globalAlpha=1)}};function Ml(e){if(e.length===0)return;let t;for(let r of e)t=Math.min(t??r.y,r.y)}function bo(e,t,r,n,o,i,l,a,s){a??(a=t);let c=t,u=e,f=n-i,p=!1;for(;c<r&&u<f;){let m=o(u);if(c+m>a&&s(c,u,m,!1,l&&u===n-1)===!0){p=!0;break}c+=m,u++}if(!p){c=r;for(let m=0;m<i;m++){u=n-1-m;let h=o(u);c-=h,s(c,u,h,!0,l&&u===n-1)}}}function Dr(e,t,r,n,o,i){let l=0,a=0,s=o+n;for(let c of e){if(i(c,c.sticky?a:l+r,s,c.sticky?0:a,t)===!0)break;l+=c.width,a+=c.sticky?c.width:0}}function Rl(e,t,r,n,o){let i=0,l=0;for(let a=0;a<e.length;a++){let s=e[a],c=a+1,u=s.width;for(s.sticky&&(l+=u);c<e.length&&_n(e[c].group,s.group)&&e[c].sticky===e[a].sticky;){let v=e[c];u+=v.width,c++,a++,v.sticky&&(l+=v.width)}let f=s.sticky?0:r,p=i+f,m=s.sticky?0:Math.max(0,l-p),h=Math.min(u-m,t-(p+m));o([s.sourceIndex,e[c-1].sourceIndex],s.group??"",p+m,0,h,n),i+=u}}function El(e,t,r,n,o,i,l){var p;let[a,s]=e,c,u,f=((p=l.find(m=>!m.sticky))==null?void 0:p.sourceIndex)??0;if(s>f){let m=Math.max(a,f),h=t,v=n;for(let S=i.sourceIndex-1;S>=m;S--)h-=l[S].width,v+=l[S].width;for(let S=i.sourceIndex+1;S<=s;S++)v+=l[S].width;u={x:h,y:r,width:v,height:o}}if(f>a){let m=Math.min(s,f-1),h=t,v=n;for(let S=i.sourceIndex-1;S>=a;S--)h-=l[S].width,v+=l[S].width;for(let S=i.sourceIndex+1;S<=m;S++)v+=l[S].width;c={x:h,y:r,width:v,height:o}}return[c,u]}function zc(e,t,r,n){if(n==="any")return Il(e,{x:t,y:r,width:1,height:1});if(n==="vertical"&&(t=e.x),n==="horizontal"&&(r=e.y),ll([t,r],e))return;let o=t-e.x,i=e.x+e.width-t,l=r-e.y+1,a=e.y+e.height-r,s=Math.min(n==="vertical"?2**53-1:o,n==="vertical"?2**53-1:i,n==="horizontal"?2**53-1:l,n==="horizontal"?2**53-1:a);return s===a?{x:e.x,y:e.y+e.height,width:e.width,height:r-e.y-e.height+1}:s===l?{x:e.x,y:r,width:e.width,height:e.y-r}:s===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function Vn(e,t,r,n,o,i,l,a){return e<=o+l&&o<=e+r&&t<=i+a&&i<=t+n}function qr(e,t,r){return t>=e.x&&t<=e.x+e.width&&r>=e.y&&r<=e.y+e.height}function Il(e,t){let r=Math.min(e.x,t.x),n=Math.min(e.y,t.y);return{x:r,y:n,width:Math.max(e.x+e.width,t.x+t.width)-r,height:Math.max(e.y+e.height,t.y+t.height)-n}}function Ac(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Lc(e,t,r,n){if(e.x>t||e.y>r||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>r)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=r)return e;let o=t+4,i=r+4,l=-4-e.x,a=e.x+e.width-o,s=-4-e.y,c=e.y+e.height-i,u=l>0?e.x+Math.floor(l/n)*n:e.x,f=a>0?e.x+e.width-Math.floor(a/n)*n:e.x+e.width,p=s>0?e.y+Math.floor(s/n)*n:e.y,m=c>0?e.y+e.height-Math.floor(c/n)*n:e.y+e.height;return{x:u,y:p,width:f-u,height:m-p}}function Fc(e,t,r,n,o){let[i,l,a,s]=t,[c,u,f,p]=o,{x:m,y:h,width:v,height:S}=e,M=[];if(v<=0||S<=0)return M;let y=m+v,k=h+S,I=m<i,O=h<l,E=m+v>a,A=h+S>s,F=m>=i&&m<a||y>i&&y<=a||m<i&&y>a,C=h>=l&&h<s||k>l&&k<=s||h<l&&k>s;if(F&&C){let R=Math.max(m,i),L=Math.max(h,l),x=Math.min(y,a),w=Math.min(k,s);M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:c,y:u,width:f-c+1,height:p-u+1}})}if(I&&O){let R=m,L=h,x=Math.min(y,i),w=Math.min(k,l);M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:0,y:0,width:c+1,height:u+1}})}if(O&&F){let R=Math.max(m,i),L=h,x=Math.min(y,a),w=Math.min(k,l);M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:c,y:0,width:f-c+1,height:u+1}})}if(O&&E){let R=Math.max(m,a),L=h,x=y,w=Math.min(k,l);M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:f,y:0,width:r-f+1,height:u+1}})}if(I&&C){let R=m,L=Math.max(h,l),x=Math.min(y,i),w=Math.min(k,s);M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:0,y:u,width:c+1,height:p-u+1}})}if(E&&C){let R=Math.max(m,a),L=Math.max(h,l),x=y,w=Math.min(k,s);M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:f,y:u,width:r-f+1,height:p-u+1}})}if(I&&A){let R=m,L=Math.max(h,s),x=Math.min(y,i),w=k;M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:0,y:p,width:c+1,height:n-p+1}})}if(A&&F){let R=Math.max(m,i),L=Math.max(h,s),x=Math.min(y,a),w=k;M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:c,y:p,width:f-c+1,height:n-p+1}})}if(E&&A){let R=Math.max(m,a),L=Math.max(h,s),x=y,w=k;M.push({rect:{x:R,y:L,width:x-R,height:w-L},clip:{x:f,y:p,width:r-f+1,height:n-p+1}})}return M}var jc={kind:pe.Loading,allowOverlay:!1};function Tl(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v,S,M,y,k,I,O,E,A,F,C,R,L,x,w,T,P,b,J,_){let Z=(k==null?void 0:k.size)??9007199254740991,ee=performance.now(),V=w.baseFontFull;e.font=V;let ae={ctx:e},ne=[0,0],ce=S>0?Xr(s,S,c):0,ue,G,ye=Ml(y);return Dr(t,a,i,l,o,(Q,ie,te,de,Pe)=>{let be=Math.max(0,de-ie),De=ie+be,Ie=o+1,st=Q.width-be,vt=n-o-1;if(y.length>0){let Ye=!1;for(let We=0;We<y.length;We++){let Ue=y[We];if(Vn(De,Ie,st,vt,Ue.x,Ue.y,Ue.width,Ue.height)){Ye=!0;break}}if(!Ye)return}let Qe=()=>{e.save(),e.beginPath(),e.rect(De,Ie,st,vt),e.clip()},le=I.columns.hasIndex(Q.sourceIndex),Ne=f(Q.group??"").overrideTheme,ze=Q.themeOverride===void 0&&Ne===void 0?w:Pr(w,Ne,Q.themeOverride),Ke=ze.baseFontFull;Ke!==V&&(V=Ke,e.font=Ke),Qe();let Se;return bo(Pe,te,n,s,c,S,M,ye,(Ye,We,Ue,me,Ce)=>{var mr,lr,Qt;if(We<0||(ne[0]=Q.sourceIndex,ne[1]=We,k!==void 0&&!k.has(ne)))return;if(y.length>0){let Ve=!1;for(let xt=0;xt<y.length;xt++){let Mt=y[xt];if(Vn(ie,Ye,Q.width,Ue,Mt.x,Mt.y,Mt.width,Mt.height)){Ve=!0;break}}if(!Ve)return}let rt=I.rows.hasIndex(We),qe=m.hasIndex(We),Xe=We<s?u(ne):jc,ft=ie,et=Q.width,Ae=!1,St=!1;if(Xe.span!==void 0){let[Ve,xt]=Xe.span,Mt=`${We},${Ve},${xt},${Q.sticky}`;if(G===void 0&&(G=new Set),G.has(Mt)){Z--;return}else{let Nt=El(Xe.span,ie,Ye,Q.width,Ue,Q,r),Pt=Q.sticky?Nt[0]:Nt[1];if(!Q.sticky&&Nt[0]!==void 0&&(St=!0),Pt!==void 0){ft=Pt.x,et=Pt.width,G.add(Mt),e.restore(),Se=void 0,e.save(),e.beginPath();let $t=Math.max(0,de-Pt.x);e.rect(Pt.x+$t,Ye,Pt.width-$t,Ue),ue===void 0&&(ue=[]),ue.push({x:Pt.x+$t,y:Ye,width:Pt.width-$t,height:Ue}),e.clip(),Ae=!0}}}let zt=p==null?void 0:p(We),kt=Ce&&((mr=Q.trailingRowOptions)==null?void 0:mr.themeOverride)!==void 0?(lr=Q.trailingRowOptions)==null?void 0:lr.themeOverride:void 0,Rt=Xe.themeOverride===void 0&&zt===void 0&&kt===void 0?ze:Pr(ze,zt,kt,Xe.themeOverride);e.beginPath();let jt=Ks(ne,Xe,I),wt=Ys(ne,Xe,I,v),pr=Xe.span!==void 0&&I.columns.some(Ve=>Xe.span!==void 0&&Ve>=Xe.span[0]&&Ve<=Xe.span[1]);jt&&!h&&v?wt=0:jt&&v&&(wt=Math.max(wt,1)),pr&&wt++,jt||(rt&&wt++,le&&!Ce&&wt++);let Ar=Xe.kind===pe.Protected?Rt.bgCellMedium:Rt.bgCell,dt;if((me||Ar!==w.bgCell)&&(dt=fr(Ar,dt)),wt>0||qe){qe&&(dt=fr(Rt.bgHeader,dt));for(let Ve=0;Ve<wt;Ve++)dt=fr(Rt.accentLight,dt)}else if(O!==void 0){for(let Ve of O)if(Ve[0]===Q.sourceIndex&&Ve[1]===We){dt=fr(Rt.bgSearchResult,dt);break}}if(E!==void 0)for(let Ve=0;Ve<E.length;Ve++){let xt=E[Ve],Mt=xt.range;xt.style!=="solid-outline"&&Mt.x<=Q.sourceIndex&&Q.sourceIndex<Mt.x+Mt.width&&Mt.y<=We&&We<Mt.y+Mt.height&&(dt=fr(xt.color,dt))}let kr=!1;if(k!==void 0){let Ve=Ye+1,xt=(me?Ve+Ue-1:Math.min(Ve+Ue-1,n-ce))-Ve;(xt!==Ue-1||ft+1<=de)&&(kr=!0,e.save(),e.beginPath(),e.rect(ft+1,Ve,et-1,xt),e.clip()),dt=dt===void 0?Rt.bgCell:fr(dt,Rt.bgCell)}let ir=Q.sourceIndex===r.length-1,Ee=We===s-1;dt!==void 0&&(e.fillStyle=dt,Se!==void 0&&(Se.fillStyle=dt),k===void 0?e.fillRect(ft,Ye,et,Ue):e.fillRect(ft+1,Ye+1,et-(ir?2:1),Ue-(Ee?2:1))),Xe.style==="faded"&&(e.globalAlpha=.6);let yt;for(let Ve=0;Ve<C.length;Ve++){let xt=C[Ve];if(xt.item[0]===Q.sourceIndex&&xt.item[1]===We){yt=xt;break}}if(et>_&&!St){let Ve=Rt.baseFontFull;Ve!==V&&(e.font=Ve,V=Ve),Se=Ol(e,Xe,Q.sourceIndex,We,ir,Ee,ft,Ye,et,Ue,wt>0,Rt,dt??Rt.bgCell,A,F,(yt==null?void 0:yt.hoverAmount)??0,R,x,ee,L,Se,T,P,b,J)}return kr&&e.restore(),Xe.style==="faded"&&(e.globalAlpha=1),Z--,Ae&&(e.restore(),(Qt=Se==null?void 0:Se.deprep)==null||Qt.call(Se,ae),Se=void 0,Qe(),V=Ke,e.font=Ke),Z<=0}),e.restore(),Z<=0}),ue}var Kn=[0,0],Yn={x:0,y:0,width:0,height:0},gi=[void 0,()=>{}],pi=!1;function _c(){pi=!0}function Ol(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v,S,M,y,k,I,O,E,A,F){var P,b;let C,R;S!==void 0&&S[0][0]===r&&S[0][1]===n&&(C=S[1][0],R=S[1][1]);let L;Kn[0]=r,Kn[1]=n,Yn.x=l,Yn.y=a,Yn.width=s,Yn.height=c,gi[0]=E.getValue(Kn),gi[1]=J=>E.setValue(Kn,J),pi=!1;let x={ctx:e,theme:f,col:r,row:n,cell:t,rect:Yn,highlighted:u,cellFillColor:p,hoverAmount:v,frameTime:y,hoverX:C,drawState:gi,hoverY:R,imageLoader:m,spriteManager:h,hyperWrapping:M,overrideCursor:C===void 0?void 0:F,requestAnimationFrame:_c},w=Js(x,t.lastUpdated,y,I,o,i),T=A(t);if(T!==void 0){(I==null?void 0:I.renderer)!==T&&((P=I==null?void 0:I.deprep)==null||P.call(I,x),I=void 0);let J=(b=T.drawPrep)==null?void 0:b.call(T,x,I);k!==void 0&&!Fn(x.cell)?k(x,()=>T.draw(x,t)):T.draw(x,t),L=J===void 0?void 0:{deprep:J==null?void 0:J.deprep,fillStyle:J==null?void 0:J.fillStyle,font:J==null?void 0:J.font,renderer:T}}return(w||pi)&&(O==null||O(Kn)),L}function mi(e,t,r,n,o,i,l,a,s=-20,c=-20,u=32,f="center",p="square"){let m=Math.floor(o+l/2),h=p==="circle"?1e4:t.roundingRadius??4,v=rl(u,l,t.cellVerticalPadding),S=v/2,M=tl(f,n,i,t.cellHorizontalPadding,v),y=el(M,m,v),k=nl(n+s,o+c,y);switch(r){case!0:e.beginPath(),gr(e,M-v/2,m-v/2,v,v,h),p==="circle"&&(S*=.8,v*=.8),e.fillStyle=a?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(M-S+v/4.23,m-S+v/1.97),e.lineTo(M-S+v/2.42,m-S+v/1.44),e.lineTo(M-S+v/1.29,m-S+v/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break;case null:case!1:e.beginPath(),gr(e,M-v/2+.5,m-v/2+.5,v-1,v-1,h),e.lineWidth=1,e.strokeStyle=k?t.textDark:t.textMedium,e.stroke();break;case void 0:e.beginPath(),gr(e,M-v/2,m-v/2,v,v,h),e.fillStyle=k?t.textMedium:t.textLight,e.fill(),p==="circle"&&(S*=.8,v*=.8),e.beginPath(),e.moveTo(M-v/3,m),e.lineTo(M+v/3,m),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break;default:qo(r)}}function Nc(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v,S,M,y){var F,C,R,L;let k=l+a;if(k<=0)return;e.fillStyle=f.bgHeader,e.fillRect(0,0,o,k);let I=(F=n==null?void 0:n[0])==null?void 0:F[0],O=(C=n==null?void 0:n[0])==null?void 0:C[1],E=(R=n==null?void 0:n[1])==null?void 0:R[0],A=(L=n==null?void 0:n[1])==null?void 0:L[1];e.font=f.headerFontFull,Dr(t,0,i,0,k,(x,w,T,P)=>{var ye;if(S!==void 0&&!S.has([x.sourceIndex,-1]))return;let b=Math.max(0,P-w);e.save(),e.beginPath(),e.rect(w+b,a,x.width-b,l),e.clip();let J=v(x.group??"").overrideTheme,_=x.themeOverride===void 0&&J===void 0?f:Pr(f,J,x.themeOverride);_.bgHeader!==f.bgHeader&&(e.fillStyle=_.bgHeader,e.fill()),_!==f&&(e.font=_.baseFontFull);let Z=u.columns.hasIndex(x.sourceIndex),ee=s!==void 0||c,V=!ee&&O===-1&&I===x.sourceIndex,ae=ee?0:((ye=m.find(Q=>Q.item[0]===x.sourceIndex&&Q.item[1]===-1))==null?void 0:ye.hoverAmount)??0,ne=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===x.sourceIndex,ce=Z?_.accentColor:ne?_.bgHeaderHasFocus:_.bgHeader,ue=r?a:0,G=x.sourceIndex===0?0:1;Z?(e.fillStyle=ce,e.fillRect(w+G,ue,x.width-G,l)):(ne||ae>0)&&(e.beginPath(),e.rect(w+G,ue,x.width-G,l),ne&&(e.fillStyle=_.bgHeaderHasFocus,e.fill()),ae>0&&(e.globalAlpha=ae,e.fillStyle=_.bgHeaderHovered,e.fill(),e.globalAlpha=1)),zl(e,w,ue,x.width,l,x,Z,_,V,V?E:void 0,V?A:void 0,ne,ae,p,M,y),e.restore()}),r&&Wc(e,t,o,i,a,n,f,p,m,h,v,S)}function Wc(e,t,r,n,o,i,l,a,s,c,u,f){let[p,m]=(i==null?void 0:i[0])??[],h=0;Rl(t,r,n,o,(v,S,M,y,k,I)=>{if(f!==void 0&&!f.hasItemInRectangle({x:v[0],y:-2,width:v[1]-v[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(M,y,k,I),e.clip();let O=u(S),E=(O==null?void 0:O.overrideTheme)===void 0?l:Pr(l,O.overrideTheme),A=m===-2&&p!==void 0&&p>=v[0]&&p<=v[1],F=A?E.bgHeaderHovered:E.bgHeader;if(F!==l.bgHeader&&(e.fillStyle=F,e.fill()),e.fillStyle=E.textGroupHeader??E.textHeader,O!==void 0){let C=M;if(O.icon!==void 0&&(a.drawSprite(O.icon,"normal",e,C+8,(o-20)/2,20,E),C+=26),e.fillText(O.name,C+8,o/2+Hr(e,l.headerFontFull)),O.actions!==void 0&&A){let R=Pl({x:M,y,width:k,height:I},O.actions);e.beginPath();let L=R[0].x-10,x=M+k-L;e.rect(L,0,x,o);let w=e.createLinearGradient(L,0,L+x,0),T=gn(F,0);w.addColorStop(0,T),w.addColorStop(10/x,F),w.addColorStop(1,F),e.fillStyle=w,e.fill(),e.globalAlpha=.6;let[P,b]=(i==null?void 0:i[1])??[-1,-1];for(let J=0;J<O.actions.length;J++){let _=O.actions[J],Z=R[J],ee=qr(Z,P+M,b);ee&&(e.globalAlpha=1),a.drawSprite(_.icon,"normal",e,Z.x+Z.width/2-10,Z.y+Z.height/2-10,20,E),ee&&(e.globalAlpha=.6)}e.globalAlpha=1}}M!==0&&c(v[0])&&(e.beginPath(),e.moveTo(M+.5,0),e.lineTo(M+.5,o),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),h=M+k}),e.beginPath(),e.moveTo(h+.5,0),e.lineTo(h+.5,o),e.moveTo(0,o+.5),e.lineTo(r,o+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}var yn=30;function Bc(e,t,r,n,o){return o?{x:e,y:t,width:yn,height:Math.min(yn,n)}:{x:e+r-yn,y:Math.max(t,t+n/2-yn/2),width:yn,height:Math.min(yn,n)}}function Pl(e,t){let r=[],n=e.x+e.width-26*t.length,o=e.y+e.height/2-13;for(let i=0;i<t.length;i++)r.push({x:n,y:o,width:26,height:26}),n+=26;return r}function Gn(e,t,r){return!r||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Hl(e,t,r,n,o,i,l,a){var M;let s=l.cellHorizontalPadding,c=l.headerIconSize,u=Bc(r,n,o,i,!1),f=r+s,p=t.icon===void 0?void 0:{x:f,y:n+(i-c)/2,width:c,height:c},m=p===void 0||t.overlayIcon===void 0?void 0:{x:p.x+9,y:p.y+6,width:18,height:18};p!==void 0&&(f+=Math.ceil(c*1.3));let h={x:f,y:n,width:o-f,height:i},v;if(t.indicatorIcon!==void 0){let y=e===void 0?((M=dl(t.title,l.headerFontFull))==null?void 0:M.width)??0:wn(t.title,e,l.headerFontFull).width;h.width=y,f+=y+s,v={x:f,y:n+(i-c)/2,width:c,height:c}}let S=r+o/2;return{menuBounds:Gn(u,S,a),iconBounds:Gn(p,S,a),iconOverlayBounds:Gn(m,S,a),textBounds:Gn(h,S,a),indicatorIconBounds:Gn(v,S,a)}}function Dl(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){let y=i.rowMarkerChecked;y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=f),mi(e,i.headerRowMarkerTheme===void 0?a:Pr(a,i.headerRowMarkerTheme),y,t,r,n,o,!1,void 0,void 0,18,"center",i.rowMarker),y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}let S=l?a.textHeaderSelected:a.textHeader,M=i.hasMenu===!0&&(s||m&&l)&&v.menuBounds!==void 0;if(i.icon!==void 0&&v.iconBounds!==void 0){let y=l?"selected":"normal";i.style==="highlight"&&(y=l?"selected":"special"),p.drawSprite(i.icon,y,e,v.iconBounds.x,v.iconBounds.y,v.iconBounds.width,a),i.overlayIcon!==void 0&&v.iconOverlayBounds!==void 0&&p.drawSprite(i.overlayIcon,l?"selected":"special",e,v.iconOverlayBounds.x,v.iconOverlayBounds.y,v.iconOverlayBounds.width,a)}if(M&&n>35){let y=h?35:n-35,k=h?35*.7:n-35*.7,I=y/n,O=k/n,E=e.createLinearGradient(t,0,t+n,0),A=gn(S,0);E.addColorStop(h?1:0,S),E.addColorStop(I,S),E.addColorStop(O,A),E.addColorStop(h?0:1,A),e.fillStyle=E}else e.fillStyle=S;if(h&&(e.textAlign="right"),v.textBounds!==void 0&&e.fillText(i.title,h?v.textBounds.x+v.textBounds.width:v.textBounds.x,r+o/2+Hr(e,a.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&v.indicatorIconBounds!==void 0&&(!M||!Vn(v.menuBounds.x,v.menuBounds.y,v.menuBounds.width,v.menuBounds.height,v.indicatorIconBounds.x,v.indicatorIconBounds.y,v.indicatorIconBounds.width,v.indicatorIconBounds.height))){let y=l?"selected":"normal";i.style==="highlight"&&(y=l?"selected":"special"),p.drawSprite(i.indicatorIcon,y,e,v.indicatorIconBounds.x,v.indicatorIconBounds.y,v.indicatorIconBounds.width,a)}if(M&&v.menuBounds!==void 0){let y=v.menuBounds,k=c!==void 0&&u!==void 0&&qr(y,c+t,u+r);if(k||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===cs.Triangle){e.beginPath();let I=y.x+y.width/2-5.5,O=y.y+y.height/2-3;rc(e,[{x:I,y:O},{x:I+11,y:O},{x:I+5.5,y:O+6}],1),e.fillStyle=S,e.fill()}else if(i.menuIcon===cs.Dots)e.beginPath(),tc(e,y.x+y.width/2,y.y+y.height/2),e.fillStyle=S,e.fill();else{let I=y.x+(y.width-a.headerIconSize)/2,O=y.y+(y.height-a.headerIconSize)/2;p.drawSprite(i.menuIcon,"normal",e,I,O,a.headerIconSize,a)}k||(e.globalAlpha=1)}}function zl(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v){let S=ni(i.title)==="rtl",M=Hl(e,i,t,r,n,o,a,S);h===void 0?Dl(e,t,r,n,o,i,l,a,s,c,u,p,m,v,S,M):h({ctx:e,theme:a,rect:{x:t,y:r,width:n,height:o},column:i,columnIndex:i.sourceIndex,isSelected:l,hoverAmount:p,isHovered:s,hasSelectedCell:f,spriteManager:m,menuBounds:(M==null?void 0:M.menuBounds)??{x:0,y:0,height:0,width:0}},()=>Dl(e,t,r,n,o,i,l,a,s,c,u,p,m,v,S,M))}var $c=X(((e,t)=>{var r=fo();t.exports=(function(){try{var n=r(Object,"defineProperty");return n({},"",{}),n}catch{}})()})),Vc=X(((e,t)=>{var r=$c();function n(o,i,l){i=="__proto__"&&r?r(o,i,{configurable:!0,enumerable:!0,value:l,writable:!0}):o[i]=l}t.exports=n})),Kc=X(((e,t)=>{function r(n,o,i,l){for(var a=-1,s=n==null?0:n.length;++a<s;){var c=n[a];o(l,c,i(c),n)}return l}t.exports=r})),Yc=X(((e,t)=>{function r(n){return function(o,i,l){for(var a=-1,s=Object(o),c=l(o),u=c.length;u--;){var f=c[n?u:++a];if(i(s[f],f,s)===!1)break}return o}}t.exports=r})),Gc=X(((e,t)=>{t.exports=Yc()()})),Uc=X(((e,t)=>{function r(n,o){for(var i=-1,l=Array(n);++i<n;)l[i]=o(i);return l}t.exports=r})),Xc=X(((e,t)=>{function r(){return!1}t.exports=r})),Al=X(((e,t)=>{var r=fn(),n=Xc(),o=typeof e=="object"&&e&&!e.nodeType&&e,i=o&&typeof t=="object"&&t&&!t.nodeType&&t,l=i&&i.exports===o?r.Buffer:void 0;t.exports=(l?l.isBuffer:void 0)||n})),qc=X(((e,t)=>{var r=es(),n=ls(),o=hs(),i="[object Arguments]",l="[object Array]",a="[object Boolean]",s="[object Date]",c="[object Error]",u="[object Function]",f="[object Map]",p="[object Number]",m="[object Object]",h="[object RegExp]",v="[object Set]",S="[object String]",M="[object WeakMap]",y="[object ArrayBuffer]",k="[object DataView]",I="[object Float32Array]",O="[object Float64Array]",E="[object Int8Array]",A="[object Int16Array]",F="[object Int32Array]",C="[object Uint8Array]",R="[object Uint8ClampedArray]",L="[object Uint16Array]",x="[object Uint32Array]",w={};w[I]=w[O]=w[E]=w[A]=w[F]=w[C]=w[R]=w[L]=w[x]=!0,w[i]=w[l]=w[y]=w[a]=w[k]=w[s]=w[c]=w[u]=w[f]=w[p]=w[m]=w[h]=w[v]=w[S]=w[M]=!1;function T(P){return o(P)&&n(P.length)&&!!w[r(P)]}t.exports=T})),Zc=X(((e,t)=>{function r(n){return function(o){return n(o)}}t.exports=r})),Jc=X(((e,t)=>{var r=J0(),n=typeof e=="object"&&e&&!e.nodeType&&e,o=n&&typeof t=="object"&&t&&!t.nodeType&&t,i=o&&o.exports===n&&r.process;t.exports=(function(){try{return o&&o.require&&o.require("util").types||i&&i.binding&&i.binding("util")}catch{}})()})),Ll=X(((e,t)=>{var r=qc(),n=Zc(),o=Jc(),i=o&&o.isTypedArray;t.exports=i?n(i):r})),Qc=X(((e,t)=>{var r=Uc(),n=ts(),o=Ln(),i=Al(),l=rs(),a=Ll(),s=Object.prototype.hasOwnProperty;function c(u,f){var p=o(u),m=!p&&n(u),h=!p&&!m&&i(u),v=!p&&!m&&!h&&a(u),S=p||m||h||v,M=S?r(u.length,String):[],y=M.length;for(var k in u)(f||s.call(u,k))&&!(S&&(k=="length"||h&&(k=="offset"||k=="parent")||v&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||l(k,y)))&&M.push(k);return M}t.exports=c})),eu=X(((e,t)=>{var r=Object.prototype;function n(o){var i=o&&o.constructor;return o===(typeof i=="function"&&i.prototype||r)}t.exports=n})),tu=X(((e,t)=>{function r(n,o){return function(i){return n(o(i))}}t.exports=r})),ru=X(((e,t)=>{t.exports=tu()(Object.keys,Object)})),nu=X(((e,t)=>{var r=eu(),n=ru(),o=Object.prototype.hasOwnProperty;function i(l){if(!r(l))return n(l);var a=[];for(var s in Object(l))o.call(l,s)&&s!="constructor"&&a.push(s);return a}t.exports=i})),vi=X(((e,t)=>{var r=Qc(),n=nu(),o=fi();function i(l){return o(l)?r(l):n(l)}t.exports=i})),ou=X(((e,t)=>{var r=Gc(),n=vi();function o(i,l){return i&&r(i,l,n)}t.exports=o})),iu=X(((e,t)=>{var r=fi();function n(o,i){return function(l,a){if(l==null)return l;if(!r(l))return o(l,a);for(var s=l.length,c=i?s:-1,u=Object(l);(i?c--:++c<s)&&a(u[c],c,u)!==!1;);return l}}t.exports=n})),lu=X(((e,t)=>{var r=ou();t.exports=iu()(r)})),au=X(((e,t)=>{var r=lu();function n(o,i,l,a){return r(o,function(s,c,u){i(a,s,l(s),u)}),a}t.exports=n})),su=X(((e,t)=>{var r=Yi();function n(){this.__data__=new r,this.size=0}t.exports=n})),cu=X(((e,t)=>{function r(n){var o=this.__data__,i=o.delete(n);return this.size=o.size,i}t.exports=r})),uu=X(((e,t)=>{function r(n){return this.__data__.get(n)}t.exports=r})),du=X(((e,t)=>{function r(n){return this.__data__.has(n)}t.exports=r})),hu=X(((e,t)=>{var r=Yi(),n=Qa(),o=ss(),i=200;function l(a,s){var c=this.__data__;if(c instanceof r){var u=c.__data__;if(!n||u.length<i-1)return u.push([a,s]),this.size=++c.size,this;c=this.__data__=new o(u)}return c.set(a,s),this.size=c.size,this}t.exports=l})),Fl=X(((e,t)=>{var r=Yi(),n=su(),o=cu(),i=uu(),l=du(),a=hu();function s(c){this.size=(this.__data__=new r(c)).size}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=l,s.prototype.set=a,t.exports=s})),fu=X(((e,t)=>{function r(n,o){for(var i=-1,l=n==null?0:n.length;++i<l;)if(o(n[i],i,n))return!0;return!1}t.exports=r})),jl=X(((e,t)=>{var r=yl(),n=fu(),o=bl(),i=1,l=2;function a(s,c,u,f,p,m){var h=u&i,v=s.length,S=c.length;if(v!=S&&!(h&&S>v))return!1;var M=m.get(s),y=m.get(c);if(M&&y)return M==c&&y==s;var k=-1,I=!0,O=u&l?new r:void 0;for(m.set(s,c),m.set(c,s);++k<v;){var E=s[k],A=c[k];if(f)var F=h?f(A,E,k,c,s,m):f(E,A,k,s,c,m);if(F!==void 0){if(F)continue;I=!1;break}if(O){if(!n(c,function(C,R){if(!o(O,R)&&(E===C||p(E,C,u,f,m)))return O.push(R)})){I=!1;break}}else if(!(E===A||p(E,A,u,f,m))){I=!1;break}}return m.delete(s),m.delete(c),I}t.exports=a})),gu=X(((e,t)=>{t.exports=fn().Uint8Array})),pu=X(((e,t)=>{function r(n){var o=-1,i=Array(n.size);return n.forEach(function(l,a){i[++o]=[a,l]}),i}t.exports=r})),mu=X(((e,t)=>{var r=as(),n=gu(),o=os(),i=jl(),l=pu(),a=hi(),s=1,c=2,u="[object Boolean]",f="[object Date]",p="[object Error]",m="[object Map]",h="[object Number]",v="[object RegExp]",S="[object Set]",M="[object String]",y="[object Symbol]",k="[object ArrayBuffer]",I="[object DataView]",O=r?r.prototype:void 0,E=O?O.valueOf:void 0;function A(F,C,R,L,x,w,T){switch(R){case I:if(F.byteLength!=C.byteLength||F.byteOffset!=C.byteOffset)return!1;F=F.buffer,C=C.buffer;case k:return!(F.byteLength!=C.byteLength||!w(new n(F),new n(C)));case u:case f:case h:return o(+F,+C);case p:return F.name==C.name&&F.message==C.message;case v:case M:return F==C+"";case m:var P=l;case S:var b=L&s;if(P||(P=a),F.size!=C.size&&!b)return!1;var J=T.get(F);if(J)return J==C;L|=c,T.set(F,C);var _=i(P(F),P(C),L,x,w,T);return T.delete(F),_;case y:if(E)return E.call(F)==E.call(C)}return!1}t.exports=A})),vu=X(((e,t)=>{var r=Cl(),n=Ln();function o(i,l,a){var s=l(i);return n(i)?s:r(s,a(i))}t.exports=o})),wu=X(((e,t)=>{function r(n,o){for(var i=-1,l=n==null?0:n.length,a=0,s=[];++i<l;){var c=n[i];o(c,i,n)&&(s[a++]=c)}return s}t.exports=r})),yu=X(((e,t)=>{function r(){return[]}t.exports=r})),bu=X(((e,t)=>{var r=wu(),n=yu(),o=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols;t.exports=i?function(l){return l==null?[]:(l=Object(l),r(i(l),function(a){return o.call(l,a)}))}:n})),xu=X(((e,t)=>{var r=vu(),n=bu(),o=vi();function i(l){return r(l,o,n)}t.exports=i})),Cu=X(((e,t)=>{var r=xu(),n=1,o=Object.prototype.hasOwnProperty;function i(l,a,s,c,u,f){var p=s&n,m=r(l),h=m.length;if(h!=r(a).length&&!p)return!1;for(var v=h;v--;){var S=m[v];if(!(p?S in a:o.call(a,S)))return!1}var M=f.get(l),y=f.get(a);if(M&&y)return M==a&&y==l;var k=!0;f.set(l,a),f.set(a,l);for(var I=p;++v<h;){S=m[v];var O=l[S],E=a[S];if(c)var A=p?c(E,O,S,a,l,f):c(O,E,S,l,a,f);if(!(A===void 0?O===E||u(O,E,s,c,f):A)){k=!1;break}I||(I=S=="constructor")}if(k&&!I){var F=l.constructor,C=a.constructor;F!=C&&"constructor"in l&&"constructor"in a&&!(typeof F=="function"&&F instanceof F&&typeof C=="function"&&C instanceof C)&&(k=!1)}return f.delete(l),f.delete(a),k}t.exports=i})),Su=X(((e,t)=>{t.exports=fo()(fn(),"DataView")})),ku=X(((e,t)=>{t.exports=fo()(fn(),"Promise")})),Mu=X(((e,t)=>{t.exports=fo()(fn(),"WeakMap")})),Ru=X(((e,t)=>{var r=Su(),n=Qa(),o=ku(),i=xl(),l=Mu(),a=es(),s=q0(),c="[object Map]",u="[object Object]",f="[object Promise]",p="[object Set]",m="[object WeakMap]",h="[object DataView]",v=s(r),S=s(n),M=s(o),y=s(i),k=s(l),I=a;(r&&I(new r(new ArrayBuffer(1)))!=h||n&&I(new n)!=c||o&&I(o.resolve())!=f||i&&I(new i)!=p||l&&I(new l)!=m)&&(I=function(O){var E=a(O),A=E==u?O.constructor:void 0,F=A?s(A):"";if(F)switch(F){case v:return h;case S:return c;case M:return f;case y:return p;case k:return m}return E}),t.exports=I})),Eu=X(((e,t)=>{var r=Fl(),n=jl(),o=mu(),i=Cu(),l=Ru(),a=Ln(),s=Al(),c=Ll(),u=1,f="[object Arguments]",p="[object Array]",m="[object Object]",h=Object.prototype.hasOwnProperty;function v(S,M,y,k,I,O){var E=a(S),A=a(M),F=E?p:l(S),C=A?p:l(M);F=F==f?m:F,C=C==f?m:C;var R=F==m,L=C==m,x=F==C;if(x&&s(S)){if(!s(M))return!1;E=!0,R=!1}if(x&&!R)return O||(O=new r),E||c(S)?n(S,M,y,k,I,O):o(S,M,F,y,k,I,O);if(!(y&u)){var w=R&&h.call(S,"__wrapped__"),T=L&&h.call(M,"__wrapped__");if(w||T){var P=w?S.value():S,b=T?M.value():M;return O||(O=new r),I(P,b,y,k,O)}}return x?(O||(O=new r),i(S,M,y,k,I,O)):!1}t.exports=v})),_l=X(((e,t)=>{var r=Eu(),n=hs();function o(i,l,a,s,c){return i===l?!0:i==null||l==null||!n(i)&&!n(l)?i!==i&&l!==l:r(i,l,a,s,o,c)}t.exports=o})),Iu=X(((e,t)=>{var r=Fl(),n=_l(),o=1,i=2;function l(a,s,c,u){var f=c.length,p=f,m=!u;if(a==null)return!p;for(a=Object(a);f--;){var h=c[f];if(m&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++f<p;){h=c[f];var v=h[0],S=a[v],M=h[1];if(m&&h[2]){if(S===void 0&&!(v in a))return!1}else{var y=new r;if(u)var k=u(S,M,v,a,s,y);if(!(k===void 0?n(M,S,o|i,u,y):k))return!1}}return!0}t.exports=l})),Nl=X(((e,t)=>{var r=ho();function n(o){return o===o&&!r(o)}t.exports=n})),Tu=X(((e,t)=>{var r=Nl(),n=vi();function o(i){for(var l=n(i),a=l.length;a--;){var s=l[a],c=i[s];l[a]=[s,c,r(c)]}return l}t.exports=o})),Wl=X(((e,t)=>{function r(n,o){return function(i){return i==null?!1:i[n]===o&&(o!==void 0||n in Object(i))}}t.exports=r})),Ou=X(((e,t)=>{var r=Iu(),n=Tu(),o=Wl();function i(l){var a=n(l);return a.length==1&&a[0][2]?o(a[0][0],a[0][1]):function(s){return s===l||r(s,l,a)}}t.exports=i})),Bl=X(((e,t)=>{var r=X0(),n=Gi();function o(i,l){l=r(l,i);for(var a=0,s=l.length;i!=null&&a<s;)i=i[n(l[a++])];return a&&a==s?i:void 0}t.exports=o})),Pu=X(((e,t)=>{var r=Bl();function n(o,i,l){var a=o==null?void 0:r(o,i);return a===void 0?l:a}t.exports=n})),Hu=X(((e,t)=>{function r(n,o){return n!=null&&o in Object(n)}t.exports=r})),Du=X(((e,t)=>{var r=Hu(),n=Y0();function o(i,l){return i!=null&&n(i,l,r)}t.exports=o})),zu=X(((e,t)=>{var r=_l(),n=Pu(),o=Du(),i=ns(),l=Nl(),a=Wl(),s=Gi(),c=1,u=2;function f(p,m){return i(p)&&l(m)?a(s(p),m):function(h){var v=n(h,p);return v===void 0&&v===m?o(h,p):r(m,v,c|u)}}t.exports=f})),Au=X(((e,t)=>{function r(n){return n}t.exports=r})),Lu=X(((e,t)=>{function r(n){return function(o){return o==null?void 0:o[n]}}t.exports=r})),Fu=X(((e,t)=>{var r=Bl();function n(o){return function(i){return r(i,o)}}t.exports=n})),ju=X(((e,t)=>{var r=Lu(),n=Fu(),o=ns(),i=Gi();function l(a){return o(a)?r(i(a)):n(a)}t.exports=l})),_u=X(((e,t)=>{var r=Ou(),n=zu(),o=Au(),i=Ln(),l=ju();function a(s){return typeof s=="function"?s:s==null?o:typeof s=="object"?i(s)?n(s[0],s[1]):r(s):l(s)}t.exports=a})),Nu=X(((e,t)=>{var r=Kc(),n=au(),o=_u(),i=Ln();function l(a,s){return function(c,u){var f=i(c)?r:n,p=s?s():{};return f(c,a,o(u,2),p)}}t.exports=l})),Wu=Gt(X(((e,t)=>{var r=Vc(),n=Nu(),o=Object.prototype.hasOwnProperty;t.exports=n(function(i,l,a){o.call(i,a)?i[a].push(l):r(i,a,[l])})}))(),1);function Bu(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v,S,M,y){if(M!==void 0||t[t.length-1]!==r[t.length-1])return;let k=Ml(S);Dr(t,s,l,a,i,(I,O,E,A,F)=>{if(I!==t[t.length-1])return;O+=I.width;let C=Math.max(O,A);C>n||(e.save(),e.beginPath(),e.rect(C,i+1,1e4,o-i-1),e.clip(),bo(F,E,o,c,u,h,v,k,(R,L,x,w)=>{if(!w&&S.length>0&&!S.some(_=>Vn(O,R,1e4,x,_.x,_.y,_.width,_.height)))return;let T=p.hasIndex(L),P=m.hasIndex(L);e.beginPath();let b=f==null?void 0:f(L),J=b===void 0?y:Pr(y,b);J.bgCell!==y.bgCell&&(e.fillStyle=J.bgCell,e.fillRect(O,R,1e4,x)),P&&(e.fillStyle=J.bgHeader,e.fillRect(O,R,1e4,x)),T&&(e.fillStyle=J.accentLight,e.fillRect(O,R,1e4,x))}),e.restore())})}function $u(e,t,r,n,o,i,l,a,s){let c=!1;for(let h of t)if(!h.sticky){c=l(h.sourceIndex);break}let u=s.horizontalBorderColor??s.borderColor,f=s.borderColor,p=c?vn(t):0,m;if(p!==0&&(m=ds(f,s.bgCell),e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,n),e.strokeStyle=m,e.stroke()),o>0){let h=f===u&&m!==void 0?m:ds(u,s.bgCell),v=Xr(i,o,a);e.beginPath(),e.moveTo(0,n-v+.5),e.lineTo(r,n-v+.5),e.strokeStyle=h,e.stroke()}}var $l=(e,t,r)=>{let n=0,o=t,i=0,l=r;if(e!==void 0&&e.length>0){n=2**53-1,i=2**53-1,o=-(2**53-1),l=-(2**53-1);for(let a of e)n=Math.min(n,a.x-1),o=Math.max(o,a.x+a.width+1),i=Math.min(i,a.y-1),l=Math.max(l,a.y+a.height+1)}return{minX:n,maxX:o,minY:i,maxY:l}};function Vu(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h){var x,w;let v=h.bgCell,{minX:S,maxX:M,minY:y,maxY:k}=$l(a,i,l),I=[],O=l-Xr(m,p,c),E=s,A=r,F=0;for(;E+o<O;){let T=E+o,P=c(A);if(T>=y&&T<=k-1){let b=(x=u==null?void 0:u(A))==null?void 0:x.bgCell;b!==void 0&&b!==v&&A>=m-p&&I.push({x:S,y:T,w:M-S,h:P,color:b})}E+=P,A<m-p&&(F=E),A++}let C=0,R=Math.min(O,k)-F;if(R>0)for(let T=0;T<t.length;T++){let P=t[T];if(P.width===0)continue;let b=P.sticky?C:C+n,J=(w=P.themeOverride)==null?void 0:w.bgCell;J!==void 0&&J!==v&&b>=S&&b<=M&&f(T+1)&&I.push({x:b,y:F,w:P.width,h:R,color:J}),C+=P.width}if(I.length===0)return;let L;e.beginPath();for(let T=I.length-1;T>=0;T--){let P=I[T];L===void 0?L=P.color:P.color!==L&&(e.fillStyle=L,e.fill(),e.beginPath(),L=P.color),e.rect(P.x,P.y,P.w,P.h)}L!==void 0&&(e.fillStyle=L,e.fill()),e.beginPath()}function Vl(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v,S,M=!1){if(s!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,l);for(let x of s)e.rect(x.x+1,x.y+1,x.width-1,x.height-1);e.clip("evenodd")}let y=S.horizontalBorderColor??S.borderColor,k=S.borderColor,{minX:I,maxX:O,minY:E,maxY:A}=$l(a,i,l),F=[];e.beginPath();let C=.5;for(let x=0;x<t.length;x++){let w=t[x];if(w.width===0)continue;C+=w.width;let T=w.sticky?C:C+n;T>=I&&T<=O&&m(x+1)&&F.push({x1:T,y1:Math.max(c,E),x2:T,y2:Math.min(l,A),color:k})}let R=l+.5;for(let x=v-h;x<v;x++){let w=f(x);R-=w,F.push({x1:I,y1:R,x2:O,y2:R,color:y})}if(M!==!0){let x=u+.5,w=r,T=R;for(;x+o<T;){let P=x+o;if(P>=E&&P<=A-1){let b=p==null?void 0:p(w);F.push({x1:I,y1:P,x2:O,y2:P,color:(b==null?void 0:b.horizontalBorderColor)??(b==null?void 0:b.borderColor)??y})}x+=f(w),w++}}let L=(0,Wu.default)(F,x=>x.color);for(let x of Object.keys(L)){e.strokeStyle=x;for(let w of L[x])e.moveTo(w.x1,w.y1),e.lineTo(w.x2,w.y2);e.stroke(),e.beginPath()}s!==void 0&&e.restore()}function Ku(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v,S,M,y){let k=[];e.imageSmoothingEnabled=!1;let I=Math.min(o.cellYOffset,l),O=Math.max(o.cellYOffset,l),E=0;if(typeof M=="number")E+=(O-I)*M;else for(let T=I;T<O;T++)E+=M(T);l>o.cellYOffset&&(E=-E),E+=s-o.translateY;let A=Math.min(o.cellXOffset,i),F=Math.max(o.cellXOffset,i),C=0;for(let T=A;T<F;T++)C+=v[T].width;i>o.cellXOffset&&(C=-C),C+=a-o.translateX;let R=vn(S);if(C!==0&&E!==0)return{regions:[]};let L=c>0?Xr(p,c,M):0,x=u-R-Math.abs(C),w=f-m-L-Math.abs(E)-1;if(x>150&&w>150){let T={sx:0,sy:0,sw:u*h,sh:f*h,dx:0,dy:0,dw:u*h,dh:f*h};if(E>0?(T.sy=(m+1)*h,T.sh=w*h,T.dy=(E+m+1)*h,T.dh=w*h,k.push({x:0,y:m,width:u,height:E+1})):E<0&&(T.sy=(-E+m+1)*h,T.sh=w*h,T.dy=(m+1)*h,T.dh=w*h,k.push({x:0,y:f+E-L,width:u,height:-E+L})),C>0?(T.sx=R*h,T.sw=x*h,T.dx=(C+R)*h,T.dw=x*h,k.push({x:R-1,y:0,width:C+2,height:f})):C<0&&(T.sx=(R-C)*h,T.sw=x*h,T.dx=R*h,T.dw=x*h,k.push({x:u+C,y:0,width:-C,height:f})),e.setTransform(1,0,0,1,0,0),y){if(R>0&&C!==0&&E===0&&(n===void 0||(r==null?void 0:r[1])!==!1)){let P=R*h,b=f*h;e.drawImage(t,0,0,P,b,0,0,P,b)}if(L>0&&C===0&&E!==0&&(n===void 0||(r==null?void 0:r[0])!==!1)){let P=(f-L)*h,b=u*h,J=L*h;e.drawImage(t,0,P,b,J,0,P,b,J)}}e.drawImage(t,T.sx,T.sy,T.sw,T.sh,T.dx,T.dy,T.dw,T.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:k}}function Yu(e,t,r,n,o,i,l,a,s,c){let u=[];return t!==e.cellXOffset||r!==e.cellYOffset||n!==e.translateX||o!==e.translateY||Dr(s,r,n,o,a,(f,p,m,h)=>{if(f.sourceIndex===c){let v=Math.max(p,h)+1;return u.push({x:v,y:0,width:i-v,height:l}),!0}}),u}function Gu(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let r;for(let n=0;n<e.mappedColumns.length;n++){let o=e.mappedColumns[n],i=t.mappedColumns[n];if(Zo(o,i))continue;if(r!==void 0||o.width===i.width)return!1;let{width:l,...a}=o,{width:s,...c}=i;if(!Zo(a,c))return!1;r=n}return r===void 0?!0:r}return!0}function Kl(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v){let S=h==null?void 0:h.filter(A=>A.style!=="no-outline");if(S===void 0||S.length===0)return;let M=vn(a),y=Xr(m,p,f),k=[s,0,a.length,m-p],I=[M,0,t,r-y],O=S.map(A=>{let F=A.range,C=A.style??"dashed";return Fc(F,k,t,r,I).map(R=>{let L=R.rect,x=ai(L.x,L.y,t,r,u,c+u,n,o,i,l,m,s,p,a,f),w=L.width===1&&L.height===1?x:ai(L.x+L.width-1,L.y+L.height-1,t,r,u,c+u,n,o,i,l,m,s,p,a,f);return L.x+L.width>=a.length&&--w.width,L.y+L.height>=m&&--w.height,{color:A.color,style:C,clip:R.clip,rect:Lc({x:x.x,y:x.y,width:w.x+w.width-x.x,height:w.y+w.height-x.y},t,r,8)}})}),E=()=>{e.lineWidth=1;let A=!1;for(let F of O)for(let C of F)if((C==null?void 0:C.rect)!==void 0&&Vn(0,0,t,r,C.rect.x,C.rect.y,C.rect.width,C.rect.height)){let R=A,L=!Ac(C.clip,C.rect);L&&(e.save(),e.rect(C.clip.x,C.clip.y,C.clip.width,C.clip.height),e.clip()),C.style==="dashed"&&!A?(e.setLineDash([5,3]),A=!0):(C.style==="solid"||C.style==="solid-outline")&&A&&(e.setLineDash([]),A=!1),e.strokeStyle=C.style==="solid-outline"?fr(fr(C.color,v.borderColor),v.bgCell):gn(C.color,1),e.strokeRect(C.rect.x+.5,C.rect.y+.5,C.rect.width-1,C.rect.height-1),L&&(e.restore(),A=R)}A&&e.setLineDash([])};return E(),E}function Yl(e,t,r,n,o){e.beginPath(),e.moveTo(t,r),e.lineTo(t,n),e.lineWidth=2,e.strokeStyle=o,e.stroke(),e.globalAlpha=1}function wi(e,t,r,n,o,i,l,a,s,c,u,f,p,m,h,v,S){if(u.current===void 0)return;let M=u.current.range,y=u.current.cell,k=[M.x+M.width-1,M.y+M.height-1];if(y[1]>=S&&k[1]>=S||!l.some(w=>w.sourceIndex===y[0]||w.sourceIndex===k[0]))return;let[I,O]=u.current.cell,E=p(u.current.cell),A=E.span??[I,I],F=O>=S-m,C=m>0&&!F?Xr(S,m,f)-1:0,R=k[1],L;if(Dr(l,n,o,i,c,(w,T,P,b,J)=>{if(w.sticky&&I>w.sourceIndex)return;let _=w.sourceIndex<A[0],Z=w.sourceIndex>A[1],ee=w.sourceIndex===k[0];if(!(!ee&&(_||Z)))return bo(J,P,r,S,f,m,h,void 0,(V,ae,ne)=>{if(ae!==O&&ae!==R)return;let ce=T,ue=w.width;if(E.span!==void 0){let G=El(E.span,T,V,w.width,ne,w,a),ye=w.sticky?G[0]:G[1];ye!==void 0&&(ce=ye.x,ue=ye.width)}return ae===R&&ee&&v&&(L=()=>{var G;b>ce&&!w.sticky&&(e.beginPath(),e.rect(b,0,t-b,r),e.clip()),e.beginPath(),e.rect(ce+ue-4,V+ne-4,4,4),e.fillStyle=((G=w.themeOverride)==null?void 0:G.accentColor)??s.accentColor,e.fill()}),L!==void 0}),L!==void 0}),L===void 0)return;let x=()=>{e.save(),e.beginPath(),e.rect(0,c,t,r-c-C),e.clip(),L==null||L(),e.restore()};return x(),x}function Uu(e,t,r,n,o,i,l,a,s){s===void 0||s.size===0||(e.beginPath(),Rl(t,r,i,n,(c,u,f,p,m,h)=>{s.hasItemInRectangle({x:c[0],y:-2,width:c[1]-c[0]+1,height:1})&&e.rect(f,p,m,h)}),Dr(t,a,i,l,o,(c,u,f,p)=>{let m=Math.max(0,p-u),h=u+m+1,v=c.width-m-1;s.has([c.sourceIndex,-1])&&e.rect(h,n,v,o-n)}),e.clip())}function Xu(e,t,r,n,o,i,l,a,s,c){let u=0;return Dr(e,i,n,o,r,(f,p,m,h,v)=>(bo(v,m,t,l,a,s,c,void 0,(S,M,y,k)=>{k||(u=Math.max(M,u))}),!0)),u}function Gl(e,t){var ir;let{canvasCtx:r,headerCanvasCtx:n,width:o,height:i,cellXOffset:l,cellYOffset:a,translateX:s,translateY:c,mappedColumns:u,enableGroups:f,freezeColumns:p,dragAndDropState:m,theme:h,drawFocus:v,headerHeight:S,groupHeaderHeight:M,disabledRows:y,rowHeight:k,verticalBorder:I,overrideCursor:O,isResizing:E,selection:A,fillHandle:F,freezeTrailingRows:C,rows:R,getCellContent:L,getGroupDetails:x,getRowThemeOverride:w,isFocused:T,drawHeaderCallback:P,prelightCells:b,drawCellCallback:J,highlightRegions:_,resizeCol:Z,imageLoader:ee,lastBlitData:V,hoverValues:ae,hyperWrapping:ne,hoverInfo:ce,spriteManager:ue,maxScaleFactor:G,hasAppendRow:ye,touchMode:Q,enqueue:ie,renderStateProvider:te,getCellRenderer:de,renderStrategy:Pe,bufferACtx:be,bufferBCtx:De,damage:Ie,minimumCellWidth:st,resizeIndicator:vt}=e;if(o===0||i===0)return;let Qe=Pe==="double-buffer",le=Math.min(G,Math.ceil(window.devicePixelRatio??1)),Ne=Pe!=="direct"&&Gu(e,t),ze=r.canvas;(ze.width!==o*le||ze.height!==i*le)&&(ze.width=o*le,ze.height=i*le,ze.style.width=o+"px",ze.style.height=i+"px");let Ke=n.canvas,Se=f?M+S:S,Ye=Se+1;(Ke.width!==o*le||Ke.height!==Ye*le)&&(Ke.width=o*le,Ke.height=Ye*le,Ke.style.width=o+"px",Ke.style.height=Ye+"px");let We=be.canvas,Ue=De.canvas;Qe&&(We.width!==o*le||We.height!==i*le)&&(We.width=o*le,We.height=i*le,V.current!==void 0&&(V.current.aBufferScroll=void 0)),Qe&&(Ue.width!==o*le||Ue.height!==i*le)&&(Ue.width=o*le,Ue.height=i*le,V.current!==void 0&&(V.current.bBufferScroll=void 0));let me=V.current;if(Ne===!0&&l===(me==null?void 0:me.cellXOffset)&&a===(me==null?void 0:me.cellYOffset)&&s===(me==null?void 0:me.translateX)&&c===(me==null?void 0:me.translateY))return;let Ce=null;Qe&&(Ce=r);let rt=n,qe;qe=Qe?Ie===void 0?(me==null?void 0:me.lastBuffer)==="b"?be:De:(me==null?void 0:me.lastBuffer)==="b"?De:be:r;let Xe=qe.canvas,ft=Qe?Xe===We?Ue:We:ze,et=typeof k=="number"?()=>k:k;rt.save(),qe.save(),rt.beginPath(),qe.beginPath(),rt.textBaseline="middle",qe.textBaseline="middle",le!==1&&(rt.scale(le,le),qe.scale(le,le));let Ae=li(u,l,o,m,s),St=[],zt=v&&((ir=A.current)==null?void 0:ir.cell[1])===a&&c===0,kt=!1;if(_!==void 0){for(let Ee of _)if(Ee.style!=="no-outline"&&Ee.range.y===a&&c===0){kt=!0;break}}let Rt=()=>{Nc(rt,Ae,f,ce,o,s,S,M,m,E,A,h,ue,ae,I,x,Ie,P,Q),Vl(rt,Ae,a,s,c,o,i,void 0,void 0,M,Se,et,w,I,C,R,h,!0),rt.beginPath(),rt.moveTo(0,Ye-.5),rt.lineTo(o,Ye-.5),rt.strokeStyle=fr(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),rt.stroke(),kt&&Kl(rt,o,i,l,a,s,c,u,p,S,M,k,C,R,_,h),zt&&wi(rt,o,i,a,s,c,Ae,u,h,Se,A,et,L,C,ye,F,R)};if(Ie!==void 0){let Ee=Ae[Ae.length-1].sourceIndex+1,yt=Ie.hasItemInRegion([{x:l,y:-2,width:Ee,height:2},{x:l,y:a,width:Ee,height:300},{x:0,y:a,width:p,height:300},{x:0,y:-2,width:p,height:2},{x:l,y:R-C,width:Ee,height:C,when:C>0}]),mr=lr=>{Tl(lr,Ae,u,i,Se,s,c,a,R,et,L,x,w,y,T,v,C,ye,St,Ie,A,b,_,ee,ue,ae,ce,J,ne,h,ie,te,de,O,st);let Qt=A.current;F&&v&&Qt!==void 0&&Ie.has(al(Qt.range))&&wi(lr,o,i,a,s,c,Ae,u,h,Se,A,et,L,C,ye,F,R)};yt&&(mr(qe),Ce!==null&&(Ce.save(),Ce.scale(le,le),Ce.textBaseline="middle",mr(Ce),Ce.restore()),Ie.hasHeader()&&(Uu(rt,Ae,o,M,Se,s,c,a,Ie),Rt())),qe.restore(),rt.restore();return}if((Ne!==!0||l!==(me==null?void 0:me.cellXOffset)||s!==(me==null?void 0:me.translateX)||zt!==(me==null?void 0:me.mustDrawFocusOnHeader)||kt!==(me==null?void 0:me.mustDrawHighlightRingsOnHeader))&&Rt(),Ne===!0){Zt(ft!==void 0&&me!==void 0);let{regions:Ee}=Ku(qe,ft,ft===We?me.aBufferScroll:me.bBufferScroll,ft===We?me.bBufferScroll:me.aBufferScroll,me,l,a,s,c,C,o,i,R,Se,le,u,Ae,k,Qe);St=Ee}else Ne!==!1&&(Zt(me!==void 0),St=Yu(me,l,a,s,c,o,i,Se,Ae,Ne));$u(qe,Ae,o,i,C,R,I,et,h);let jt=Kl(qe,o,i,l,a,s,c,u,p,S,M,k,C,R,_,h),wt=v?wi(qe,o,i,a,s,c,Ae,u,h,Se,A,et,L,C,ye,F,R):void 0;if(qe.fillStyle=h.bgCell,St.length>0){qe.beginPath();for(let Ee of St)qe.rect(Ee.x,Ee.y,Ee.width,Ee.height);qe.clip(),qe.fill(),qe.beginPath()}else qe.fillRect(0,0,o,i);let pr=Tl(qe,Ae,u,i,Se,s,c,a,R,et,L,x,w,y,T,v,C,ye,St,Ie,A,b,_,ee,ue,ae,ce,J,ne,h,ie,te,de,O,st);Bu(qe,Ae,u,o,i,Se,s,c,a,R,et,w,A.rows,y,C,ye,St,Ie,h),Vu(qe,Ae,a,s,c,o,i,St,Se,et,w,I,C,R,h),Vl(qe,Ae,a,s,c,o,i,St,pr,M,Se,et,w,I,C,R,h),jt==null||jt(),wt==null||wt(),E&&vt!=="none"&&Dr(Ae,0,s,0,Se,(Ee,yt)=>Ee.sourceIndex===Z?(Yl(rt,yt+Ee.width,0,Se+1,fr(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),vt==="full"&&Yl(qe,yt+Ee.width,Se,i,fr(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),Ce!==null&&(Ce.fillStyle=h.bgCell,Ce.fillRect(0,0,o,i),Ce.drawImage(qe.canvas,0,0));let Ar=Xu(Ae,i,Se,s,c,a,R,et,C,ye);ee==null||ee.setWindow({x:l,y:a,width:Ae.length,height:Ar-a},p,Array.from({length:C},(Ee,yt)=>R-1-yt));let dt=me!==void 0&&(l!==me.cellXOffset||s!==me.translateX),kr=me!==void 0&&(a!==me.cellYOffset||c!==me.translateY);V.current={cellXOffset:l,cellYOffset:a,translateX:s,translateY:c,mustDrawFocusOnHeader:zt,mustDrawHighlightRingsOnHeader:kt,lastBuffer:Qe?Xe===We?"a":"b":void 0,aBufferScroll:Xe===We?[dt,kr]:me==null?void 0:me.aBufferScroll,bBufferScroll:Xe===Ue?[dt,kr]:me==null?void 0:me.bBufferScroll},qe.restore(),rt.restore()}var Ul=Gt(yo(),1),qu=80;function Zu(e){let t=e-1;return t*t*t+1}var Ju=class{constructor(e){tt(this,"callback");tt(this,"currentHoveredItem");tt(this,"leavingItems",[]);tt(this,"lastAnimationTime");tt(this,"addToLeavingItems",e=>{this.leavingItems.some(t=>Nn(t.item,e.item))||this.leavingItems.push(e)});tt(this,"removeFromLeavingItems",e=>{let t=this.leavingItems.find(r=>Nn(r.item,e));return this.leavingItems=this.leavingItems.filter(r=>r!==t),(t==null?void 0:t.hoverAmount)??0});tt(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(e=>e.hoverAmount>0)});tt(this,"shouldStep",()=>{let e=this.leavingItems.length>0,t=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return e||t});tt(this,"getAnimatingItems",()=>this.currentHoveredItem===void 0?this.leavingItems.map(e=>({...e,hoverAmount:Zu(e.hoverAmount)})):[...this.leavingItems,this.currentHoveredItem]);tt(this,"step",e=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=e;else{let t=(e-this.lastAnimationTime)/qu;for(let n of this.leavingItems)n.hoverAmount=(0,Ul.default)(n.hoverAmount-t,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=(0,Ul.default)(this.currentHoveredItem.hoverAmount+t,0,1));let r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=e,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});tt(this,"setHovered",e=>{var t;Nn((t=this.currentHoveredItem)==null?void 0:t.item,e)||(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),e===void 0?this.currentHoveredItem=void 0:this.currentHoveredItem={item:e,hoverAmount:this.removeFromLeavingItems(e)},this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step))});this.callback=e}},Qu=class{constructor(e){tt(this,"fn");tt(this,"val");this.fn=e}get value(){return this.val??(this.val=this.fn())}};function yi(e){return new Qu(e)}const ed=yi(()=>window.navigator.userAgent.includes("Firefox")),xo=yi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Co=yi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function td(e){let t=d.useRef([]),r=d.useRef(0),n=d.useRef(e);n.current=e;let o=d.useCallback(()=>{let i=()=>window.requestAnimationFrame(l),l=()=>{let a=t.current.map(ui);t.current=[],n.current(new $n(a)),t.current.length>0?r.current++:r.current=0};window.requestAnimationFrame(r.current>600?i:l)},[]);return d.useCallback(i=>{t.current.length===0&&o();let l=or(i[0],i[1]);t.current.includes(l)||t.current.push(l)},[o])}const Xl="header",ql="group-header";var Un;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Un||(Un={}));function Zl(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}var Jl=Gt(yo(),1),rd=Gt(Sl(),1),Ql=6,nd=(e,t)=>{var r;return e.kind===pe.Custom?e.copyData:((r=t==null?void 0:t(e))==null?void 0:r.getAccessibilityString(e))??""},od=d.memo(d.forwardRef((e,t)=>{let{width:r,height:n,accessibilityHeight:o,columns:i,cellXOffset:l,cellYOffset:a,headerHeight:s,fillHandle:c=!1,groupHeaderHeight:u,rowHeight:f,rows:p,getCellContent:m,getRowThemeOverride:h,onHeaderMenuClick:v,onHeaderIndicatorClick:S,enableGroups:M,isFilling:y,onCanvasFocused:k,onCanvasBlur:I,isFocused:O,selection:E,freezeColumns:A,onContextMenu:F,freezeTrailingRows:C,fixedShadowX:R=!0,fixedShadowY:L=!0,drawFocusRing:x,onMouseDown:w,onMouseUp:T,onMouseMoveRaw:P,onMouseMove:b,onItemHovered:J,dragAndDropState:_,firstColAccessible:Z,onKeyDown:ee,onKeyUp:V,highlightRegions:ae,canvasRef:ne,onDragStart:ce,onDragEnd:ue,eventTargetRef:G,isResizing:ye,resizeColumn:Q,isDragging:ie,isDraggable:te=!1,allowResize:de,disabledRows:Pe,hasAppendRow:be,getGroupDetails:De,theme:Ie,prelightCells:st,headerIcons:vt,verticalBorder:Qe,drawCell:le,drawHeader:Ne,onCellFocused:ze,onDragOverCell:Ke,onDrop:Se,onDragLeave:Ye,imageWindowLoader:We,smoothScrollX:Ue=!1,smoothScrollY:me=!1,experimental:Ce,getCellRenderer:rt,resizeIndicator:qe="full"}=e,Xe=e.translateX??0,ft=e.translateY??0,et=Math.max(A,Math.min(i.length-1,l)),Ae=d.useRef(null),St=d.useRef((Ce==null?void 0:Ce.eventTarget)??window),zt=St.current,kt=We,Rt=d.useRef(),[jt,wt]=d.useState(!1),pr=d.useRef([]),Ar=d.useRef(),[dt,kr]=d.useState(),[ir,Ee]=d.useState(),yt=d.useRef(null),[mr,lr]=d.useState(),[Qt,Ve]=d.useState(!1),xt=d.useRef(Qt);xt.current=Qt;let Mt=d.useMemo(()=>new Dc(vt,()=>{Cn.current=void 0,Qr.current()}),[vt]),Nt=M?u+s:s,Pt=d.useRef(-1),$t=((Ce==null?void 0:Ce.enableFirefoxRescaling)??!1)&&ed.value,Lr=((Ce==null?void 0:Ce.enableSafariRescaling)??!1)&&xo.value;d.useLayoutEffect(()=>{window.devicePixelRatio===1||!$t&&!Lr||(Pt.current!==-1&&wt(!0),window.clearTimeout(Pt.current),Pt.current=window.setTimeout(()=>{wt(!1),Pt.current=-1},200))},[a,et,Xe,ft,$t,Lr]);let Et=$s(i,A),Ct=R?vn(Et,_):0,Tt=d.useCallback((j,re,xe)=>{let fe=j.getBoundingClientRect();if(re>=Et.length||xe>=p)return;let z=fe.width/r,se=ai(re,xe,r,n,u,Nt,et,a,Xe,ft,p,A,C,Et,f);return z!==1&&(se.x*=z,se.y*=z,se.width*=z,se.height*=z),se.x+=fe.x,se.y+=fe.y,se},[r,n,u,Nt,et,a,Xe,ft,p,A,C,Et,f]),At=d.useCallback((j,re,xe,fe)=>{let z=j.getBoundingClientRect(),se=z.width/r,ve=(re-z.left)/se,_e=(xe-z.top)/se,Re=li(Et,et,r,void 0,Xe),ct=0,he=0;fe instanceof MouseEvent&&(ct=fe.button,he=fe.buttons);let je=Gs(ve,Re,Xe),Ge=Us(_e,n,M,s,u,p,f,a,ft,C),it=(fe==null?void 0:fe.shiftKey)===!0,Ot=(fe==null?void 0:fe.ctrlKey)===!0,Ut=(fe==null?void 0:fe.metaKey)===!0,lt=fe!==void 0&&!(fe instanceof MouseEvent)||(fe==null?void 0:fe.pointerType)==="touch",pt=[ve<0?-1:r<ve?1:0,_e<Nt?-1:n<_e?1:0],mt;if(je===-1||_e<0||ve<0||Ge===void 0||ve>r||_e>n){let He=ve>r?1:ve<0?-1:0,at=_e>n?1:_e<0?-1:0,_t=He*2,an=at*2;He===0&&(_t=je===-1?Un.EndPadding:Un.Center),at===0&&(an=Ge===void 0?Un.EndPadding:Un.Center);let cr=!1;if(je===-1&&Ge===-1){let Dt=Tt(j,Et.length-1,-1);Zt(Dt!==void 0),cr=re<Dt.x+Dt.width+5}let Ht=ve>r&&ve<r+oi()||_e>n&&_e<n+oi();mt={kind:"out-of-bounds",location:[je===-1?ve<0?0:Et.length-1:je,Ge??p-1],region:[_t,an],shiftKey:it,ctrlKey:Ot,metaKey:Ut,isEdge:cr,isTouch:lt,button:ct,buttons:he,scrollEdge:pt,isMaybeScrollbar:Ht}}else if(Ge<=-1){let He=Tt(j,je,Ge);Zt(He!==void 0);let at=He!==void 0&&He.x+He.width-re<=5,_t=je-1;re-He.x<=5&&_t>=0?(at=!0,He=Tt(j,_t,Ge),Zt(He!==void 0),mt={kind:M&&Ge===-2?ql:Xl,location:[_t,Ge],bounds:He,group:Et[_t].group??"",isEdge:at,shiftKey:it,ctrlKey:Ot,metaKey:Ut,isTouch:lt,localEventX:re-He.x,localEventY:xe-He.y,button:ct,buttons:he,scrollEdge:pt}):mt={kind:M&&Ge===-2?ql:Xl,group:Et[je].group??"",location:[je,Ge],bounds:He,isEdge:at,shiftKey:it,ctrlKey:Ot,metaKey:Ut,isTouch:lt,localEventX:re-He.x,localEventY:xe-He.y,button:ct,buttons:he,scrollEdge:pt}}else{let He=Tt(j,je,Ge);Zt(He!==void 0);let at=He!==void 0&&He.x+He.width-re<5,_t=!1;if(c&&E.current!==void 0){let an=al(E.current.range),cr=Tt(j,an[0],an[1]);if(cr!==void 0){let Ht=cr.x+cr.width-2,Dt=cr.y+cr.height-2;_t=Math.abs(Ht-re)<Ql&&Math.abs(Dt-xe)<Ql}}mt={kind:"cell",location:[je,Ge],bounds:He,isEdge:at,shiftKey:it,ctrlKey:Ot,isFillHandle:_t,metaKey:Ut,isTouch:lt,localEventX:re-He.x,localEventY:xe-He.y,button:ct,buttons:he,scrollEdge:pt}}return mt},[r,Et,et,Xe,n,M,s,u,p,f,a,ft,C,Tt,c,E,Nt]),[Mr]=dt??[],Eo=d.useRef(()=>{}),Fr=d.useRef(dt);Fr.current=dt;let[Rr,Er]=d.useMemo(()=>{let j=document.createElement("canvas"),re=document.createElement("canvas");return j.style.display="none",j.style.opacity="0",j.style.position="fixed",re.style.display="none",re.style.opacity="0",re.style.position="fixed",[j.getContext("2d",{alpha:!1}),re.getContext("2d",{alpha:!1})]},[]);d.useLayoutEffect(()=>{if(!(Rr===null||Er===null))return document.documentElement.append(Rr.canvas),document.documentElement.append(Er.canvas),()=>{Rr.canvas.remove(),Er.canvas.remove()}},[Rr,Er]);let vr=d.useMemo(()=>new nc,[]),Io=$t&&jt?1:Lr&&jt?2:5,To=(Ce==null?void 0:Ce.disableMinimumCellWidth)===!0?1:10,Cn=d.useRef(),Sn=d.useRef(null),kn=d.useRef(null),Jr=d.useCallback(()=>{var ve;let j=Ae.current,re=yt.current;if(j===null||re===null||(Sn.current===null&&(Sn.current=j.getContext("2d",{alpha:!1}),j.width=0,j.height=0),kn.current===null&&(kn.current=re.getContext("2d",{alpha:!1}),re.width=0,re.height=0),Sn.current===null||kn.current===null||Rr===null||Er===null))return;let xe=!1,fe=_e=>{xe=!0,lr(_e)},z=Cn.current,se={headerCanvasCtx:kn.current,canvasCtx:Sn.current,bufferACtx:Rr,bufferBCtx:Er,width:r,height:n,cellXOffset:et,cellYOffset:a,translateX:Math.round(Xe),translateY:Math.round(ft),mappedColumns:Et,enableGroups:M,freezeColumns:A,dragAndDropState:_,theme:Ie,headerHeight:s,groupHeaderHeight:u,disabledRows:Pe??nt.empty(),rowHeight:f,verticalBorder:Qe,isResizing:ye,resizeCol:Q,isFocused:O,selection:E,fillHandle:c,drawCellCallback:le,hasAppendRow:be,overrideCursor:fe,maxScaleFactor:Io,freezeTrailingRows:C,rows:p,drawFocus:x,getCellContent:m,getGroupDetails:De??(_e=>({name:_e})),getRowThemeOverride:h,drawHeaderCallback:Ne,prelightCells:st,highlightRegions:ae,imageLoader:kt,lastBlitData:Ar,damage:Rt.current,hoverValues:pr.current,hoverInfo:Fr.current,spriteManager:Mt,scrolling:jt,hyperWrapping:(Ce==null?void 0:Ce.hyperWrapping)??!1,touchMode:Qt,enqueue:Eo.current,renderStateProvider:vr,renderStrategy:(Ce==null?void 0:Ce.renderStrategy)??(xo.value?"double-buffer":"single-buffer"),getCellRenderer:rt,minimumCellWidth:To,resizeIndicator:qe};se.damage===void 0?(Cn.current=se,Gl(se,z)):Gl(se,void 0),!xe&&(se.damage===void 0||se.damage.has((ve=Fr==null?void 0:Fr.current)==null?void 0:ve[0]))&&lr(void 0)},[Rr,Er,r,n,et,a,Xe,ft,Et,M,A,_,Ie,s,u,Pe,f,Qe,ye,be,Q,O,E,c,C,p,x,Io,m,De,h,le,Ne,st,ae,kt,Mt,jt,Ce==null?void 0:Ce.hyperWrapping,Ce==null?void 0:Ce.renderStrategy,Qt,vr,rt,To,qe]),Qr=d.useRef(Jr);d.useLayoutEffect(()=>{Jr(),Qr.current=Jr},[Jr]),d.useLayoutEffect(()=>{(async()=>{var j;((j=document==null?void 0:document.fonts)==null?void 0:j.ready)!==void 0&&(await document.fonts.ready,Cn.current=void 0,Qr.current())})()},[]);let jr=d.useCallback(j=>{Rt.current=j,Qr.current(),Rt.current=void 0},[]);Eo.current=td(jr);let Oo=d.useCallback(j=>{jr(new $n(j.map(re=>re.cell)))},[jr]);kt.setCallback(jr);let[Mi,Po]=d.useState(!1),[Mn,_r]=Mr??[],Ri=Mn!==void 0&&_r===-1,qn=Mn!==void 0&&_r===-2,Ho=!1,Zn=!1,en=mr;if(en===void 0&&Mn!==void 0&&_r!==void 0&&_r>-1&&_r<p){let j=m([Mn,_r],!0);Ho=j.kind===$r.NewRow||j.kind===$r.Marker&&j.markerKind!=="number",Zn=j.kind===pe.Boolean&&Ki(j),en=j.cursor}let Jn=ie?"grabbing":(ir??!1)||ye?"col-resize":Mi||y?"crosshair":en===void 0?Ri||Ho||Zn||qn?"pointer":"default":en,gt=d.useMemo(()=>({contain:"strict",display:"block",cursor:Jn}),[Jn]),Vt=d.useRef("default"),Do=G==null?void 0:G.current;Do!=null&&Vt.current!==gt.cursor&&(Do.style.cursor=Vt.current=gt.cursor);let Ir=d.useCallback((j,re,xe,fe)=>{if(De===void 0)return;let z=De(j);if(z.actions!==void 0){let se=Pl(re,z.actions);for(let[ve,_e]of se.entries())if(qr(_e,xe+re.x,fe+_e.y))return z.actions[ve]}},[De]),Tr=d.useCallback((j,re,xe,fe)=>{let z=Et[re];if(!ie&&!ye&&!(ir??!1)){let se=Tt(j,re,-1);Zt(se!==void 0);let ve=Hl(void 0,z,se.x,se.y,se.width,se.height,Ie,ni(z.title)==="rtl");if(z.hasMenu===!0&&ve.menuBounds!==void 0&&qr(ve.menuBounds,xe,fe))return{area:"menu",bounds:ve.menuBounds};if(z.indicatorIcon!==void 0&&ve.indicatorIconBounds!==void 0&&qr(ve.indicatorIconBounds,xe,fe))return{area:"indicator",bounds:ve.indicatorIconBounds}}},[Et,Tt,ir,ie,ye,Ie]),Rn=d.useRef(0),Nr=d.useRef(),En=d.useRef(!1),tn=d.useCallback(j=>{let re=Ae.current,xe=G==null?void 0:G.current;if(re===null||j.target!==re&&j.target!==xe)return;En.current=!0;let fe,z;if(j instanceof MouseEvent?(fe=j.clientX,z=j.clientY):(fe=j.touches[0].clientX,z=j.touches[0].clientY),j.target===xe&&xe!==null){let ve=xe.getBoundingClientRect();if(fe>ve.right||z>ve.bottom)return}let se=At(re,fe,z,j);Nr.current=se.location,se.isTouch&&(Rn.current=Date.now()),xt.current!==se.isTouch&&Ve(se.isTouch),!(se.kind==="header"&&Tr(re,se.location[0],fe,z)!==void 0)&&(se.kind==="group-header"&&Ir(se.group,se.bounds,se.localEventX,se.localEventY)!==void 0||(w==null||w(se),!se.isTouch&&te!==!0&&te!==se.kind&&se.button<3&&se.button!==1&&j.preventDefault()))},[G,te,At,Ir,Tr,w]);Ft("touchstart",tn,zt,!1),Ft("mousedown",tn,zt,!1);let Or=d.useRef(0),rn=d.useCallback(j=>{var je,Ge;let re=Or.current;Or.current=Date.now();let xe=Ae.current;if(En.current=!1,T===void 0||xe===null)return;let fe=G==null?void 0:G.current,z=j.target!==xe&&j.target!==fe,se,ve,_e=!0;if(j instanceof MouseEvent){if(se=j.clientX,ve=j.clientY,_e=j.button<3,j.pointerType==="touch")return}else se=j.changedTouches[0].clientX,ve=j.changedTouches[0].clientY;let Re=At(xe,se,ve,j);Re.isTouch&&Rn.current!==0&&Date.now()-Rn.current>500&&(Re={...Re,isLongTouch:!0}),re!==0&&Date.now()-re<(Re.isTouch?1e3:500)&&(Re={...Re,isDoubleClick:!0}),xt.current!==Re.isTouch&&Ve(Re.isTouch),!z&&j.cancelable&&_e&&j.preventDefault();let[ct]=Re.location,he=Tr(xe,ct,se,ve);if(Re.kind==="header"&&he!==void 0){(Re.button!==0||((je=Nr.current)==null?void 0:je[0])!==ct||((Ge=Nr.current)==null?void 0:Ge[1])!==-1)&&T(Re,!0);return}else if(Re.kind==="group-header"){let it=Ir(Re.group,Re.bounds,Re.localEventX,Re.localEventY);if(it!==void 0){Re.button===0&&it.onClick(Re);return}}T(Re,z)},[T,G,At,Tr,Ir]);Ft("mouseup",rn,zt,!1),Ft("touchend",rn,zt,!1),Ft("click",d.useCallback(j=>{var ct,he;let re=Ae.current;if(re===null)return;let xe=G==null?void 0:G.current,fe=j.target!==re&&j.target!==xe,z,se,ve=!0;j instanceof MouseEvent?(z=j.clientX,se=j.clientY,ve=j.button<3):(z=j.changedTouches[0].clientX,se=j.changedTouches[0].clientY);let _e=At(re,z,se,j);xt.current!==_e.isTouch&&Ve(_e.isTouch),!fe&&j.cancelable&&ve&&j.preventDefault();let[Re]=_e.location;if(_e.kind==="header"){let je=Tr(re,Re,z,se);je!==void 0&&_e.button===0&&((ct=Nr.current)==null?void 0:ct[0])===Re&&((he=Nr.current)==null?void 0:he[1])===-1&&(je.area==="menu"?v==null||v(Re,je.bounds):je.area==="indicator"&&(S==null||S(Re,je.bounds)))}else if(_e.kind==="group-header"){let je=Ir(_e.group,_e.bounds,_e.localEventX,_e.localEventY);je!==void 0&&_e.button===0&&je.onClick(_e)}},[G,At,Tr,v,S,Ir]),zt,!1),Ft("contextmenu",d.useCallback(j=>{let re=Ae.current,xe=G==null?void 0:G.current;re===null||j.target!==re&&j.target!==xe||F===void 0||F(At(re,j.clientX,j.clientY,j),()=>{j.cancelable&&j.preventDefault()})},[G,At,F]),(G==null?void 0:G.current)??null,!1);let zo=d.useCallback(j=>{Rt.current=new $n(j.map(re=>re.item)),pr.current=j,Qr.current(),Rt.current=void 0},[]),Qn=d.useMemo(()=>new Ju(zo),[zo]),Te=d.useRef(Qn);Te.current=Qn,d.useLayoutEffect(()=>{let j=Te.current;if(Mr===void 0||Mr[1]<0){j.setHovered(Mr);return}let re=m(Mr,!0),xe=rt(re),fe=xe===void 0&&re.kind===pe.Custom||(xe==null?void 0:xe.needsHover)!==void 0&&(typeof xe.needsHover=="boolean"?xe.needsHover:xe.needsHover(re));j.setHovered(fe?Mr:void 0)},[m,rt,Mr]);let eo=d.useRef();Ft("mousemove",d.useCallback(j=>{var _e;let re=Ae.current;if(re===null)return;let xe=G==null?void 0:G.current,fe=j.target!==re&&j.target!==xe,z=At(re,j.clientX,j.clientY,j);if(z.kind!=="out-of-bounds"&&fe&&!En.current&&!z.isTouch)return;let se=(Re,ct)=>{kr(he=>he===Re||(he==null?void 0:he[0][0])===(Re==null?void 0:Re[0][0])&&(he==null?void 0:he[0][1])===(Re==null?void 0:Re[0][1])&&((he==null?void 0:he[1][0])===(Re==null?void 0:Re[1][0])&&(he==null?void 0:he[1][1])===(Re==null?void 0:Re[1][1])||!ct)?he:Re)};if(!Zl(z,eo.current))lr(void 0),J==null||J(z),se(z.kind==="out-of-bounds"?void 0:[z.location,[z.localEventX,z.localEventY]],!0),eo.current=z;else if(z.kind==="cell"||z.kind==="header"||z.kind==="group-header"){let Re=!1,ct=!0;if(z.kind==="cell"){let je=m(z.location);ct=((_e=rt(je))==null?void 0:_e.needsHoverPosition)??je.kind===pe.Custom,Re=ct}else Re=!0;let he=[z.location,[z.localEventX,z.localEventY]];se(he,ct),Fr.current=he,Re&&jr(new $n([z.location]))}let ve=z.location[0]>=(Z?0:1);Ee(z.kind==="header"&&z.isEdge&&ve&&de===!0),Po(z.kind==="cell"&&z.isFillHandle),P==null||P(j),b(z)},[G,At,Z,de,P,b,J,m,rt,jr]),zt,!0);let Ei=d.useCallback(j=>{let re=Ae.current;if(re===null)return;let xe,fe;E.current!==void 0&&(xe=Tt(re,E.current.cell[0],E.current.cell[1]),fe=E.current.cell),ee==null||ee({bounds:xe,stopPropagation:()=>j.stopPropagation(),preventDefault:()=>j.preventDefault(),cancel:()=>{},ctrlKey:j.ctrlKey,metaKey:j.metaKey,shiftKey:j.shiftKey,altKey:j.altKey,key:j.key,keyCode:j.keyCode,rawEvent:j,location:fe})},[ee,E,Tt]),ar=d.useCallback(j=>{let re=Ae.current;if(re===null)return;let xe,fe;E.current!==void 0&&(xe=Tt(re,E.current.cell[0],E.current.cell[1]),fe=E.current.cell),V==null||V({bounds:xe,stopPropagation:()=>j.stopPropagation(),preventDefault:()=>j.preventDefault(),cancel:()=>{},ctrlKey:j.ctrlKey,metaKey:j.metaKey,shiftKey:j.shiftKey,altKey:j.altKey,key:j.key,keyCode:j.keyCode,rawEvent:j,location:fe})},[V,E,Tt]),wr=d.useCallback(j=>{if(Ae.current=j,ne!==void 0&&(ne.current=j),Ce==null?void 0:Ce.eventTarget)St.current=Ce.eventTarget;else if(j===null)St.current=window;else{let re=j.getRootNode();re===document&&(St.current=window),St.current=re}},[ne,Ce==null?void 0:Ce.eventTarget]);Ft("dragstart",d.useCallback(j=>{let re=Ae.current;if(re===null||te===!1||ye){j.preventDefault();return}let xe,fe,z=At(re,j.clientX,j.clientY);if(te!==!0&&z.kind!==te){j.preventDefault();return}let se=(je,Ge)=>{xe=je,fe=Ge},ve,_e,Re,ct=(je,Ge,it)=>{ve=je,_e=Ge,Re=it},he=!1;if(ce==null||ce({...z,setData:se,setDragImage:ct,preventDefault:()=>he=!0,defaultPrevented:()=>he}),!he&&xe!==void 0&&fe!==void 0&&j.dataTransfer!==null)if(j.dataTransfer.setData(xe,fe),j.dataTransfer.effectAllowed="copyLink",ve!==void 0&&_e!==void 0&&Re!==void 0)j.dataTransfer.setDragImage(ve,_e,Re);else{let[je,Ge]=z.location;if(Ge!==void 0){let it=document.createElement("canvas"),Ot=Tt(re,je,Ge);Zt(Ot!==void 0);let Ut=Math.ceil(window.devicePixelRatio??1);it.width=Ot.width*Ut,it.height=Ot.height*Ut;let lt=it.getContext("2d");lt!==null&&(lt.scale(Ut,Ut),lt.textBaseline="middle",Ge===-1?(lt.font=Ie.headerFontFull,lt.fillStyle=Ie.bgHeader,lt.fillRect(0,0,it.width,it.height),zl(lt,0,0,Ot.width,Ot.height,Et[je],!1,Ie,!1,void 0,void 0,!1,0,Mt,Ne,!1)):(lt.font=Ie.baseFontFull,lt.fillStyle=Ie.bgCell,lt.fillRect(0,0,it.width,it.height),Ol(lt,m([je,Ge]),0,Ge,!1,!1,0,0,Ot.width,Ot.height,!1,Ie,Ie.bgCell,kt,Mt,1,void 0,!1,0,void 0,void 0,void 0,vr,rt,()=>{}))),it.style.left="-100%",it.style.position="absolute",it.style.width=`${Ot.width}px`,it.style.height=`${Ot.height}px`,document.body.append(it),j.dataTransfer.setDragImage(it,Ot.width/2,Ot.height/2),window.setTimeout(()=>{it.remove()},0)}}else j.preventDefault()},[te,ye,At,ce,Tt,Ie,Et,Mt,Ne,m,kt,vr,rt]),(G==null?void 0:G.current)??null,!1,!1);let nn=d.useRef();Ft("dragover",d.useCallback(j=>{let re=Ae.current;if(Se!==void 0&&j.preventDefault(),re===null||Ke===void 0)return;let[xe,fe]=At(re,j.clientX,j.clientY).location,z=xe-(Z?0:1),[se,ve]=nn.current??[];(se!==z||ve!==fe)&&(nn.current=[z,fe],Ke([z,fe],j.dataTransfer))},[Z,At,Ke,Se]),(G==null?void 0:G.current)??null,!1,!1),Ft("dragend",d.useCallback(()=>{nn.current=void 0,ue==null||ue()},[ue]),(G==null?void 0:G.current)??null,!1,!1),Ft("drop",d.useCallback(j=>{let re=Ae.current;if(re===null||Se===void 0)return;j.preventDefault();let[xe,fe]=At(re,j.clientX,j.clientY).location;Se([xe-(Z?0:1),fe],j.dataTransfer)},[Z,At,Se]),(G==null?void 0:G.current)??null,!1,!1),Ft("dragleave",d.useCallback(()=>{Ye==null||Ye()},[Ye]),(G==null?void 0:G.current)??null,!1,!1);let to=d.useRef(E);to.current=E;let on=d.useRef(null),ro=d.useCallback(j=>{var re;Ae.current===null||!Ae.current.contains(document.activeElement)||(j===null&&to.current.current!==void 0?(re=ne==null?void 0:ne.current)==null||re.focus({preventScroll:!0}):j!==null&&j.focus({preventScroll:!0}),on.current=j)},[ne]);d.useImperativeHandle(t,()=>({focus:()=>{var re;let j=on.current;j===null||!document.contains(j)?(re=ne==null?void 0:ne.current)==null||re.focus({preventScroll:!0}):j.focus({preventScroll:!0})},getBounds:(j,re)=>{if(!(ne===void 0||ne.current===null))return Tt(ne.current,j??0,re??-1)},damage:Oo}),[ne,Oo,Tt]);let no=d.useRef(),yr=Es(()=>{var _e,Re,ct;if(r<50||(Ce==null?void 0:Ce.disableAccessibilityTree)===!0)return null;let j=li(Et,et,r,_,Xe),re=Z?0:-1;!Z&&((_e=j[0])==null?void 0:_e.sourceIndex)===0&&(j=j.slice(1));let[xe,fe]=((Re=E.current)==null?void 0:Re.cell)??[],z=(ct=E.current)==null?void 0:ct.range,se=j.map(he=>he.sourceIndex),ve=(0,rd.default)(a,Math.min(p,a+o));return xe!==void 0&&fe!==void 0&&!(se.includes(xe)&&ve.includes(fe))&&ro(null),d.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":p+1,"aria-multiselectable":"true","aria-colcount":Et.length+re},d.createElement("thead",{role:"rowgroup"},d.createElement("tr",{role:"row","aria-rowindex":1},j.map(he=>d.createElement("th",{role:"columnheader","aria-selected":E.columns.hasIndex(he.sourceIndex),"aria-colindex":he.sourceIndex+1+re,tabIndex:-1,onFocus:je=>{if(je.target!==on.current)return ze==null?void 0:ze([he.sourceIndex,-1])},key:he.sourceIndex},he.title)))),d.createElement("tbody",{role:"rowgroup"},ve.map(he=>d.createElement("tr",{role:"row","aria-selected":E.rows.hasIndex(he),key:he,"aria-rowindex":he+2},j.map(je=>{let Ge=je.sourceIndex,it=or(Ge,he),Ot=xe===Ge&&fe===he,Ut=z!==void 0&&Ge>=z.x&&Ge<z.x+z.width&&he>=z.y&&he<z.y+z.height,lt=`glide-cell-${Ge}-${he}`,pt=[Ge,he],mt=m(pt,!0);return d.createElement("td",{key:it,role:"gridcell","aria-colindex":Ge+1+re,"aria-selected":Ut,"aria-readonly":Fn(mt)||!po(mt),id:lt,"data-testid":lt,onClick:()=>{let He=ne==null?void 0:ne.current;if(He!=null)return ee==null?void 0:ee({bounds:Tt(He,Ge,he),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:pt})},onFocusCapture:He=>{var at,_t;if(!(He.target===on.current||((at=no.current)==null?void 0:at[0])===Ge&&((_t=no.current)==null?void 0:_t[1])===he))return no.current=pt,ze==null?void 0:ze(pt)},ref:Ot?ro:void 0,tabIndex:-1},nd(mt,rt))})))))},[r,Et,et,_,Xe,p,a,o,E,ro,m,ne,ee,Tt,ze],200),sr=A===0||!R?0:et>A?1:(0,Jl.default)(-Xe/100,0,1),er=-a*32+ft,B=L?(0,Jl.default)(-er/100,0,1):0,bt=d.useMemo(()=>{if(!sr&&!B)return null;let j={position:"absolute",top:0,left:Ct,width:r-Ct,height:n,opacity:sr,pointerEvents:"none",transition:Ue?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},re={position:"absolute",top:Nt,left:0,width:r,height:n,opacity:B,pointerEvents:"none",transition:me?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return d.createElement(d.Fragment,null,sr>0&&d.createElement("div",{id:"shadow-x",style:j}),B>0&&d.createElement("div",{id:"shadow-y",style:re}))},[sr,B,Ct,r,Ue,Nt,n,me]),ln=d.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return d.createElement(d.Fragment,null,d.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Ei,onKeyUp:ar,onFocus:k,onBlur:I,ref:wr,style:gt},yr),d.createElement("canvas",{ref:yt,style:ln}),bt)})),id=Gt(yo(),1);function Xn(e,t,r,n){return(0,id.default)(Math.round(t-(e.growOffset??0)),Math.ceil(r),Math.floor(n))}var ld=e=>{let[t,r]=d.useState(),[n,o]=d.useState(),[i,l]=d.useState(),[a,s]=d.useState(),[c,u]=d.useState(!1),[f,p]=d.useState(),[m,h]=d.useState(),[v,S]=d.useState(),[M,y]=d.useState(!1),[k,I]=d.useState(),{onHeaderMenuClick:O,onHeaderIndicatorClick:E,getCellContent:A,onColumnMoved:F,onColumnResize:C,onColumnResizeStart:R,onColumnResizeEnd:L,gridRef:x,maxColumnWidth:w,minColumnWidth:T,onRowMoved:P,lockColumns:b,onColumnProposeMove:J,onMouseDown:_,onMouseUp:Z,onItemHovered:ee,onDragStart:V,canvasRef:ae}=e,ne=(C??L??R)!==void 0,{columns:ce,selection:ue}=e,G=ue.columns,ye=d.useCallback(le=>{let[Ne,ze]=le.location;i!==void 0&&a!==Ne&&Ne>=b?(u(!0),s(Ne)):m!==void 0&&ze!==void 0?(y(!0),S(Math.max(0,ze))):n===void 0&&!c&&!M&&(ee==null||ee(le))},[i,m,a,ee,b,n,c,M]),Q=F!==void 0,ie=d.useCallback(le=>{var Ne;if(le.button===0){let[ze,Ke]=le.location;if(le.kind==="out-of-bounds"&&le.isEdge&&ne){let Se=(Ne=x==null?void 0:x.current)==null?void 0:Ne.getBounds(ce.length-1,-1);Se!==void 0&&(r(Se.x),o(ce.length-1))}else if(le.kind==="header"&&ze>=b){let Se=ae==null?void 0:ae.current;if(le.isEdge&&ne&&Se){r(le.bounds.x),o(ze);let Ye=Se.getBoundingClientRect().width/Se.offsetWidth,We=le.bounds.width/Ye;R==null||R(ce[ze],We,ze,We+(ce[ze].growOffset??0))}else le.kind==="header"&&Q&&(p(le.bounds.x),l(ze))}else le.kind==="cell"&&b>0&&ze===0&&Ke!==void 0&&P!==void 0&&(I(le.bounds.y),h(Ke))}_==null||_(le)},[_,ne,b,P,x,ce,Q,R,ae]),te=d.useCallback((le,Ne)=>{c||M||(O==null||O(le,Ne))},[c,M,O]),de=d.useCallback((le,Ne)=>{c||M||(E==null||E(le,Ne))},[c,M,E]),Pe=d.useRef(-1),be=d.useCallback(()=>{Pe.current=-1,h(void 0),S(void 0),I(void 0),y(!1),l(void 0),s(void 0),p(void 0),u(!1),o(void 0),r(void 0)},[]),De=d.useCallback((le,Ne)=>{if(le.button===0){if(n!==void 0){if((G==null?void 0:G.hasIndex(n))===!0)for(let Ke of G){if(Ke===n)continue;let Se=ce[Ke],Ye=Xn(Se,Pe.current,T,w);C==null||C(Se,Ye,Ke,Ye+(Se.growOffset??0))}let ze=Xn(ce[n],Pe.current,T,w);if(L==null||L(ce[n],ze,n,ze+(ce[n].growOffset??0)),G.hasIndex(n))for(let Ke of G){if(Ke===n)continue;let Se=ce[Ke],Ye=Xn(Se,Pe.current,T,w);L==null||L(Se,Ye,Ke,Ye+(Se.growOffset??0))}}be(),i!==void 0&&a!==void 0&&(F==null||F(i,a)),m!==void 0&&v!==void 0&&(P==null||P(m,v))}Z==null||Z(le,Ne)},[Z,n,i,a,m,v,G,L,ce,T,w,C,F,P,be]),Ie=d.useMemo(()=>{if(!(i===void 0||a===void 0)&&i!==a&&(J==null?void 0:J(i,a))!==!1)return{src:i,dest:a}},[i,a,J]),st=d.useCallback(le=>{let Ne=ae==null?void 0:ae.current;if(i!==void 0&&f!==void 0)Math.abs(le.clientX-f)>20&&u(!0);else if(m!==void 0&&k!==void 0)Math.abs(le.clientY-k)>20&&y(!0);else if(n!==void 0&&t!==void 0&&Ne){let ze=Ne.getBoundingClientRect().width/Ne.offsetWidth,Ke=(le.clientX-t)/ze,Se=ce[n],Ye=Xn(Se,Ke,T,w);if(C==null||C(Se,Ye,n,Ye+(Se.growOffset??0)),Pe.current=Ke,(G==null?void 0:G.first())===n)for(let We of G){if(We===n)continue;let Ue=ce[We],me=Xn(Ue,Pe.current,T,w);C==null||C(Ue,me,We,me+(Ue.growOffset??0))}}},[i,f,m,k,n,t,ce,T,w,C,G,ae]),vt=d.useCallback((le,Ne)=>{if(m===void 0||v===void 0)return A(le,Ne);let[ze,Ke]=le;return Ke===v?Ke=m:(Ke>v&&--Ke,Ke>=m&&(Ke+=1)),A([ze,Ke],Ne)},[m,v,A]),Qe=d.useCallback(le=>{V==null||V(le),le.defaultPrevented()||be()},[be,V]);return d.createElement(od,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:n,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:vt,isResizing:n!==void 0,onHeaderMenuClick:te,onHeaderIndicatorClick:de,isDragging:c,onItemHovered:ye,onDragStart:Qe,onMouseDown:ie,allowResize:ne,onMouseUp:De,dragAndDropState:Ie,onMouseMoveRaw:st,ref:x})};function ad(e){let t=(0,d.useRef)(null),[r,n]=(0,d.useState)({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return(0,d.useLayoutEffect)(()=>{let o=new window.ResizeObserver(i=>{for(let l of i){let{width:a,height:s}=l&&l.contentRect||{};n(c=>c.width===a&&c.height===s?c:{width:a,height:s})}});return t.current&&o.observe(t.current,void 0),()=>{o.disconnect()}},[t.current]),{ref:t,...r}}var sd=(e,t,r)=>{let n=(0,d.useRef)(null),o=(0,d.useRef)(null),i=(0,d.useRef)(null),l=(0,d.useRef)(0),a=(0,d.useRef)(t);a.current=t;let s=r.current;(0,d.useEffect)(()=>{let c=()=>{var p,m;if(o.current===!1&&s!==null){let h=[s.scrollLeft,s.scrollTop];if(((p=i.current)==null?void 0:p[0])===h[0]&&((m=i.current)==null?void 0:m[1])===h[1])if(l.current>10){i.current=null,o.current=null;return}else l.current++;else l.current=0,a.current(h[0],h[1]),i.current=h;n.current=window.setTimeout(c,8.333333333333334)}},u=()=>{o.current=!0,i.current=null,n.current!==null&&(window.clearTimeout(n.current),n.current=null)},f=p=>{p.touches.length===0&&(o.current=!1,l.current=0,n.current=window.setTimeout(c,8.333333333333334))};if(e&&s!==null){let p=s;return p.addEventListener("touchstart",u),p.addEventListener("touchend",f),()=>{p.removeEventListener("touchstart",u),p.removeEventListener("touchend",f),n.current!==null&&window.clearTimeout(n.current)}}},[e,s])},cd=()=>e=>e.isSafari?"scroll":"auto",ud=Jt("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[cd()]}});function dd(e){let[t,r]=d.useState(!1),n=typeof window>"u"?null:window,o=d.useRef(0);return Ft("touchstart",d.useCallback(()=>{window.clearTimeout(o.current),r(!0)},[]),n,!0,!1),Ft("touchend",d.useCallback(i=>{i.touches.length===0&&(o.current=window.setTimeout(()=>r(!1),e))},[e]),n,!0,!1),t}const hd=e=>{var ne,ce;let{children:t,clientHeight:r,scrollHeight:n,scrollWidth:o,update:i,draggable:l,className:a,preventDiagonalScrolling:s=!1,paddingBottom:c=0,paddingRight:u=0,rightElement:f,rightElementProps:p,kineticScrollPerfHack:m=!1,scrollRef:h,initialSize:v}=e,S=[],M=(p==null?void 0:p.sticky)??!1,y=(p==null?void 0:p.fill)??!1,k=d.useRef(0),I=d.useRef(0),O=d.useRef(null),E=typeof window>"u"?1:window.devicePixelRatio,A=d.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),F=d.useRef(null),C=dd(200),[R,L]=d.useState(!0),x=d.useRef(0);d.useLayoutEffect(()=>{if(!R||C||A.current.lockDirection===void 0)return;let ue=O.current;if(ue===null)return;let[G,ye]=A.current.lockDirection;G===void 0?ye!==void 0&&(ue.scrollTop=ye):ue.scrollLeft=G,A.current.lockDirection=void 0},[C,R]);let w=d.useCallback((ue,G)=>{var Qe;let ye=O.current;if(ye===null)return;G??(G=ye.scrollTop),ue??(ue=ye.scrollLeft);let Q=A.current.scrollTop,ie=A.current.scrollLeft,te=ue-ie,de=G-Q;C&&te!==0&&de!==0&&(Math.abs(te)>3||Math.abs(de)>3)&&s&&A.current.lockDirection===void 0&&(A.current.lockDirection=Math.abs(te)<Math.abs(de)?[ie,void 0]:[void 0,Q]);let Pe=A.current.lockDirection;ue=(Pe==null?void 0:Pe[0])??ue,G=(Pe==null?void 0:Pe[1])??G,A.current.scrollLeft=ue,A.current.scrollTop=G;let be=ye.clientWidth,De=ye.clientHeight,Ie=G,st=I.current-Ie,vt=ye.scrollHeight-De;if(I.current=Ie,vt>0&&(Math.abs(st)>2e3||Ie===0||Ie===vt)&&n>ye.scrollHeight+5){let le=Ie/vt;k.current=(n-De)*le-Ie}Pe!==void 0&&(window.clearTimeout(x.current),L(!1),x.current=window.setTimeout(()=>L(!0),200)),i({x:ue,y:Ie+k.current,width:be-u,height:De-c,paddingRight:((Qe=F.current)==null?void 0:Qe.clientWidth)??0})},[c,u,n,i,s,C]);sd(m&&xo.value,w,O);let T=d.useRef(w);T.current=w;let P=d.useRef(),b=d.useRef(!1);d.useLayoutEffect(()=>{b.current?w():b.current=!0},[w,c,u]);let J=d.useCallback(ue=>{O.current=ue,h!==void 0&&(h.current=ue)},[h]),_=0,Z=0;for(S.push(d.createElement("div",{key:_++,style:{width:o,height:0}}));Z<n;){let ue=Math.min(5e6,n-Z);S.push(d.createElement("div",{key:_++,style:{width:0,height:ue}})),Z+=ue}let{ref:ee,width:V,height:ae}=ad(v);return typeof window<"u"&&(((ne=P.current)==null?void 0:ne.height)!==ae||((ce=P.current)==null?void 0:ce.width)!==V)&&(window.setTimeout(()=>T.current(),0),P.current={width:V,height:ae}),(V??0)===0||(ae??0)===0?d.createElement("div",{ref:ee}):d.createElement("div",{ref:ee},d.createElement(ud,{isSafari:xo.value},d.createElement("div",{className:"dvn-underlay"},t),d.createElement("div",{ref:J,style:P.current,draggable:l,onDragStart:ue=>{l||(ue.stopPropagation(),ue.preventDefault())},className:"dvn-scroller "+(a??""),onScroll:()=>w()},d.createElement("div",{className:"dvn-scroll-inner"+(f===void 0?" dvn-hidden":"")},d.createElement("div",{className:"dvn-stack"},S),f!==void 0&&d.createElement(d.Fragment,null,!y&&d.createElement("div",{className:"dvn-spacer"}),d.createElement("div",{ref:F,style:{height:ae,maxHeight:r-Math.ceil(E%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:y?1:void 0,right:M?u??0:void 0,pointerEvents:"auto"}},f))))))};var fd=e=>{let{columns:t,rows:r,rowHeight:n,headerHeight:o,groupHeaderHeight:i,enableGroups:l,freezeColumns:a,experimental:s,nonGrowWidth:c,clientSize:u,className:f,onVisibleRegionChanged:p,scrollRef:m,preventDiagonalScrolling:h,rightElement:v,rightElementProps:S,overscrollX:M,overscrollY:y,initialSize:k,smoothScrollX:I=!1,smoothScrollY:O=!1,isDraggable:E}=e,{paddingRight:A,paddingBottom:F}=s??{},[C,R]=u,L=d.useRef(),x=d.useRef(),w=d.useRef(),T=d.useRef(),P=c+Math.max(0,M??0),b=l?o+i:o;if(typeof n=="number")b+=r*n;else for(let ee=0;ee<r;ee++)b+=n(ee);y!==void 0&&(b+=y);let J=d.useRef(),_=d.useCallback(()=>{var de,Pe;if(J.current===void 0)return;let ee={...J.current},V=0,ae=ee.x<0?-ee.x:0,ne=0,ce=0;ee.x=ee.x<0?0:ee.x;let ue=0;for(let be=0;be<a;be++)ue+=t[be].width;for(let be of t){let De=V-ue;if(ee.x>=De+be.width)V+=be.width,ce++,ne++;else if(ee.x>De)V+=be.width,I?ae+=De-ee.x:ce++,ne++;else if(ee.x+ee.width>De)V+=be.width,ne++;else break}let G=0,ye=0,Q=0;if(typeof n=="number")O?(ye=Math.floor(ee.y/n),G=ye*n-ee.y):ye=Math.ceil(ee.y/n),Q=Math.ceil(ee.height/n)+ye,G<0&&Q++;else{let be=0;for(let De=0;De<r;De++){let Ie=n(De),st=be+(O?0:Ie/2);if(ee.y>=be+Ie)be+=Ie,ye++,Q++;else if(ee.y>st)be+=Ie,O?G+=st-ee.y:ye++,Q++;else if(ee.y+ee.height>Ie/2+be)be+=Ie,Q++;else break}}let ie={x:ce,y:ye,width:ne-ce,height:Q-ye},te=L.current;(te===void 0||te.y!==ie.y||te.x!==ie.x||te.height!==ie.height||te.width!==ie.width||x.current!==ae||w.current!==G||ee.width!==((de=T.current)==null?void 0:de[0])||ee.height!==((Pe=T.current)==null?void 0:Pe[1]))&&(p==null||p({x:ce,y:ye,width:ne-ce,height:Q-ye},ee.width,ee.height,ee.paddingRight??0,ae,G),L.current=ie,x.current=ae,w.current=G,T.current=[ee.width,ee.height])},[t,n,r,p,a,I,O]),Z=d.useCallback(ee=>{J.current=ee,_()},[_]);return d.useEffect(()=>{_()},[_]),d.createElement(hd,{scrollRef:m,className:f,kineticScrollPerfHack:s==null?void 0:s.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:E===!0||typeof E=="string",scrollWidth:P+(A??0),scrollHeight:b+(F??0),clientHeight:R,rightElement:v,paddingBottom:F,paddingRight:A,rightElementProps:S,update:Z,initialSize:k},d.createElement(ld,{eventTargetRef:m,width:C,height:R,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))};const gd=Jt("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1});var pd=d.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},d.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),md=d.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},d.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),vd=d.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},d.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),wd=10,yd=e=>{let{canvasRef:t,cellYOffset:r,rows:n,columns:o,searchInputRef:i,searchValue:l,searchResults:a,onSearchValueChange:s,getCellsForSelection:c,onSearchResultsChanged:u,showSearch:f=!1,onSearchClose:p}=e,[m]=d.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,v]=d.useState(""),S=l??h,M=d.useCallback(V=>{v(V),s==null||s(V)},[s]),[y,k]=d.useState(),I=d.useRef(y);I.current=y,d.useEffect(()=>{a!==void 0&&(a.length>0?k(V=>({rowsSearched:n,results:a.length,selectedIndex:(V==null?void 0:V.selectedIndex)??-1})):k(void 0))},[n,a]);let O=d.useRef();O.current===void 0&&(O.current=new AbortController);let E=d.useRef(),[A,F]=d.useState([]),C=a??A,R=d.useCallback(()=>{E.current!==void 0&&(window.cancelAnimationFrame(E.current),E.current=void 0,O.current.abort())},[]),L=d.useRef(r);L.current=r;let x=d.useCallback(V=>{let ae=new RegExp(V.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i"),ne=L.current,ce=Math.min(10,n),ue=0;k(void 0),F([]);let G=[],ye=async()=>{var st;if(c===void 0)return;let Q=performance.now(),ie=n-ue,te=c({x:0,y:ne,width:o.length,height:Math.min(ce,ie,n-ne)},O.current.signal);typeof te=="function"&&(te=await te());let de=!1;for(let[vt,Qe]of te.entries())for(let[le,Ne]of Qe.entries()){let ze;switch(Ne.kind){case pe.Text:case pe.Number:ze=Ne.displayData;break;case pe.Uri:case pe.Markdown:ze=Ne.data;break;case pe.Boolean:ze=typeof Ne.data=="boolean"?Ne.data.toString():void 0;break;case pe.Image:case pe.Bubble:ze=Ne.data.join("\u{1F433}");break;case pe.Custom:ze=Ne.copyData;break}ze!==void 0&&ae.test(ze)&&(G.push([le,vt+ne]),de=!0)}let Pe=performance.now();de&&F([...G]),ue+=te.length,Zt(ue<=n);let be=((st=I.current)==null?void 0:st.selectedIndex)??-1;k({results:G.length,rowsSearched:ue,selectedIndex:be}),u==null||u(G,be),ne+ce>=n?ne=0:ne+=ce;let De=Pe-Q,Ie=wd/Math.max(De,1);ce=Math.ceil(ce*Ie),ue<n&&G.length<1e3&&(E.current=window.requestAnimationFrame(ye))};R(),E.current=window.requestAnimationFrame(ye)},[R,o.length,c,u,n]),w=d.useCallback(()=>{var V;p==null||p(),k(void 0),F([]),u==null||u([],-1),R(),(V=t==null?void 0:t.current)==null||V.focus()},[R,t,p,u]),T=d.useCallback(V=>{M(V.target.value),a===void 0&&(V.target.value===""?(k(void 0),F([]),R()):x(V.target.value))},[x,R,M,a]);d.useEffect(()=>{f&&i.current!==null&&(M(""),i.current.focus({preventScroll:!0}))},[f,i,M]);let P=d.useCallback(V=>{var ne;if((ne=V==null?void 0:V.stopPropagation)==null||ne.call(V),y===void 0)return;let ae=(y.selectedIndex+1)%y.results;k({...y,selectedIndex:ae}),u==null||u(C,ae)},[y,u,C]),b=d.useCallback(V=>{var ne;if((ne=V==null?void 0:V.stopPropagation)==null||ne.call(V),y===void 0)return;let ae=(y.selectedIndex-1)%y.results;ae<0&&(ae+=y.results),k({...y,selectedIndex:ae}),u==null||u(C,ae)},[u,C,y]),J=d.useCallback(V=>{(V.ctrlKey||V.metaKey)&&V.nativeEvent.code==="KeyF"||V.key==="Escape"?(w(),V.stopPropagation(),V.preventDefault()):V.key==="Enter"&&(V.shiftKey?b():P())},[w,P,b]);d.useEffect(()=>()=>{R()},[R]);let[_,Z]=d.useState(!1);d.useEffect(()=>{if(f)Z(!0);else{let V=setTimeout(()=>Z(!1),150);return()=>clearTimeout(V)}},[f]);let ee=d.useMemo(()=>{if(!f&&!_)return null;let V;y!==void 0&&(V=y.results>=1e3?"over 1000":`${y.results} result${y.results===1?"":"s"}`,y.selectedIndex>=0&&(V=`${y.selectedIndex+1} of ${V}`));let ae=ce=>{ce.stopPropagation()},ne={width:`${Math.floor(((y==null?void 0:y.rowsSearched)??0)/n*100)}%`};return d.createElement(gd,{className:f?"":"out",onMouseDown:ae,onMouseMove:ae,onMouseUp:ae,onClick:ae},d.createElement("div",{className:"gdg-search-bar-inner"},d.createElement("input",{id:m,"aria-hidden":!f,"data-testid":"search-input",ref:i,onChange:T,value:S,tabIndex:f?void 0:-1,onKeyDownCapture:J}),d.createElement("button",{"aria-label":"Previous Result","aria-hidden":!f,tabIndex:f?void 0:-1,onClick:b,disabled:((y==null?void 0:y.results)??0)===0},pd),d.createElement("button",{"aria-label":"Next Result","aria-hidden":!f,tabIndex:f?void 0:-1,onClick:P,disabled:((y==null?void 0:y.results)??0)===0},md),p!==void 0&&d.createElement("button",{"aria-label":"Close Search","aria-hidden":!f,"data-testid":"search-close-button",tabIndex:f?void 0:-1,onClick:w},vd)),y===void 0?d.createElement("div",{className:"gdg-search-status"},d.createElement("label",{htmlFor:m},"Type to search")):d.createElement(d.Fragment,null,d.createElement("div",{className:"gdg-search-status"},d.createElement("div",{"data-testid":"search-result-area"},V)),d.createElement("div",{className:"gdg-search-progress",style:ne})))},[f,_,y,n,m,i,T,S,J,b,P,p,w]);return d.createElement(d.Fragment,null,d.createElement(fd,{prelightCells:C,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),ee)},bd=()=>e=>Math.max(16,e.targetHeight-10),xd=Jt("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[bd(),"px"]}});const Cd=e=>{let{bounds:t,group:r,onClose:n,canvasBounds:o,onFinish:i}=e,[l,a]=d.useState(r);return d.createElement(tf,{style:{position:"absolute",left:t.x-o.left+1,top:t.y-o.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:n},d.createElement(xd,{targetHeight:t.height,"data-testid":"group-rename-input",value:l,onBlur:n,onFocus:s=>s.target.setSelectionRange(0,l.length),onChange:s=>a(s.target.value),onKeyDown:s=>{s.key==="Enter"?i(l):s.key==="Escape"&&n()},autoFocus:!0}))};function Sd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Be(e,t,r){let n=ea(e,t);return n&&(r.didMatch=!0),n}function ea(e,t){if(e.length===0)return!1;if(e.includes("|")){let a=e.split("|");for(let s of a)if(ea(s,t))return!0;return!1}let r=!1,n=!1,o=!1,i=!1,l=e.split("+");if(!Sd(l.pop(),t))return!1;if(l[0]==="any")return!0;for(let a of l)switch(a){case"ctrl":r=!0;break;case"shift":n=!0;break;case"alt":o=!0;break;case"meta":i=!0;break;case"primary":Co.value?i=!0:r=!0;break}return t.altKey===o&&t.ctrlKey===r&&t.shiftKey===n&&t.metaKey===i}function kd(e,t,r,n,o,i,l){return[d.useCallback((a,s,c,u)=>{var v;(i==="cell"||i==="multi-cell")&&a!==void 0&&(a={...a,range:{x:a.cell[0],y:a.cell[1],width:1,height:1}}),!l&&a!==void 0&&a.range.width>1&&(a={...a,range:{...a.range,width:1,x:a.cell[0]}});let f=r==="mixed"&&(c||u==="drag"),p=n==="mixed"&&f,m=o==="mixed"&&f,h={current:a===void 0?void 0:{...a,rangeStack:u==="drag"?((v=e.current)==null?void 0:v.rangeStack)??[]:[]},columns:p?e.columns:nt.empty(),rows:m?e.rows:nt.empty()};c&&(i==="multi-rect"||i==="multi-cell")&&h.current!==void 0&&e.current!==void 0&&(h={...h,current:{...h.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(h,s)},[n,e,r,i,l,o,t]),d.useCallback((a,s,c)=>{a??(a=e.rows),s!==void 0&&(a=a.add(s));let u;if(o==="exclusive"&&a.length>0)u={current:void 0,columns:nt.empty(),rows:a};else{let f=c&&r==="mixed",p=c&&n==="mixed";u={current:f?e.current:void 0,columns:p?e.columns:nt.empty(),rows:a}}t(u,!1)},[n,e,r,o,t]),d.useCallback((a,s,c)=>{a??(a=e.columns),s!==void 0&&(a=a.add(s));let u;if(n==="exclusive"&&a.length>0)u={current:void 0,rows:nt.empty(),columns:a};else{let f=c&&r==="mixed",p=c&&o==="mixed";u={current:f?e.current:void 0,rows:p?e.rows:nt.empty(),columns:a}}t(u,!1)},[n,e,r,o,t])]}function Md(e,t,r,n,o){let i=d.useCallback(s=>{if(e===!0){let c=[];for(let u=s.y;u<s.y+s.height;u++){let f=[];for(let p=s.x;p<s.x+s.width;p++)p<0||u>=o?f.push({kind:pe.Loading,allowOverlay:!1}):f.push(t([p,u]));c.push(f)}return c}return(e==null?void 0:e(s,n.signal))??[]},[n.signal,t,e,o]),l=e===void 0?void 0:i,a=d.useCallback(s=>{if(l===void 0)return[];let c={...s,x:s.x-r};if(c.x<0){c.x=0,c.width--;let u=l(c,n.signal);return typeof u=="function"?async()=>(await u()).map(f=>[{kind:pe.Loading,allowOverlay:!1},...f]):u.map(f=>[{kind:pe.Loading,allowOverlay:!1},...f])}return l(c,n.signal)},[n.signal,l,r]);return[e===void 0?void 0:a,l]}function Rd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case pe.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===void 0?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case pe.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case pe.Image:case pe.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case pe.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case pe.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case pe.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case pe.Markdown:case pe.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case pe.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case pe.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case pe.Protected:return{formatted:"************",rawValue:"",format:"string"};default:qo(e)}}function Ed(e,t){return e.map((r,n)=>{let o=t[n];return r.map(i=>i.span!==void 0&&i.span[0]!==o?{formatted:"",rawValue:"",format:"string"}:Rd(i))})}function ta(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Id(e){var r;let t=[];for(let n of e){let o=[];for(let i of n)i.format==="url"?o.push(((r=i.rawValue)==null?void 0:r.toString())??""):i.format==="string-array"?o.push(i.formatted.map(l=>ta(l,!0)).join(",")):o.push(ta(i.formatted,!1));t.push(o.join("	"))}return t.join(`
`)}function bi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function ra(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Td(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function Od(e){var r;let t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(let n of e){t.push("<tr>");for(let o of n){let i=`gdg-format="${o.format}"`;o.format==="url"?t.push(`<td ${i}><a href="${o.rawValue}">${bi(o.formatted)}</a></td>`):o.format==="string-array"?t.push(`<td ${i}><ol>${o.formatted.map((l,a)=>`<li gdg-raw-value=${ra(o.rawValue[a])}>`+bi(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${ra(((r=o.rawValue)==null?void 0:r.toString())??"")} ${i}>${bi(o.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function Pd(e,t){let r=Ed(e,t);return{textPlain:Id(r),textHtml:Od(r)}}function na(e){var l;let t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");let r=t.querySelector("table");if(r===null)return;let n=[r],o=[],i;for(;n.length>0;){let a=n.pop();if(a===void 0)break;if(a instanceof HTMLTableElement||a.nodeName==="TBODY")n.push(...[...a.children].reverse());else if(a instanceof HTMLTableRowElement)i!==void 0&&o.push(i),i=[],n.push(...[...a.children].reverse());else if(a instanceof HTMLTableCellElement){let s=a.cloneNode(!0),c=s.children.length===1&&s.children[0].nodeName==="P"?s.children[0]:null,u=(c==null?void 0:c.children.length)===1&&c.children[0].nodeName==="FONT",f=s.querySelectorAll("br");for(let h of f)h.replaceWith(`
`);let p=s.getAttribute("gdg-raw-value"),m=s.getAttribute("gdg-format")??"string";if(s.querySelector("a")!==null)i==null||i.push({rawValue:((l=s.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:s.textContent??"",format:m});else if(s.querySelector("ol")!==null){let h=s.querySelectorAll("li");i==null||i.push({rawValue:[...h].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...h].map(v=>v.textContent??""),format:"string-array"})}else if(p!==null)i==null||i.push({rawValue:Td(p),formatted:s.textContent??"",format:m});else{let h=s.textContent??"";u&&(h=h.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:h??"",formatted:h??"",format:m})}}}return i!==void 0&&o.push(i),o}function Hd(e,t,r,n,o){var a;let i=e;if(n==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;let s=(a=e.current)==null?void 0:a.range,c=[];if(s.width>2){let p=t({x:s.x,y:s.y,width:1,height:s.height},o.signal);if(typeof p=="function")return i;c.push(...p);let m=t({x:s.x+s.width-1,y:s.y,width:1,height:s.height},o.signal);if(typeof m=="function")return i;c.push(...m)}else{let p=t({x:s.x,y:s.y,width:s.width,height:s.height},o.signal);if(typeof p=="function")return i;c.push(...p)}let u=s.x-r,f=s.x+s.width-1-r;for(let p of c)for(let m of p)m.span!==void 0&&(u=Math.min(m.span[0],u),f=Math.max(m.span[1],f));u===s.x-r&&f===s.x+s.width-1-r?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+r,y:s.y,width:f-u+1,height:s.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function oa(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Dd(e){let t;(function(a){a[a.None=0]="None",a[a.inString=1]="inString",a[a.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));let r=[],n=[],o=0,i=t.None;e=e.replace(/\r\n/g,`
`);let l=0;for(let a of e){switch(i){case t.None:a==="	"||a===`
`?(n.push(e.slice(o,l)),o=l+1,a===`
`&&(r.push(n),n=[])):a==='"'&&(i=t.inString);break;case t.inString:a==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:a==='"'?i=t.inString:((a==="	"||a===`
`)&&(n.push(oa(e.slice(o,l))),o=l+1,a===`
`&&(r.push(n),n=[])),i=t.None);break}l++}return o<e.length&&n.push(oa(e.slice(o,e.length))),r.push(n),r.map(a=>a.map(s=>({rawValue:s,formatted:s,format:"string"})))}function zd(e,t,r){var l;let n=Pd(e,t),o=a=>{var s;(s=window.navigator.clipboard)==null||s.writeText(a)},i=(a,s)=>{var c;return((c=window.navigator.clipboard)==null?void 0:c.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([s],{type:"text/html"})})]),!0)};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(r==null?void 0:r.clipboardData)!==void 0?((a,s)=>{var c,u;try{if(r===void 0||r.clipboardData===null)throw Error("No clipboard data");(c=r==null?void 0:r.clipboardData)==null||c.setData("text/plain",a),(u=r==null?void 0:r.clipboardData)==null||u.setData("text/html",s)}catch{i(a,s)||o(a)}})(n.textPlain,n.textHtml):o(n.textPlain),r==null||r.preventDefault()}function ia(e){return e!==!0}function la(e){return typeof e=="string"?e:`${e}px`}var Ad=()=>e=>e.innerWidth,Ld=()=>e=>e.innerHeight,Fd=Jt("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Ad()],"wmyidgi-1":[Ld()]}});const jd=e=>{let{inWidth:t,inHeight:r,children:n,...o}=e;return d.createElement(Fd,{innerHeight:la(r),innerWidth:la(t),...o},n)};var _d=2,Nd=1300;function Wd(e,t,r){let n=d.useRef(0),[o,i]=e??[0,0];d.useEffect(()=>{if(o===0&&i===0){n.current=0;return}let l=!1,a=0,s=c=>{var u;if(!l){if(a===0)a=c;else{let f=c-a;n.current=Math.min(1,n.current+f/Nd);let p=n.current**1.618*f*_d;(u=t.current)==null||u.scrollBy(o*p,i*p),a=c,r==null||r()}window.requestAnimationFrame(s)}};return window.requestAnimationFrame(s),()=>{l=!0}},[t,o,i,r])}function Bd({rowHeight:e,headerHeight:t,groupHeaderHeight:r,theme:n,overscrollX:o,overscrollY:i,scaleToRem:l,remSize:a}){let[s,c,u,f,p,m]=d.useMemo(()=>{if(!l||a===16)return[e,t,r,n,o,i];let h=a/16,v=e,S=us();return[typeof v=="number"?v*h:M=>Math.ceil(v(M)*h),Math.ceil(t*h),Math.ceil(r*h),{...n,headerIconSize:((n==null?void 0:n.headerIconSize)??S.headerIconSize)*h,cellHorizontalPadding:((n==null?void 0:n.cellHorizontalPadding)??S.cellHorizontalPadding)*h,cellVerticalPadding:((n==null?void 0:n.cellVerticalPadding)??S.cellVerticalPadding)*h},Math.ceil((o??0)*h),Math.ceil((i??0)*h)]},[r,t,o,i,a,e,l,n]);return{rowHeight:s,headerHeight:c,groupHeaderHeight:u,theme:f,overscrollX:p,overscrollY:m}}const zr={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function $e(e,t){return e===!0?t:e===!1?"":e}function aa(e){let t=Co.value;return{activateCell:$e(e.activateCell," |Enter|shift+Enter"),clear:$e(e.clear,"any+Escape"),closeOverlay:$e(e.closeOverlay,"any+Escape"),acceptOverlayDown:$e(e.acceptOverlayDown,"Enter"),acceptOverlayUp:$e(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:$e(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:$e(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:$e(e.delete,t?"Backspace|Delete":"Delete"),downFill:$e(e.downFill,"primary+_68"),scrollToSelectedCell:$e(e.scrollToSelectedCell,"primary+Enter"),goDownCell:$e(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:$e(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:$e(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:$e(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:$e(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:$e(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:$e(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:$e(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:$e(e.goToFirstCell,"primary+Home"),goToFirstColumn:$e(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:$e(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:$e(e.goToLastCell,"primary+End"),goToLastColumn:$e(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:$e(e.goToLastRow,"primary+ArrowDown"),goToNextPage:$e(e.goToNextPage,"PageDown"),goToPreviousPage:$e(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:$e(e.rightFill,"primary+_82"),search:$e(e.search,"primary+f"),selectAll:$e(e.selectAll,"primary+a"),selectColumn:$e(e.selectColumn,"ctrl+ "),selectGrowDown:$e(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:$e(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:$e(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:$e(e.selectGrowUp,"shift+ArrowUp"),selectRow:$e(e.selectRow,"shift+ "),selectToFirstCell:$e(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:$e(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:$e(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:$e(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:$e(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:$e(e.selectToLastRow,"primary+shift+ArrowDown")}}function $d(e){let t=Os(e);return d.useMemo(()=>{if(t===void 0)return aa(zr);let r={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??zr.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??zr.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??zr.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??zr.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??zr.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??zr.selectToLastCell};return aa({...zr,...r})},[t])}function Vd(e){function t(r,n,o){if(typeof r=="number")return{headerIndex:r,isCollapsed:!1,depth:n,path:o};let i={headerIndex:r.headerIndex,isCollapsed:r.isCollapsed,depth:n,path:o};return r.subGroups!==void 0&&(i.subGroups=r.subGroups.map((l,a)=>t(l,n+1,[...o,a])).sort((l,a)=>l.headerIndex-a.headerIndex)),i}return e.map((r,n)=>t(r,0,[n])).sort((r,n)=>r.headerIndex-n.headerIndex)}function xi(e,t){let r=[];function n(l,a,s=!1){let c=a===null?t-l.headerIndex:a-l.headerIndex;if(l.subGroups!==void 0&&(c=l.subGroups[0].headerIndex-l.headerIndex),c--,r.push({headerIndex:l.headerIndex,contentIndex:-1,skip:s,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:c}),l.subGroups)for(let u=0;u<l.subGroups.length;u++){let f=u<l.subGroups.length-1?l.subGroups[u+1].headerIndex:a;n(l.subGroups[u],f,s||l.isCollapsed)}}let o=Vd(e.groups);for(let l=0;l<o.length;l++){let a=l<o.length-1?o[l+1].headerIndex:null;n(o[l],a)}let i=0;for(let l of r)l.contentIndex=i,i+=l.rows;return r.filter(l=>l.skip===!1).map(l=>{let{skip:a,...s}=l;return s})}function So(e,t){if(t===void 0||xi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let r=e;for(let n of t){if(r===0)return{path:[...n.path,-1],originalIndex:n.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:n.rows};if(r--,!n.isCollapsed){if(r<n.rows)return{path:[...n.path,r],originalIndex:n.headerIndex+r,isGroupHeader:!1,groupIndex:r,contentIndex:n.contentIndex+r,groupRows:n.rows};r-=n.rows}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Kd(e,t,r,n){let o=d.useMemo(()=>e===void 0?void 0:xi(e,t),[e,t]),i=d.useMemo(()=>o===void 0?t:o.reduce((c,u)=>c+(u.isCollapsed?1:u.rows+1),0),[o,t]),l=d.useMemo(()=>e===void 0||typeof r=="number"&&e.height===r?r:c=>{let{isGroupHeader:u}=So(c,o);return u?e.height:typeof r=="number"?r:r(c)},[o,e,r]),a=d.useCallback(c=>{if(o===void 0)return c;let u=c;for(let f of o){if(u===0)return;if(u--,!f.isCollapsed){if(u<f.rows)return f.contentIndex+u;u-=f.rows}}return c},[o]),s=Gr(n??(e==null?void 0:e.themeOverride),d.useCallback(c=>{if(e===void 0)return n==null?void 0:n(c,c,c);if(n===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;let{isGroupHeader:u,contentIndex:f,groupIndex:p}=So(c,o);return u?e.themeOverride:n==null?void 0:n(c,p,f)},[o,n,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:a,getRowThemeOverride:s}:{rowHeight:l,rows:i,rowNumberMapper:a,getRowThemeOverride:s}}function Yd(e,t){let r=d.useMemo(()=>e===void 0?void 0:xi(e,t),[e,t]);return{getRowGroupingForPath:ca,updateRowGroupingByPath:sa,mapper:d.useCallback(n=>{if(typeof n=="number")return So(n,r);let o=So(n[1],r);return{...o,originalIndex:[n[0],o.originalIndex]}},[r])}}function sa(e,t,r){let[n,...o]=t;return o[0]===-1?e.map((i,l)=>l===n?{...i,...r}:i):e.map((i,l)=>l===n?{...i,subGroups:sa(i.subGroups??[],o,r)}:i)}function ca(e,t){let[r,...n]=t;return n[0]===-1?e[r]:ca(e[r].subGroups??[],n)}function Gd(e,t){let[r]=d.useState(()=>({value:e,callback:t,facade:{get current(){return r.value},set current(n){let o=r.value;o!==n&&(r.value=n,r.callback(n,o))}}}));return r.callback=t,r.facade}function Ud(e,t,r,n,o){let[i,l]=d.useMemo(()=>[t!==void 0&&typeof r=="number"?Math.floor(t/r):0,t!==void 0&&typeof r=="number"?-(t%r):0],[t,r]),[a,s,c]=Ts(d.useMemo(()=>({x:n.current.x,y:i,width:n.current.width??1,height:n.current.height??1,ty:l}),[n,l,i])),u=d.useRef(o);u.current=o;let f=Gd(null,h=>{h!==null&&t!==void 0?h.scrollTop=t:h!==null&&e!==void 0&&(h.scrollLeft=e)}),p=(a.height??1)>1;d.useLayoutEffect(()=>{if(t!==void 0&&f.current!==null&&p){if(f.current.scrollTop===t)return;f.current.scrollTop=t,f.current.scrollTop!==t&&c(),u.current()}},[t,p,c,f]);let m=(a.width??1)>1;return d.useLayoutEffect(()=>{if(e!==void 0&&f.current!==null&&m){if(f.current.scrollLeft===e)return;f.current.scrollLeft=e,f.current.scrollLeft!==e&&c(),u.current()}},[e,m,c,f]),{visibleRegion:a,setVisibleRegion:s,scrollRef:f}}var Zr=Gt(yo(),1),Xd=Gt(wc(),1),ua=Gt(xc(),1),bn=Gt(Sl(),1),qd=Gt(ti(),1),Zd=d.lazy(async()=>await Ja(()=>import("./data-grid-overlay-editor-Cty9HaeD.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)),Jd=0;function Qd(e){return(0,Xd.default)((0,ua.default)((0,ua.default)(e).filter(t=>t.span!==void 0).map(t=>{var r,n;return(0,bn.default)((((r=t.span)==null?void 0:r[0])??0)+1,(((n=t.span)==null?void 0:n[1])??0)+1)})))}function ko(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(r=>({...r,x:r.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}var Mo={kind:pe.Loading,allowOverlay:!1},Ro={columns:nt.empty(),rows:nt.empty(),current:void 0};const eh=d.forwardRef((e,t)=>{var Wa,Ba,$a;let[r,n]=d.useState(Ro),[o,i]=d.useState(),l=d.useRef(null),a=d.useRef(null),[s,c]=d.useState(),u=d.useRef(),f=typeof window>"u"?null:window,{imageEditorOverride:p,getRowThemeOverride:m,markdownDivCreateNode:h,width:v,height:S,columns:M,rows:y,getCellContent:k,onCellClicked:I,onCellActivated:O,onFillPattern:E,onFinishedEditing:A,coercePasteValue:F,drawHeader:C,drawCell:R,editorBloom:L,onHeaderClicked:x,onColumnProposeMove:w,rangeSelectionColumnSpanning:T=!0,spanRangeBehavior:P="default",onGroupHeaderClicked:b,onCellContextMenu:J,className:_,onHeaderContextMenu:Z,getCellsForSelection:ee,onGroupHeaderContextMenu:V,onGroupHeaderRenamed:ae,onCellEdited:ne,onCellsEdited:ce,onSearchResultsChanged:ue,searchResults:G,onSearchValueChange:ye,searchValue:Q,onKeyDown:ie,onKeyUp:te,keybindings:de,editOnType:Pe=!0,onRowAppended:be,onColumnMoved:De,validateCell:Ie,highlightRegions:st,rangeSelect:vt="rect",columnSelect:Qe="multi",rowSelect:le="multi",rangeSelectionBlending:Ne="exclusive",columnSelectionBlending:ze="exclusive",rowSelectionBlending:Ke="exclusive",onDelete:Se,onDragStart:Ye,onMouseMove:We,onPaste:Ue,copyHeaders:me=!1,freezeColumns:Ce=0,cellActivationBehavior:rt="second-click",rowSelectionMode:qe="auto",onHeaderMenuClick:Xe,onHeaderIndicatorClick:ft,getGroupDetails:et,rowGrouping:Ae,onSearchClose:St,onItemHovered:zt,onSelectionCleared:kt,showSearch:Rt,onVisibleRegionChanged:jt,gridSelection:wt,onGridSelectionChange:pr,minColumnWidth:Ar=50,maxColumnWidth:dt=500,maxColumnAutoWidth:kr,provideEditor:ir,trailingRowOptions:Ee,freezeTrailingRows:yt=0,allowedFillDirections:mr="orthogonal",scrollOffsetX:lr,scrollOffsetY:Qt,verticalBorder:Ve,onDragOverCell:xt,onDrop:Mt,onColumnResize:Nt,onColumnResizeEnd:Pt,onColumnResizeStart:$t,customRenderers:Lr,fillHandle:Et,experimental:Ct,fixedShadowX:Tt,fixedShadowY:At,headerIcons:Mr,imageWindowLoader:Eo,initialSize:Fr,isDraggable:Rr,onDragLeave:Er,onRowMoved:vr,overscrollX:Io,overscrollY:To,preventDiagonalScrolling:Cn,rightElement:Sn,rightElementProps:kn,trapFocus:Jr=!1,smoothScrollX:Qr,smoothScrollY:jr,scaleToRem:Oo=!1,rowHeight:Mi=34,headerHeight:Po=36,groupHeaderHeight:Mn=Po,theme:_r,isOutsideClick:Ri,renderers:qn,resizeIndicator:Ho,scrollToActiveCell:Zn=!0,drawFocusRing:en=!0}=e,Jn=en==="no-editor"?o===void 0:en,gt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Vt=(gt==null?void 0:gt.kind)??e.rowMarkers??"none",Do=(gt==null?void 0:gt.width)??e.rowMarkerWidth,Ir=(gt==null?void 0:gt.startIndex)??e.rowMarkerStartIndex??1,Tr=(gt==null?void 0:gt.theme)??e.rowMarkerTheme,Rn=gt==null?void 0:gt.headerTheme,Nr=gt==null?void 0:gt.headerAlwaysVisible,En=le!=="multi",tn=(gt==null?void 0:gt.checkboxStyle)??"square",Or=Math.max(Ar,20),rn=Math.max(dt,Or),zo=Math.max(kr??rn,Or),Qn=d.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Te,rowNumberMapper:eo,rowHeight:Ei,getRowThemeOverride:ar}=Kd(Ae,y,Mi,m),{rowHeight:wr,headerHeight:nn,groupHeaderHeight:to,theme:on,overscrollX:ro,overscrollY:no}=Bd({groupHeaderHeight:Mn,headerHeight:Po,overscrollX:Io,overscrollY:To,remSize:d.useMemo(()=>Number.parseFloat(Qn.fontSize),[Qn]),rowHeight:Ei,scaleToRem:Oo,theme:_r}),yr=$d(de),sr=Do??(y>1e4?48:y>1e3?44:y>100?36:32),er=Vt!=="none",B=er?1:0,bt=be!==void 0,ln=(Ee==null?void 0:Ee.sticky)===!0,[j,re]=d.useState(!1),xe=Rt??j,fe=d.useCallback(()=>{St===void 0?re(!1):St()},[St]),z=d.useMemo(()=>wt===void 0?void 0:ko(wt,B),[wt,B])??r,se=d.useRef();se.current===void 0&&(se.current=new AbortController),d.useEffect(()=>()=>se==null?void 0:se.current.abort(),[]);let[ve,_e]=Md(ee,k,B,se.current,Te),Re=d.useCallback((g,H,D)=>{if(Ie===void 0)return!0;let N=[g[0]-B,g[1]];return Ie==null?void 0:Ie(N,H,D)},[B,Ie]),ct=d.useRef(wt),he=d.useCallback((g,H)=>{H&&(g=Hd(g,ve,B,P,se.current)),pr===void 0?n(g):(ct.current=ko(g,-B),pr(ct.current))},[pr,ve,B,P]),je=Gr(Nt,d.useCallback((g,H,D,N)=>{Nt==null||Nt(M[D-B],H,D-B,N)},[Nt,B,M])),Ge=Gr(Pt,d.useCallback((g,H,D,N)=>{Pt==null||Pt(M[D-B],H,D-B,N)},[Pt,B,M])),it=Gr($t,d.useCallback((g,H,D,N)=>{$t==null||$t(M[D-B],H,D-B,N)},[$t,B,M])),Ot=Gr(C,d.useCallback((g,H)=>(C==null?void 0:C({...g,columnIndex:g.columnIndex-B},H))??!1,[C,B])),Ut=Gr(R,d.useCallback((g,H)=>(R==null?void 0:R({...g,col:g.col-B},H))??!1,[R,B])),lt=d.useCallback(g=>{if(Se!==void 0){let H=Se(ko(g,-B));return typeof H=="boolean"?H:ko(H,B)}return!0},[Se,B]),[pt,mt,He]=kd(z,he,Ne,ze,Ke,vt,T),at=d.useMemo(()=>Pr(us(),on),[on]),[_t,an]=d.useState([0,0,0]),cr=d.useMemo(()=>{if(qn===void 0)return{};let g={};for(let H of qn)g[H.kind]=H;return g},[qn]),Ht=d.useCallback(g=>g.kind===pe.Custom?Lr==null?void 0:Lr.find(H=>H.isMatch(g)):cr[g.kind],[Lr,cr]),{sizedColumns:Dt,nonGrowWidth:Sa}=ic(M,Te,_e,_t[0]-(B===0?0:sr)-_t[2],Or,zo,at,Ht,se.current);Vt!=="none"&&(Sa+=sr);let Ii=d.useMemo(()=>Dt.some(g=>g.group!==void 0),[Dt]),oo=Ii?nn+to:nn,ka=z.rows.length,Ma=Vt==="none"?void 0:ka===0?!1:ka===Te?!0:void 0,ot=d.useMemo(()=>Vt==="none"?Dt:[{title:"",width:sr,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Tr,rowMarker:tn,rowMarkerChecked:Ma,headerRowMarkerTheme:Rn,headerRowMarkerAlwaysVisible:Nr,headerRowMarkerDisabled:En},...Dt],[Vt,Dt,sr,Tr,tn,Ma,Rn,Nr,En]),Xt=d.useRef({height:1,width:1,x:0,y:0}),Ao=d.useRef(!1),{setVisibleRegion:Ra,visibleRegion:sn,scrollRef:ht}=Ud(lr,Qt,wr,Xt,()=>Ao.current=!0);Xt.current=sn;let Uh=sn.x+B,Lo=sn.y,Kt=d.useRef(null),Bt=d.useCallback(g=>{var H;g===!0?(H=Kt.current)==null||H.focus():window.requestAnimationFrame(()=>{var D;(D=Kt.current)==null||D.focus()})},[]),Wt=bt?Te+1:Te,tr=d.useCallback(g=>{let H=B===0?g:g.map(N=>({...N,location:[N.location[0]-B,N.location[1]]})),D=ce==null?void 0:ce(H);if(D!==!0)for(let N of H)ne==null||ne(N.location,N.value);return D},[ne,ce,B]),[cn,Ti]=d.useState(),Fo=z.current!==void 0&&z.current.range.width*z.current.range.height>1?z.current.range:void 0,In=Jn?(Wa=z.current)==null?void 0:Wa.cell:void 0,jo=In==null?void 0:In[0],_o=In==null?void 0:In[1],Xh=d.useMemo(()=>{if((st===void 0||st.length===0)&&(Fo??jo??_o??cn)===void 0)return;let g=[];if(st!==void 0)for(let H of st){let D=ot.length-H.range.x-B;D>0&&g.push({color:H.color,range:{...H.range,x:H.range.x+B,width:Math.min(D,H.range.width)},style:H.style})}return cn!==void 0&&g.push({color:gn(at.accentColor,0),range:cn,style:"dashed"}),Fo!==void 0&&g.push({color:gn(at.accentColor,.5),range:Fo,style:"solid-outline"}),jo!==void 0&&_o!==void 0&&g.push({color:at.accentColor,range:{x:jo,y:_o,width:1,height:1},style:"solid-outline"}),g.length>0?g:void 0},[cn,Fo,jo,_o,st,ot.length,at.accentColor,B]),Ea=d.useRef(ot);Ea.current=ot;let qt=d.useCallback(([g,H],D=!1)=>{var W,Y,$,K,q,U,ge;let N=bt&&H===Wt-1;if(g===0&&er){if(N)return Mo;let we=eo(H);return we===void 0?Mo:{kind:$r.Marker,allowOverlay:!1,checkboxStyle:tn,checked:(z==null?void 0:z.rows.hasIndex(H))===!0,markerKind:Vt==="clickable-number"?"number":Vt,row:Ir+we,drawHandle:vr!==void 0,cursor:Vt==="clickable-number"?"pointer":void 0}}else if(N){let we=g===B?(Ee==null?void 0:Ee.hint)??"":"",oe=Ea.current[g];if(((W=oe==null?void 0:oe.trailingRowOptions)==null?void 0:W.disabled)===!0)return Mo;{let ke=((Y=oe==null?void 0:oe.trailingRowOptions)==null?void 0:Y.hint)??we,Le=(($=oe==null?void 0:oe.trailingRowOptions)==null?void 0:$.addIcon)??(Ee==null?void 0:Ee.addIcon);return{kind:$r.NewRow,hint:ke,allowOverlay:!1,icon:Le}}}else{let we=g-B;if(D||(Ct==null?void 0:Ct.strict)===!0){let ke=Xt.current,Le=ke.x>we||we>ke.x+ke.width||ke.y>H||H>ke.y+ke.height||H>=Pi.current,Ze=we===((q=(K=ke.extras)==null?void 0:K.selected)==null?void 0:q[0])&&H===((U=ke.extras)==null?void 0:U.selected[1]),Oe=!1;if(((ge=ke.extras)==null?void 0:ge.freezeRegions)!==void 0){for(let Me of ke.extras.freezeRegions)if(qr(Me,we,H)){Oe=!0;break}}if(Le&&!Ze&&!Oe)return Mo}let oe=k([we,H]);return B!==0&&oe.span!==void 0&&(oe={...oe,span:[oe.span[0]+B,oe.span[1]+B]}),oe}},[bt,Wt,er,eo,tn,z==null?void 0:z.rows,Vt,Ir,vr,B,Ee==null?void 0:Ee.hint,Ee==null?void 0:Ee.addIcon,Ct==null?void 0:Ct.strict,k]),Oi=d.useCallback(g=>{let H=(et==null?void 0:et(g))??{name:g};return ae!==void 0&&g!==""&&(H={icon:H.icon,name:H.name,overrideTheme:H.overrideTheme,actions:[...H.actions??[],{title:"Rename",icon:"renameIcon",onClick:D=>Di({group:H.name,bounds:D.bounds})}]}),H},[et,ae]),No=d.useCallback(g=>{var K;let[H,D]=g.cell,N=ot[H],W=(N==null?void 0:N.group)===void 0||(K=Oi(N.group))==null?void 0:K.overrideTheme,Y=N==null?void 0:N.themeOverride,$=ar==null?void 0:ar(D);i({...g,theme:Pr(at,W,Y,$,g.content.themeOverride)})},[ar,ot,Oi,at]),Tn=d.useCallback((g,H,D)=>{var $;if(z.current===void 0)return;let[N,W]=z.current.cell,Y=qt([N,W]);if(Y.kind!==pe.Boolean&&Y.allowOverlay){let K=Y;if(D!==void 0)switch(K.kind){case pe.Number:{let q=U0(()=>D==="-"?-0:Number.parseFloat(D),0);K={...K,data:Number.isNaN(q)?0:q};break}case pe.Text:case pe.Markdown:case pe.Uri:K={...K,data:D};break}No({target:g,content:K,initialValue:D,cell:[N,W],highlight:D===void 0,forceEditMode:D!==void 0})}else Y.kind===pe.Boolean&&H&&Y.readonly!==!0&&(tr([{location:z.current.cell,value:{...Y,data:ia(Y.data)}}]),($=Kt.current)==null||$.damage([{cell:z.current.cell}]))},[qt,z,tr,No]),Ia=d.useCallback((g,H)=>{var W;let D=(W=Kt.current)==null?void 0:W.getBounds(g,H);if(D===void 0||ht.current===null)return;let N=qt([g,H]);N.allowOverlay&&No({target:D,content:N,initialValue:void 0,highlight:!0,cell:[g,H],forceEditMode:!0})},[qt,ht,No]),It=d.useCallback((g,H,D="both",N=0,W=0,Y=void 0)=>{if(ht.current!==null){let $=Kt.current,K=a.current,q=typeof g=="number"?g:g.unit==="cell"?g.amount:void 0,U=typeof H=="number"?H:H.unit==="cell"?H.amount:void 0,ge=typeof g!="number"&&g.unit==="px"?g.amount:void 0,we=typeof H!="number"&&H.unit==="px"?H.amount:void 0;if($!==null&&K!==null){let oe={x:0,y:0,width:0,height:0},ke=0,Le=0;if((q!==void 0||U!==void 0)&&(oe=$.getBounds((q??0)+B,U??0)??oe,oe.width===0||oe.height===0))return;let Ze=K.getBoundingClientRect(),Oe=Ze.width/K.offsetWidth;if(ge!==void 0&&(oe={...oe,x:ge-Ze.left-ht.current.scrollLeft,width:1}),we!==void 0&&(oe={...oe,y:we+Ze.top-ht.current.scrollTop,height:1}),oe!==void 0){let Me={x:oe.x-N,y:oe.y-W,width:oe.width+2*N,height:oe.height+2*W},Je=0;for(let Ni=0;Ni<Ce;Ni++)Je+=Dt[Ni].width;let Yt=0,Lt=yt+(ln?1:0);Lt>0&&(Yt=Xr(Wt,Lt,wr));let hr=Je*Oe+Ze.left+B*sr*Oe,xr=Ze.right,nr=Ze.top+oo*Oe,zn=Ze.bottom-Yt*Oe,Go=oe.width+N*2;switch(Y==null?void 0:Y.hAlign){case"start":xr=hr+Go;break;case"end":hr=xr-Go;break;case"center":hr=Math.floor((hr+xr)/2)-Go/2,xr=hr+Go;break}let Uo=oe.height+W*2;switch(Y==null?void 0:Y.vAlign){case"start":zn=nr+Uo;break;case"end":nr=zn-Uo;break;case"center":nr=Math.floor((nr+zn)/2)-Uo/2,zn=nr+Uo;break}hr>Me.x?ke=Me.x-hr:xr<Me.x+Me.width&&(ke=Me.x+Me.width-xr),nr>Me.y?Le=Me.y-nr:zn<Me.y+Me.height&&(Le=Me.y+Me.height-zn),D==="vertical"||typeof g=="number"&&g<Ce?ke=0:(D==="horizontal"||typeof H=="number"&&H>=Wt-Lt)&&(Le=0),(ke!==0||Le!==0)&&(Oe!==1&&(ke/=Oe,Le/=Oe),ht.current.scrollTo(ke+ht.current.scrollLeft,Le+ht.current.scrollTop))}}}},[B,yt,sr,ht,oo,Ce,Dt,Wt,ln,wr]),Ta=d.useRef(Ia),Oa=d.useRef(k),Pi=d.useRef(Te);Ta.current=Ia,Oa.current=k,Pi.current=Te;let On=d.useCallback(async(g,H=!0)=>{var K,q;if(((q=(K=ot[g])==null?void 0:K.trailingRowOptions)==null?void 0:q.disabled)===!0)return;let D=be==null?void 0:be(),N,W=!0;D!==void 0&&(N=await D,N==="top"&&(W=!1),typeof N=="number"&&(W=!1));let Y=0,$=()=>{if(Pi.current<=Te){Y<500&&window.setTimeout($,Y),Y=50+Y*2;return}let U=typeof N=="number"?N:W?Te:0;Yo.current(g-B,U),pt({cell:[g,U],range:{x:g,y:U,width:1,height:1}},!1,!1,"edit");let ge=Oa.current([g-B,U]);ge.allowOverlay&&po(ge)&&ge.readonly!==!0&&H&&window.setTimeout(()=>{Ta.current(g,U)},0)};$()},[ot,be,B,Te,pt]),Wo=d.useCallback(g=>{var D,N;let H=((N=(D=Dt[g])==null?void 0:D.trailingRowOptions)==null?void 0:N.targetColumn)??(Ee==null?void 0:Ee.targetColumn);if(typeof H=="number")return H+(er?1:0);if(typeof H=="object"){let W=M.indexOf(H);if(W>=0)return W+(er?1:0)}},[Dt,M,er,Ee==null?void 0:Ee.targetColumn]),Wr=d.useRef(),Pn=d.useRef(),io=d.useCallback((g,H)=>{var W;let[D,N]=H;return Pr(at,(W=ot[D])==null?void 0:W.themeOverride,ar==null?void 0:ar(N),g.themeOverride)},[ar,ot,at]),{mapper:un}=Yd(Ae,y),ur=Ae==null?void 0:Ae.navigationBehavior,lo=d.useCallback(g=>{var ge,we,oe;let H=Co.value?g.metaKey:g.ctrlKey,D=H&&le==="multi",N=H&&Qe==="multi",[W,Y]=g.location,$=z.columns,K=z.rows,[q,U]=((ge=z.current)==null?void 0:ge.cell)??[];if(g.kind==="cell"){if(Pn.current=void 0,dn.current=[W,Y],W===0&&er){if(bt===!0&&Y===Te||Vt==="number"||le==="none")return;let ke=qt(g.location);if(ke.kind!==$r.Marker)return;if(vr!==void 0){let Oe=Ht(ke);Zt((Oe==null?void 0:Oe.kind)===$r.Marker);let Me=(we=Oe==null?void 0:Oe.onClick)==null?void 0:we.call(Oe,{...g,cell:ke,posX:g.localEventX,posY:g.localEventY,bounds:g.bounds,theme:io(ke,g.location),preventDefault:()=>{}});if(Me===void 0||Me.checked===ke.checked)return}i(void 0),Bt();let Le=K.hasIndex(Y),Ze=Wr.current;if(le==="multi"&&(g.shiftKey||g.isLongTouch===!0)&&Ze!==void 0&&K.hasIndex(Ze)){let Oe=[Math.min(Ze,Y),Math.max(Ze,Y)+1];D||qe==="multi"?mt(void 0,Oe,!0):mt(nt.fromSingleSelection(Oe),void 0,D)}else le==="multi"&&(D||g.isTouch||qe==="multi")?Le?mt(K.remove(Y),void 0,!0):(mt(void 0,Y,!0),Wr.current=Y):Le&&K.length===1?mt(nt.empty(),void 0,H):(mt(nt.fromSingleSelection(Y),void 0,H),Wr.current=Y)}else if(W>=B&&bt&&Y===Te)On(Wo(W)??W);else if(q!==W||U!==Y){let ke=qt(g.location),Le=Ht(ke);if((Le==null?void 0:Le.onSelect)!==void 0){let Me=!1;if(Le.onSelect({...g,cell:ke,posX:g.localEventX,posY:g.localEventY,bounds:g.bounds,preventDefault:()=>Me=!0,theme:io(ke,g.location)}),Me)return}if(ur==="block"&&un(Y).isGroupHeader)return;let Ze=ln&&Y===Te,Oe=ln&&z!==void 0&&((oe=z.current)==null?void 0:oe.cell[1])===Te;if((g.shiftKey||g.isLongTouch===!0)&&q!==void 0&&U!==void 0&&z.current!==void 0&&!Oe){if(Ze)return;let Me=Math.min(W,q),Je=Math.max(W,q),Yt=Math.min(Y,U),Lt=Math.max(Y,U);pt({...z.current,range:{x:Me,y:Yt,width:Je-Me+1,height:Lt-Yt+1}},!0,H,"click"),Wr.current=void 0,Bt()}else pt({cell:[W,Y],range:{x:W,y:Y,width:1,height:1}},!0,H,"click"),Wr.current=void 0,i(void 0),Bt()}}else if(g.kind==="header")if(dn.current=[W,Y],i(void 0),er&&W===0)Wr.current=void 0,Pn.current=void 0,le==="multi"&&(K.length===Te?mt(nt.empty(),void 0,H):mt(nt.fromSingleSelection([0,Te]),void 0,H),Bt());else{let ke=Pn.current;if(Qe==="multi"&&(g.shiftKey||g.isLongTouch===!0)&&ke!==void 0&&$.hasIndex(ke)){let Le=[Math.min(ke,W),Math.max(ke,W)+1];N?He(void 0,Le,H):He(nt.fromSingleSelection(Le),void 0,H)}else N?($.hasIndex(W)?He($.remove(W),void 0,H):He(void 0,W,H),Pn.current=W):Qe!=="none"&&(He(nt.fromSingleSelection(W),void 0,H),Pn.current=W);Wr.current=void 0,Bt()}else g.kind==="group-header"?dn.current=[W,Y]:g.kind==="out-of-bounds"&&!g.isMaybeScrollbar&&(he(Ro,!1),i(void 0),Bt(),kt==null||kt(),Wr.current=void 0,Pn.current=void 0)},[le,Qe,z,er,B,bt,Te,Vt,qt,vr,Bt,qe,Ht,io,mt,Wo,On,ur,un,ln,pt,He,he,kt]),ao=d.useRef(!1),dn=d.useRef(),Pa=d.useRef(sn),rr=d.useRef(),qh=d.useCallback(g=>{if(Hn.current=!1,Pa.current=Xt.current,g.button!==0&&g.button!==1){rr.current=void 0;return}let H=performance.now();rr.current={button:g.button,time:H,location:g.location},(g==null?void 0:g.kind)==="header"&&(ao.current=!0);let D=g.kind==="cell"&&g.isFillHandle;!D&&g.kind!=="cell"&&g.isEdge||(c({previousSelection:z,fillHandle:D}),dn.current=void 0,!g.isTouch&&g.button===0&&!D?lo(g):!g.isTouch&&g.button===1&&(dn.current=g.location))},[z,lo]),[Hi,Di]=d.useState(),Ha=d.useCallback(g=>{if(g.kind!=="group-header"||Qe!=="multi")return;let H=Co.value?g.metaKey:g.ctrlKey,[D]=g.location,N=z.columns;if(D<B)return;let W=ot[D],Y=D,$=D;for(let K=D-1;K>=B&&_n(W.group,ot[K].group);K--)Y--;for(let K=D+1;K<ot.length&&_n(W.group,ot[K].group);K++)$++;if(Bt(),H)if(N.hasAll([Y,$+1])){let K=N;for(let q=Y;q<=$;q++)K=K.remove(q);He(K,void 0,H)}else He(void 0,[Y,$+1],H);else He(nt.fromSingleSelection([Y,$+1]),void 0,H)},[Qe,Bt,z.columns,ot,B,He]),Hn=d.useRef(!1),Bo=d.useCallback(async g=>{if(ve!==void 0&&je!==void 0){let H=Xt.current.y,D=Xt.current.height,N=ve({x:g,y:H,width:1,height:Math.min(D,Te-H)},se.current.signal);typeof N!="object"&&(N=await N());let W=Dt[g-B],Y=document.createElement("canvas").getContext("2d",{alpha:!1});if(Y!==null){Y.font=at.baseFontFull;let $=wl(Y,at,W,0,N,Or,rn,!1,Ht);je==null||je(W,$.width,g,$.width)}}},[Dt,ve,rn,at,Or,je,B,Te,Ht]),[Zh,zi]=d.useState(),Dn=d.useCallback(async(g,H)=>{var K,q;let D=(K=g.current)==null?void 0:K.range;if(D===void 0||ve===void 0||H.current===void 0)return;let N=H.current.range;if(E!==void 0){let U=!1;if(E({fillDestination:{...N,x:N.x-B},patternSource:{...D,x:D.x-B},preventDefault:()=>U=!0}),U)return}let W=ve(D,se.current.signal);typeof W!="object"&&(W=await W());let Y=W,$=[];for(let U=0;U<N.width;U++)for(let ge=0;ge<N.height;ge++){let we=[N.x+U,N.y+ge];if(ll(we,D))continue;let oe=Y[ge%D.height][U%D.width];Fn(oe)||!po(oe)||$.push({location:we,value:{...oe}})}tr($),(q=Kt.current)==null||q.damage($.map(U=>({cell:U.location})))},[ve,tr,E,B]),Da=d.useCallback(()=>{z.current===void 0||z.current.range.width<=1||Dn({...z,current:{...z.current,range:{...z.current.range,width:1}}},z)},[Dn,z]),za=d.useCallback(()=>{z.current===void 0||z.current.range.height<=1||Dn({...z,current:{...z.current,range:{...z.current.range,height:1}}},z)},[Dn,z]),Jh=d.useCallback((g,H)=>{var ge,we;let D=s;if(c(void 0),Ti(void 0),zi(void 0),ao.current=!1,H)return;if((D==null?void 0:D.fillHandle)===!0&&z.current!==void 0&&((ge=D.previousSelection)==null?void 0:ge.current)!==void 0){if(cn===void 0)return;let oe={...z,current:{...z.current,range:Il(D.previousSelection.current.range,cn)}};Dn(D.previousSelection,oe),he(oe,!0);return}let[N,W]=g.location,[Y,$]=dn.current??[],K=()=>{Hn.current=!0},q=oe=>{var Le,Ze,Oe;let ke=oe.isTouch||Y===N&&$===W;if(ke&&(I==null||I([N-B,W],{...oe,preventDefault:K})),oe.button===1)return!Hn.current;if(!Hn.current){let Me=qt(g.location),Je=Ht(Me);if(Je!==void 0&&Je.onClick!==void 0&&ke){let Lt=Je.onClick({...oe,cell:Me,posX:oe.localEventX,posY:oe.localEventY,bounds:oe.bounds,theme:io(Me,g.location),preventDefault:K});Lt!==void 0&&!Fn(Lt)&&go(Lt)&&(tr([{location:oe.location,value:Lt}]),(Le=Kt.current)==null||Le.damage([{cell:oe.location}]))}if(Hn.current||z.current===void 0)return!1;let Yt=!1;switch(Me.activationBehaviorOverride??rt){case"double-click":case"second-click":{if(((Oe=(Ze=D==null?void 0:D.previousSelection)==null?void 0:Ze.current)==null?void 0:Oe.cell)===void 0)break;let[Lt,hr]=z.current.cell,[xr,nr]=D.previousSelection.current.cell;Yt=N===Lt&&N===xr&&W===hr&&W===nr&&(oe.isDoubleClick===!0||rt==="second-click");break}case"single-click":Yt=!0;break}if(Yt)return O==null||O([N-B,W]),Tn(oe.bounds,!1),!0}return!1},U=g.location[0]-B;if(g.isTouch){let oe=Xt.current,ke=Pa.current;if(oe.x!==ke.x||oe.y!==ke.y)return;if(g.isLongTouch===!0){if(g.kind==="cell"&&Nn((we=z.current)==null?void 0:we.cell,g.location)){J==null||J([U,g.location[1]],{...g,preventDefault:K});return}else if(g.kind==="header"&&z.columns.hasIndex(N)){Z==null||Z(U,{...g,preventDefault:K});return}else if(g.kind==="group-header"){if(U<0)return;V==null||V(U,{...g,preventDefault:K});return}}g.kind==="cell"?q(g)||lo(g):g.kind==="group-header"?b==null||b(U,{...g,preventDefault:K}):(g.kind==="header"&&(x==null||x(U,{...g,preventDefault:K})),lo(g));return}if(g.kind==="header"){if(U<0)return;g.isEdge?g.isDoubleClick===!0&&Bo(N):g.button===0&&N===Y&&W===$&&(x==null||x(U,{...g,preventDefault:K}))}if(g.kind==="group-header"){if(U<0)return;g.button===0&&N===Y&&W===$&&(b==null||b(U,{...g,preventDefault:K}),Hn.current||Ha(g))}g.kind==="cell"&&(g.button===0||g.button===1)&&q(g),dn.current=void 0},[s,z,B,cn,Dn,he,I,qt,Ht,rt,io,tr,O,Tn,J,Z,V,lo,b,x,Bo,Ha]),Qh=d.useCallback(g=>{let H={...g,location:[g.location[0]-B,g.location[1]]};We==null||We(H),s!==void 0&&g.buttons===0&&(c(void 0),Ti(void 0),zi(void 0),ao.current=!1),zi(D=>{var N;return ao.current?[g.scrollEdge[0],0]:g.scrollEdge[0]===(D==null?void 0:D[0])&&g.scrollEdge[1]===D[1]?D:s===void 0||(((N=rr.current)==null?void 0:N.location[0])??0)<B?void 0:g.scrollEdge})},[s,We,B]),e0=d.useCallback((g,H)=>{Xe==null||Xe(g-B,H)},[Xe,B]),t0=d.useCallback((g,H)=>{ft==null||ft(g-B,H)},[ft,B]),br=(Ba=z==null?void 0:z.current)==null?void 0:Ba.cell,r0=d.useCallback((g,H,D,N,W,Y)=>{Ao.current=!1;let $=br;$!==void 0&&($=[$[0]-B,$[1]]);let K=Ce===0?void 0:{x:0,y:g.y,width:Ce,height:g.height},q=[];K!==void 0&&q.push(K),yt>0&&(q.push({x:g.x-B,y:Te-yt,width:g.width,height:yt}),Ce>0&&q.push({x:0,y:Te-yt,width:Ce,height:yt}));let U={x:g.x-B,y:g.y,width:g.width,height:bt&&g.y+g.height>=Te?g.height-1:g.height,tx:W,ty:Y,extras:{selected:$,freezeRegion:K,freezeRegions:q}};Xt.current=U,Ra(U),an([H,D,N]),jt==null||jt(U,U.tx,U.ty,U.extras)},[br,B,bt,Te,Ce,yt,Ra,jt]),n0=Gr(De,d.useCallback((g,H)=>{De==null||De(g-B,H-B),Qe!=="none"&&He(nt.fromSingleSelection(H),void 0,!0)},[Qe,De,B,He])),Ai=d.useRef(!1),o0=d.useCallback(g=>{if(g.location[0]===0&&B>0){g.preventDefault();return}Ye==null||Ye({...g,location:[g.location[0]-B,g.location[1]]}),g.defaultPrevented()||(Ai.current=!0),c(void 0)},[Ye,B]),i0=d.useCallback(()=>{Ai.current=!1},[]),Aa=Ae==null?void 0:Ae.selectionBehavior,$o=d.useCallback(g=>{if(Aa!=="block-spanning")return;let{isGroupHeader:H,path:D,groupRows:N}=un(g);if(H)return[g,g];let W=D[D.length-1];return[g-W,g+N-W-1]},[un,Aa]),Li=d.useRef(),Fi=d.useCallback(g=>{var H,D,N;if(!Zl(g,Li.current)&&(Li.current=g,!(((H=rr==null?void 0:rr.current)==null?void 0:H.button)!==void 0&&rr.current.button>=1))){if(g.buttons!==0&&s!==void 0&&((D=rr.current)==null?void 0:D.location[0])===0&&g.location[0]===0&&B===1&&le==="multi"&&s.previousSelection&&!s.previousSelection.rows.hasIndex(rr.current.location[1])&&z.rows.hasIndex(rr.current.location[1])){let W=Math.min(rr.current.location[1],g.location[1]),Y=Math.max(rr.current.location[1],g.location[1])+1;mt(nt.fromSingleSelection([W,Y]),void 0,!1)}if(g.buttons!==0&&s!==void 0&&z.current!==void 0&&!Ai.current&&!ao.current&&(vt==="rect"||vt==="multi-rect")){let[W,Y]=z.current.cell,[$,K]=g.location;if(K<0&&(K=Xt.current.y),s.fillHandle===!0&&((N=s.previousSelection)==null?void 0:N.current)!==void 0){let q=s.previousSelection.current.range;K=Math.min(K,bt?Te-1:Te),Ti(zc(q,$,K,mr))}else{if(bt&&Y===Te)return;if(bt&&K===Te)if(g.kind==="out-of-bounds")K--;else return;$=Math.max($,B);let q=$o(Y);K=q===void 0?K:(0,Zr.default)(K,q[0],q[1]);let U=$-W,ge=K-Y,we={x:U>=0?W:$,y:ge>=0?Y:K,width:Math.abs(U)+1,height:Math.abs(ge)+1};pt({...z.current,range:we},!0,!1,"drag")}}zt==null||zt({...g,location:[g.location[0]-B,g.location[1]]})}},[s,B,le,z,vt,zt,mt,bt,Te,mr,$o,pt]);Wd(Zh,ht,d.useCallback(()=>{var $,K;let g=Li.current;if(g===void 0)return;let[H,D]=g.scrollEdge,[N,W]=g.location,Y=Xt.current;H===-1?N=((K=($=Y.extras)==null?void 0:$.freezeRegion)==null?void 0:K.x)??Y.x:H===1&&(N=Y.x+Y.width),D===-1?W=Math.max(0,Y.y):D===1&&(W=Math.min(Te-1,Y.y+Y.height)),N=(0,Zr.default)(N,0,ot.length-1),W=(0,Zr.default)(W,0,Te-1),Fi({...g,location:[N,W]})},[ot.length,Fi,Te]));let dr=d.useCallback(g=>{if(z.current===void 0)return;let[H,D]=g,[N,W]=z.current.cell,Y=z.current.range,$=Y.x,K=Y.x+Y.width,q=Y.y,U=Y.y+Y.height,[ge,we]=$o(W)??[0,Te-1],oe=we+1;if(D!==0)switch(D){case 2:U=oe,q=W,It(0,U,"vertical");break;case-2:q=ge,U=W+1,It(0,q,"vertical");break;case 1:q<W?(q++,It(0,q,"vertical")):(U=Math.min(oe,U+1),It(0,U,"vertical"));break;case-1:U>W+1?(U--,It(0,U,"vertical")):(q=Math.max(ge,q-1),It(0,q,"vertical"));break;default:qo(D)}if(H!==0)if(H===2)K=ot.length,$=N,It(K-1-B,0,"horizontal");else if(H===-2)$=B,K=N+1,It($-B,0,"horizontal");else{let ke=[];if(ve!==void 0){let Le=ve({x:$,y:q,width:K-$-B,height:U-q},se.current.signal);typeof Le=="object"&&(ke=Qd(Le))}if(H===1){let Le=!1;if($<N){if(ke.length>0){let Ze=(0,bn.default)($+1,N+1).find(Oe=>!ke.includes(Oe-B));Ze!==void 0&&($=Ze,Le=!0)}else $++,Le=!0;Le&&It($,0,"horizontal")}Le||(K=Math.min(ot.length,K+1),It(K-1-B,0,"horizontal"))}else if(H===-1){let Le=!1;if(K>N+1){if(ke.length>0){let Ze=(0,bn.default)(K-1,N,-1).find(Oe=>!ke.includes(Oe-B));Ze!==void 0&&(K=Ze,Le=!0)}else K--,Le=!0;Le&&It(K-B,0,"horizontal")}Le||($=Math.max(B,$-1),It($-B,0,"horizontal"))}else qo(H)}pt({cell:z.current.cell,range:{x:$,y:q,width:K-$,height:U-q}},!0,!1,"keyboard-select")},[ve,$o,z,ot.length,B,Te,It,pt]),ji=d.useRef(Zn);ji.current=Zn;let Br=d.useCallback((g,H,D,N)=>{let W=Wt-(D?0:1);g=(0,Zr.default)(g,B,Dt.length-1+B),H=(0,Zr.default)(H,0,W);let Y=br==null?void 0:br[0],$=br==null?void 0:br[1];if(g===Y&&H===$)return!1;if(N&&z.current!==void 0){let K=[...z.current.rangeStack];(z.current.range.width>1||z.current.range.height>1)&&K.push(z.current.range),he({...z,current:{cell:[g,H],range:{x:g,y:H,width:1,height:1},rangeStack:K}},!0)}else pt({cell:[g,H],range:{x:g,y:H,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===g&&u.current[1]===H&&(u.current=void 0),ji.current&&It(g-B,H),!0},[Wt,B,Dt.length,br,z,It,he,pt]),l0=d.useCallback((g,H)=>{(o==null?void 0:o.cell)!==void 0&&g!==void 0&&go(g)&&(tr([{location:o.cell,value:g}]),window.requestAnimationFrame(()=>{var W;(W=Kt.current)==null||W.damage([{cell:o.cell}])})),Bt(!0),i(void 0);let[D,N]=H;if(z.current!==void 0&&(D!==0||N!==0)){let W=z.current.cell[1]===Wt-1&&g!==void 0;Br((0,Zr.default)(z.current.cell[0]+D,0,ot.length-1),(0,Zr.default)(z.current.cell[1]+N,0,Wt-1),W,!1)}A==null||A(g,H)},[o==null?void 0:o.cell,Bt,z,A,tr,Wt,Br,ot.length]),a0=d.useMemo(()=>`gdg-overlay-${Jd++}`,[]),hn=d.useCallback(g=>{var D,N,W,Y,$;Bt();let H=[];for(let K=g.x;K<g.x+g.width;K++)for(let q=g.y;q<g.y+g.height;q++){let U=k([K-B,q]);if(!U.allowOverlay&&U.kind!==pe.Boolean)continue;let ge;if(U.kind===pe.Custom){let we=Ht(U),oe=(D=we==null?void 0:we.provideEditor)==null?void 0:D.call(we,U);(we==null?void 0:we.onDelete)===void 0?rf(oe)&&(ge=(N=oe==null?void 0:oe.deletedValue)==null?void 0:N.call(oe,U)):ge=we.onDelete(U)}else(go(U)&&U.allowOverlay||U.kind===pe.Boolean)&&(ge=(Y=(W=Ht(U))==null?void 0:W.onDelete)==null?void 0:Y.call(W,U));ge!==void 0&&!Fn(ge)&&go(ge)&&H.push({location:[K,q],value:ge})}tr(H),($=Kt.current)==null||$.damage(H.map(K=>({cell:K.location})))},[Bt,k,Ht,tr,B]),so=o!==void 0,La=d.useCallback(g=>{var Le,Ze;let H=()=>{g.stopPropagation(),g.preventDefault()},D={didMatch:!1},{bounds:N}=g,W=z.columns,Y=z.rows,$=yr;if(!so&&Be($.clear,g,D))he(Ro,!1),kt==null||kt();else if(!so&&Be($.selectAll,g,D))he({columns:nt.empty(),rows:nt.empty(),current:{cell:((Le=z.current)==null?void 0:Le.cell)??[B,0],range:{x:B,y:0,width:M.length,height:Te},rangeStack:[]}},!1);else if(Be($.search,g,D))(Ze=l==null?void 0:l.current)==null||Ze.focus({preventScroll:!0}),re(!0);else if(Be($.delete,g,D)){let Oe=(lt==null?void 0:lt(z))??!0;if(Oe!==!1){let Me=Oe===!0?z:Oe;if(Me.current!==void 0){hn(Me.current.range);for(let Je of Me.current.rangeStack)hn(Je)}for(let Je of Me.rows)hn({x:B,y:Je,width:M.length,height:1});for(let Je of Me.columns)hn({x:Je,y:0,width:1,height:Te})}}if(D.didMatch)return H(),!0;if(z.current===void 0)return!1;let[K,q]=z.current.cell,[,U]=z.current.cell,ge=!1,we=!1;if(Be($.scrollToSelectedCell,g,D)?Yo.current(K-B,q):Qe!=="none"&&Be($.selectColumn,g,D)?W.hasIndex(K)?He(W.remove(K),void 0,!0):Qe==="single"?He(nt.fromSingleSelection(K),void 0,!0):He(void 0,K,!0):le!=="none"&&Be($.selectRow,g,D)?Y.hasIndex(q)?mt(Y.remove(q),void 0,!0):le==="single"?mt(nt.fromSingleSelection(q),void 0,!0):mt(void 0,q,!0):!so&&N!==void 0&&Be($.activateCell,g,D)?q===Te&&bt?window.setTimeout(()=>{On(Wo(K)??K)},0):(O==null||O([K-B,q]),Tn(N,!0)):z.current.range.height>1&&Be($.downFill,g,D)?za():z.current.range.width>1&&Be($.rightFill,g,D)?Da():Be($.goToNextPage,g,D)?q+=Math.max(1,Xt.current.height-4):Be($.goToPreviousPage,g,D)?q-=Math.max(1,Xt.current.height-4):Be($.goToFirstCell,g,D)?(i(void 0),q=0,K=0):Be($.goToLastCell,g,D)?(i(void 0),q=2**53-1,K=2**53-1):Be($.selectToFirstCell,g,D)?(i(void 0),dr([-2,-2])):Be($.selectToLastCell,g,D)?(i(void 0),dr([2,2])):so?(Be($.closeOverlay,g,D)&&i(void 0),Be($.acceptOverlayDown,g,D)&&(i(void 0),q++),Be($.acceptOverlayUp,g,D)&&(i(void 0),q--),Be($.acceptOverlayLeft,g,D)&&(i(void 0),K--),Be($.acceptOverlayRight,g,D)&&(i(void 0),K++)):(Be($.goDownCell,g,D)?q+=1:Be($.goUpCell,g,D)?--q:Be($.goRightCell,g,D)?K+=1:Be($.goLeftCell,g,D)?--K:Be($.goDownCellRetainSelection,g,D)?(q+=1,ge=!0):Be($.goUpCellRetainSelection,g,D)?(--q,ge=!0):Be($.goRightCellRetainSelection,g,D)?(K+=1,ge=!0):Be($.goLeftCellRetainSelection,g,D)?(--K,ge=!0):Be($.goToLastRow,g,D)?q=Te-1:Be($.goToFirstRow,g,D)?q=-(2**53-1):Be($.goToLastColumn,g,D)?K=2**53-1:Be($.goToFirstColumn,g,D)?K=-(2**53-1):(vt==="rect"||vt==="multi-rect")&&(Be($.selectGrowDown,g,D)?dr([0,1]):Be($.selectGrowUp,g,D)?dr([0,-1]):Be($.selectGrowRight,g,D)?dr([1,0]):Be($.selectGrowLeft,g,D)?dr([-1,0]):Be($.selectToLastRow,g,D)?dr([0,2]):Be($.selectToFirstRow,g,D)?dr([0,-2]):Be($.selectToLastColumn,g,D)?dr([2,0]):Be($.selectToFirstColumn,g,D)&&dr([-2,0])),we=D.didMatch),ur!==void 0&&ur!=="normal"&&q!==U){let Oe=ur==="skip-up"||ur==="skip"||ur==="block",Me=ur==="skip-down"||ur==="skip"||ur==="block",Je=q<U;if(Je&&Oe){for(;q>=0&&un(q).isGroupHeader;)q--;q<0&&(q=U)}else if(!Je&&Me){for(;q<Te&&un(q).isGroupHeader;)q++;q>=Te&&(q=U)}}let oe=Br(K,q,!1,ge),ke=D.didMatch;return ke&&(oe||!we||Jr)&&H(),ke},[ur,so,z,yr,Qe,le,vt,B,un,Te,Br,he,kt,M.length,lt,Jr,hn,He,mt,bt,Wo,On,O,Tn,za,Da,dr]),co=d.useCallback(g=>{let H=!1;if(ie!==void 0&&ie({...g,cancel:()=>{H=!0}}),H||La(g)||z.current===void 0)return;let[D,N]=z.current.cell,W=Xt.current;if(Pe&&!g.metaKey&&!g.ctrlKey&&z.current!==void 0&&g.key.length===1&&/[ -~]/g.test(g.key)&&g.bounds!==void 0&&po(k([D-B,Math.max(0,Math.min(N,Te-1))]))){if((!bt||N!==Te)&&(W.y>N||N>W.y+W.height||W.x>D||D>W.x+W.width))return;Tn(g.bounds,!0,g.key),g.stopPropagation(),g.preventDefault()}},[Pe,ie,La,z,k,B,Te,bt,Tn]),s0=d.useCallback((g,H)=>{let D=g.location[0]-B;if(g.kind==="header"&&(Z==null||Z(D,{...g,preventDefault:H})),g.kind==="group-header"){if(D<0)return;V==null||V(D,{...g,preventDefault:H})}if(g.kind==="cell"){let[N,W]=g.location;J==null||J([D,W],{...g,preventDefault:H}),Vs(z,g.location)||Br(N,W,!1,!1)}},[z,J,V,Z,B,Br]),_i=d.useCallback(async g=>{var $,K,q;if(!yr.paste)return;function H(U,ge,we,oe){var Le,Ze;let ke=typeof we=="object"?(we==null?void 0:we.join(`
`))??"":(we==null?void 0:we.toString())??"";if(!Fn(U)&&po(U)&&U.readonly!==!0){let Oe=F==null?void 0:F(ke,U);if(Oe!==void 0&&go(Oe))return{location:ge,value:Oe};let Me=Ht(U);if(Me===void 0)return;if(Me.kind===pe.Custom){Zt(U.kind===pe.Custom);let Je=(Le=Me.onPaste)==null?void 0:Le.call(Me,ke,U.data);return Je===void 0?void 0:{location:ge,value:{...U,data:Je}}}else{let Je=(Ze=Me.onPaste)==null?void 0:Ze.call(Me,ke,U,{formatted:oe,formattedString:typeof oe=="string"?oe:oe==null?void 0:oe.join(`
`),rawValue:we});return Je===void 0?void 0:(Zt(Je.kind===U.kind),{location:ge,value:Je})}}}let D=z.columns,N=z.rows,W=(($=ht.current)==null?void 0:$.contains(document.activeElement))===!0||((K=a.current)==null?void 0:K.contains(document.activeElement))===!0,Y;if(z.current===void 0?D.length===1?Y=[D.first()??0,0]:N.length===1&&(Y=[B,N.first()??0]):Y=[z.current.range.x,z.current.range.y],W&&Y!==void 0){let U,ge,we="text/plain",oe="text/html";if(navigator.clipboard.read!==void 0){let Oe=await navigator.clipboard.read();for(let Me of Oe){if(Me.types.includes(oe)){let Je=na(await(await Me.getType(oe)).text());if(Je!==void 0){U=Je;break}}Me.types.includes(we)&&(ge=await(await Me.getType(we)).text())}}else if(navigator.clipboard.readText!==void 0)ge=await navigator.clipboard.readText();else if(g!==void 0&&(g==null?void 0:g.clipboardData)!==null)g.clipboardData.types.includes(oe)&&(U=na(g.clipboardData.getData(oe))),U===void 0&&g.clipboardData.types.includes(we)&&(ge=g.clipboardData.getData(we));else return;let[ke,Le]=Y,Ze=[];do{if(Ue===void 0){let Oe=qt(Y),Me=ge??(U==null?void 0:U.map(Yt=>Yt.map(Lt=>Lt.rawValue).join("	")).join("	"))??"",Je=H(Oe,Y,Me,void 0);Je!==void 0&&Ze.push(Je);break}if(U===void 0){if(ge===void 0)return;U=Dd(ge)}if(Ue===!1||typeof Ue=="function"&&(Ue==null?void 0:Ue([Y[0]-B,Y[1]],U.map(Oe=>Oe.map(Me=>{var Je;return((Je=Me.rawValue)==null?void 0:Je.toString())??""}))))!==!0)return;for(let[Oe,Me]of U.entries()){if(Oe+Le>=Te)break;for(let[Je,Yt]of Me.entries()){let Lt=[Je+ke,Oe+Le],[hr,xr]=Lt;if(hr>=ot.length||xr>=Wt)continue;let nr=H(qt(Lt),Lt,Yt.rawValue,Yt.formatted);nr!==void 0&&Ze.push(nr)}}}while(!1);tr(Ze),(q=Kt.current)==null||q.damage(Ze.map(Oe=>({cell:Oe.location})))}},[F,Ht,qt,z,yr.paste,ht,ot.length,tr,Wt,Ue,B,Te]);Ft("paste",_i,f,!1,!0);let uo=d.useCallback(async(g,H)=>{var $,K;if(!yr.copy)return;let D=H===!0||(($=ht.current)==null?void 0:$.contains(document.activeElement))===!0||((K=a.current)==null?void 0:K.contains(document.activeElement))===!0,N=z.columns,W=z.rows,Y=(q,U)=>{zd(me?[U.map(ge=>({kind:pe.Text,data:M[ge].title,displayData:M[ge].title,allowOverlay:!1})),...q]:q,U,g)};if(D&&ve!==void 0){if(z.current!==void 0){let q=ve(z.current.range,se.current.signal);typeof q!="object"&&(q=await q()),Y(q,(0,bn.default)(z.current.range.x-B,z.current.range.x+z.current.range.width-B))}else if(W!==void 0&&W.length>0){let q=[...W].map(U=>{let ge=ve({x:B,y:U,width:M.length,height:1},se.current.signal);return typeof ge=="object"?ge[0]:ge().then(we=>we[0])});q.some(U=>U instanceof Promise)?Y(await Promise.all(q),(0,bn.default)(M.length)):Y(q,(0,bn.default)(M.length))}else if(N.length>0){let q=[],U=[];for(let ge of N){let we=ve({x:ge,y:0,width:1,height:Te},se.current.signal);typeof we!="object"&&(we=await we()),q.push(we),U.push(ge-B)}q.length===1?Y(q[0],U):Y(q.reduce((ge,we)=>ge.map((oe,ke)=>[...oe,...we[ke]])),U)}}},[M,ve,z,yr.copy,B,ht,Te,me]);Ft("copy",uo,f,!1,!1),Ft("cut",d.useCallback(async g=>{var H,D;if(yr.cut&&(((H=ht.current)==null?void 0:H.contains(document.activeElement))===!0||((D=a.current)==null?void 0:D.contains(document.activeElement))===!0)&&(await uo(g),z.current!==void 0)){let N={current:{cell:z.current.cell,range:z.current.range,rangeStack:[]},rows:nt.empty(),columns:nt.empty()},W=lt==null?void 0:lt(N);if(W===!1||(N=W===!0?N:W,N.current===void 0))return;hn(N.current.range)}},[hn,z,yr.cut,uo,ht,lt]),f,!1,!1);let c0=d.useCallback((g,H)=>{if(ue!==void 0){B!==0&&(g=g.map(W=>[W[0]-B,W[1]])),ue(g,H);return}if(g.length===0||H===-1)return;let[D,N]=g[H];u.current!==void 0&&u.current[0]===D&&u.current[1]===N||(u.current=[D,N],Br(D,N,!1,!1))},[ue,B,Br]),[Vo,Ko]=(($a=wt==null?void 0:wt.current)==null?void 0:$a.cell)??[],Yo=d.useRef(It);Yo.current=It,d.useLayoutEffect(()=>{var g,H,D,N;ji.current&&!Ao.current&&Vo!==void 0&&Ko!==void 0&&(Vo!==((H=(g=ct.current)==null?void 0:g.current)==null?void 0:H.cell[0])||Ko!==((N=(D=ct.current)==null?void 0:D.current)==null?void 0:N.cell[1]))&&Yo.current(Vo,Ko),Ao.current=!1},[Vo,Ko]);let Fa=z.current!==void 0&&(z.current.cell[0]>=ot.length||z.current.cell[1]>=Wt);d.useLayoutEffect(()=>{Fa&&he(Ro,!1)},[Fa,he]);let u0=d.useMemo(()=>bt===!0&&(Ee==null?void 0:Ee.tint)===!0?nt.fromSingleSelection(Wt-1):nt.empty(),[Wt,bt,Ee==null?void 0:Ee.tint]),d0=d.useCallback(g=>typeof Ve=="boolean"?Ve:(Ve==null?void 0:Ve(g-B))??!0,[B,Ve]),h0=d.useMemo(()=>{if(Hi===void 0||a.current===null)return null;let{bounds:g,group:H}=Hi,D=a.current.getBoundingClientRect();return d.createElement(Cd,{bounds:g,group:H,canvasBounds:D,onClose:()=>Di(void 0),onFinish:N=>{Di(void 0),ae==null||ae(H,N)}})},[ae,Hi]),f0=Math.min(ot.length,Ce+(er?1:0));d.useImperativeHandle(t,()=>({appendRow:(g,H)=>On(g+B,H),updateCells:g=>{var H;return B!==0&&(g=g.map(D=>({cell:[D.cell[0]+B,D.cell[1]]}))),(H=Kt.current)==null?void 0:H.damage(g)},getBounds:(g,H)=>{var D;if(!((a==null?void 0:a.current)===null||(ht==null?void 0:ht.current)===null)){if(g===void 0&&H===void 0){let N=a.current.getBoundingClientRect(),W=N.width/ht.current.clientWidth;return{x:N.x-ht.current.scrollLeft*W,y:N.y-ht.current.scrollTop*W,width:ht.current.scrollWidth*W,height:ht.current.scrollHeight*W}}return(D=Kt.current)==null?void 0:D.getBounds((g??0)+B,H)}},focus:()=>{var g;return(g=Kt.current)==null?void 0:g.focus()},emit:async g=>{switch(g){case"delete":co({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":co({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":co({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await uo(void 0,!0);break;case"paste":await _i();break}},scrollTo:It,remeasureColumns:g=>{for(let H of g)Bo(H+B)}}),[On,Bo,ht,uo,co,_i,B,It]);let[ja,_a]=br??[],g0=d.useCallback(g=>{let[H,D]=g;if(D===-1){Qe!=="none"&&(He(nt.fromSingleSelection(H),void 0,!1),Bt());return}ja===H&&_a===D||(pt({cell:g,range:{x:H,y:D,width:1,height:1}},!0,!1,"keyboard-nav"),It(H,D))},[Qe,Bt,It,ja,_a,pt,He]),[p0,m0]=d.useState(!1),Na=d.useRef((0,qd.default)(g=>{m0(g)},5)),v0=d.useCallback(()=>{Na.current(!0),z.current===void 0&&z.columns.length===0&&z.rows.length===0&&s===void 0&&pt({cell:[B,Lo],range:{x:B,y:Lo,width:1,height:1}},!0,!1,"keyboard-select")},[Lo,z,s,B,pt]),w0=d.useCallback(()=>{Na.current(!1)},[]),[y0,b0]=d.useMemo(()=>{let g,H=(Ct==null?void 0:Ct.scrollbarWidthOverride)??oi(),D=Te+(bt?1:0);if(typeof wr=="number")g=oo+D*wr;else{let W=0,Y=Math.min(D,10);for(let $=0;$<Y;$++)W+=wr($);W=Math.floor(W/Y),g=oo+D*W}g+=H;let N=ot.reduce((W,Y)=>Y.width+W,0)+H;return[`${Math.min(1e5,N)}px`,`${Math.min(1e5,g)}px`]},[ot,Ct==null?void 0:Ct.scrollbarWidthOverride,wr,Te,bt,oo]),x0=d.useMemo(()=>Q0(at),[at]);return d.createElement(ef.Provider,{value:at},d.createElement(jd,{style:x0,className:_,inWidth:v??y0,inHeight:S??b0},d.createElement(yd,{fillHandle:Et,drawFocusRing:Jn,experimental:Ct,fixedShadowX:Tt,fixedShadowY:At,getRowThemeOverride:ar,headerIcons:Mr,imageWindowLoader:Eo,initialSize:Fr,isDraggable:Rr,onDragLeave:Er,onRowMoved:vr,overscrollX:ro,overscrollY:no,preventDiagonalScrolling:Cn,rightElement:Sn,rightElementProps:kn,smoothScrollX:Qr,smoothScrollY:jr,className:_,enableGroups:Ii,onCanvasFocused:v0,onCanvasBlur:w0,canvasRef:a,onContextMenu:s0,theme:at,cellXOffset:Uh,cellYOffset:Lo,accessibilityHeight:sn.height,onDragEnd:i0,columns:ot,nonGrowWidth:Sa,drawHeader:Ot,onColumnProposeMove:w,drawCell:Ut,disabledRows:u0,freezeColumns:f0,lockColumns:B,firstColAccessible:B===0,getCellContent:qt,minColumnWidth:Or,maxColumnWidth:rn,searchInputRef:l,showSearch:xe,onSearchClose:fe,highlightRegions:Xh,getCellsForSelection:ve,getGroupDetails:Oi,headerHeight:nn,isFocused:p0,groupHeaderHeight:Ii?to:0,freezeTrailingRows:yt+(bt&&(Ee==null?void 0:Ee.sticky)===!0?1:0),hasAppendRow:bt,onColumnResize:je,onColumnResizeEnd:Ge,onColumnResizeStart:it,onCellFocused:g0,onColumnMoved:n0,onDragStart:o0,onHeaderMenuClick:e0,onHeaderIndicatorClick:t0,onItemHovered:Fi,isFilling:(s==null?void 0:s.fillHandle)===!0,onMouseMove:Qh,onKeyDown:co,onKeyUp:te,onMouseDown:qh,onMouseUp:Jh,onDragOverCell:xt,onDrop:Mt,onSearchResultsChanged:c0,onVisibleRegionChanged:r0,clientSize:_t,rowHeight:wr,searchResults:G,searchValue:Q,onSearchValueChange:ye,rows:Wt,scrollRef:ht,selection:z,translateX:sn.tx,translateY:sn.ty,verticalBorder:d0,gridRef:Kt,getCellRenderer:Ht,resizeIndicator:Ho}),h0,o!==void 0&&d.createElement(d.Suspense,{fallback:null},d.createElement(Zd,{...o,validateCell:Re,bloom:L,id:a0,getCellRenderer:Ht,className:(Ct==null?void 0:Ct.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:ir,imageEditorOverride:p,onFinishEditing:l0,markdownDivCreateNode:h,isOutsideClick:Ri,customEventTarget:Ct==null?void 0:Ct.eventTarget}))))});var da=20;function ha(e){let{cell:t,posX:r,posY:n,bounds:o,theme:i}=e,{width:l,height:a,x:s,y:c}=o,u=t.maxSize??da,f=Math.floor(o.y+a/2),p=rl(u,a,i.cellVerticalPadding),m=el(tl(t.contentAlign??"center",s,l,i.cellHorizontalPadding,p),f,p),h=nl(s+r,c+n,m);return Ki(t)&&h}const th={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:pe.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>rh(e,e.cell.data,Ki(e.cell),e.cell.maxSize??da,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{ha(e)&&e.preventDefault()},onClick:e=>{if(ha(e))return{...e.cell,data:ia(e.cell.data)}},onPaste:(e,t)=>{let r=null;return e.toLowerCase()==="true"?r=!0:e.toLowerCase()==="false"?r=!1:e.toLowerCase()==="indeterminate"&&(r=void 0),r===t.data?void 0:{...t,data:r}}};function rh(e,t,r,n,o){if(!r&&t===null)return;let{ctx:i,hoverAmount:l,theme:a,rect:s,highlighted:c,hoverX:u,hoverY:f,cell:{contentAlign:p}}=e,{x:m,y:h,width:v,height:S}=s,M=!1;if(o>0){let y=r?1-o+o*l:.4;if(t===null&&(y*=l),y===0)return;y<1&&(M=!0,i.globalAlpha=y)}mi(i,a,t,m,h,v,S,c,u,f,n,p),M&&(i.globalAlpha=1)}const nh=Jt("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1});var oh=e=>{let{bubbles:t}=e;return d.createElement(nh,null,t.map((r,n)=>d.createElement("div",{key:n,className:"boe-bubble"},r)),d.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};const ih={getAccessibilityString:e=>ol(e.data),kind:pe.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,r)=>t.data.reduce((n,o)=>e.measureText(o).width+n+20,0)+2*r.cellHorizontalPadding-4,draw:e=>ah(e,e.cell.data),provideEditor:()=>e=>{let{value:t}=e;return d.createElement(oh,{bubbles:t.data})},onPaste:()=>{}};var lh=4;function ah(e,t){let{rect:r,theme:n,ctx:o,highlighted:i}=e,{x:l,y:a,width:s,height:c}=r,u=lh,f=l+n.cellHorizontalPadding,p=[];for(let m of t){if(f>l+s)break;let h=wn(m,o,n.baseFontFull).width;p.push({x:f,width:h}),f+=h+16+u}o.beginPath();for(let m of p)gr(o,m.x,a+(c-20)/2,m.width+16,20,n.roundingRadius??20/2);o.fillStyle=i?n.bgBubbleSelected:n.bgBubble,o.fill();for(let[m,h]of p.entries())o.beginPath(),o.fillStyle=n.textBubble,o.fillText(t[m],h.x+8,a+c/2+Hr(o,n))}var sh=Jt("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),ch=e=>{let{drilldowns:t}=e;return d.createElement(sh,null,t.map((r,n)=>d.createElement("div",{key:n,className:"doe-bubble"},r.img!==void 0&&d.createElement("img",{src:r.img}),d.createElement("div",null,r.text))))};const uh={getAccessibilityString:e=>ol(e.data.map(t=>t.text)),kind:pe.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,r)=>t.data.reduce((n,o)=>e.measureText(o.text).width+n+20+(o.img===void 0?0:18),0)+2*r.cellHorizontalPadding-4,draw:e=>fh(e,e.cell.data),provideEditor:()=>e=>{let{value:t}=e;return d.createElement(ch,{drilldowns:t.data})},onPaste:()=>{}};var dh=4,Ci={};function hh(e,t,r,n){let o=Math.ceil(window.devicePixelRatio),i=r-10,l=r*o,a=n+5,s=n*3,c=(s+10)*o,u=`${e},${t},${o},${r}`;if(Ci[u]!==void 0)return{el:Ci[u],height:l,width:c,middleWidth:4*o,sideWidth:a*o,padding:5*o,dpr:o};let f=document.createElement("canvas"),p=f.getContext("2d");return p===null?null:(f.width=c,f.height=l,p.scale(o,o),Ci[u]=f,p.beginPath(),gr(p,5,5,s,i,n),p.shadowColor="rgba(24, 25, 34, 0.4)",p.shadowBlur=1,p.fillStyle=e,p.fill(),p.shadowColor="rgba(24, 25, 34, 0.3)",p.shadowOffsetY=1,p.shadowBlur=5,p.fillStyle=e,p.fill(),p.shadowOffsetY=0,p.shadowBlur=0,p.shadowBlur=0,p.beginPath(),gr(p,5.5,5.5,s,i,n),p.strokeStyle=t,p.lineWidth=1,p.stroke(),{el:f,height:l,width:c,sideWidth:a*o,middleWidth:n*o,padding:5*o,dpr:o})}function fh(e,t){let{rect:r,theme:n,ctx:o,imageLoader:i,col:l,row:a}=e,{x:s,width:c}=r,u=n.baseFontFull,f=pl(o,u),p=Math.min(r.height,Math.max(16,Math.ceil(f*n.lineHeight)*2)),m=Math.floor(r.y+(r.height-p)/2),h=p-10,v=dh,S=s+n.cellHorizontalPadding,M=n.roundingRadius??6,y=hh(n.bgCell,n.drilldownBorder,p,M),k=[];for(let I of t){if(S>s+c)break;let O=wn(I.text,o,u).width,E=0;I.img!==void 0&&i.loadOrGetImage(I.img,l,a)!==void 0&&(E=h-8+4);let A=O+E+16;k.push({x:S,width:A}),S+=A+v}if(y!==null){let{el:I,height:O,middleWidth:E,sideWidth:A,width:F,dpr:C,padding:R}=y,L=A/C,x=R/C;for(let w of k){let T=Math.floor(w.x),P=Math.floor(w.width),b=P-(L-x)*2;o.imageSmoothingEnabled=!1,o.drawImage(I,0,0,A,O,T-x,m,L,p),b>0&&o.drawImage(I,A,0,E,O,T+(L-x),m,b,p),o.drawImage(I,F-A,0,A,O,T+P-(L-x),m,L,p),o.imageSmoothingEnabled=!0}}o.beginPath();for(let[I,O]of k.entries()){let E=t[I],A=O.x+8;if(E.img!==void 0){let F=i.loadOrGetImage(E.img,l,a);if(F!==void 0){let C=h-8,R=0,L=0,x=F.width,w=F.height;x>w?(R+=(x-w)/2,x=w):w>x&&(L+=(w-x)/2,w=x),o.beginPath(),gr(o,A,m+p/2-C/2,C,C,n.roundingRadius??3),o.save(),o.clip(),o.drawImage(F,R,L,x,w,A,m+p/2-C/2,C,C),o.restore(),A+=C+4}}o.beginPath(),o.fillStyle=n.textBubble,o.fillText(E.text,A,m+p/2+Hr(o,n))}}const gh={getAccessibilityString:e=>e.data.join(", "),kind:pe.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>ph(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{let{value:t,onFinishedEditing:r,imageEditorOverride:n}=e,o=n??Hs;return d.createElement(o,{urls:t.data,canWrite:t.readonly!==!0,onCancel:r,onChange:i=>{r({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();let r=e.split(",").map(n=>{try{return new URL(n),n}catch{return}}).filter(n=>n!==void 0);if(!(r.length===t.data.length&&r.every((n,o)=>n===t.data[o])))return{...t,data:r}}};var Si=4;function ph(e,t,r,n){let{rect:o,col:i,row:l,theme:a,ctx:s,imageLoader:c}=e,{x:u,y:f,height:p,width:m}=o,h=p-a.cellVerticalPadding*2,v=[],S=0;for(let y=0;y<t.length;y++){let k=t[y];if(k.length===0)continue;let I=c.loadOrGetImage(k,i,l);if(I!==void 0){v[y]=I;let O=I.width*(h/I.height);S+=O+Si}}if(S===0)return;S-=Si;let M=u+a.cellHorizontalPadding;n==="right"?M=Math.floor(u+m-a.cellHorizontalPadding-S):n==="center"&&(M=Math.floor(u+m/2-S/2));for(let y of v){if(y===void 0)continue;let k=y.width*(h/y.height);r>0&&(s.beginPath(),gr(s,M,f+a.cellVerticalPadding,k,h,r),s.save(),s.clip()),s.drawImage(y,M,f+a.cellVerticalPadding,k,h),r>0&&s.restore(),M+=k+Si}}function mh(e,t){let r=e*49632+t*325176;return r^=r<<13,r^=r>>17,r^=r<<5,r/4294967295*2}const vh={getAccessibilityString:()=>"",kind:pe.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{let{cell:t,col:r,row:n,ctx:o,rect:i,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let a=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(a+=Math.round(mh(r,n)*t.skeletonWidthVariability));let s=l.cellHorizontalPadding;a+s*2>=i.width&&(a=i.width-s*2-1);let c=t.skeletonHeight??Math.min(18,i.height-2*l.cellVerticalPadding);gr(o,i.x+s,i.y+(i.height-c)/2,a,c,l.roundingRadius??3),o.fillStyle=gn(l.textDark,.1),o.fill()},onPaste:()=>{}};var wh=()=>e=>e.targetWidth;const fa=Jt("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[wh(),"px"]}}),yh=e=>{let{value:t,onChange:r,forceEditMode:n,createNode:o,targetRect:i,onFinish:l,validatedSelection:a}=e,s=t.data,c=t.readonly===!0,[u,f]=d.useState(s===""||n),p=d.useCallback(()=>{f(h=>!h)},[]),m=s?"gdg-ml-6":"";return u?d.createElement(fa,{targetWidth:i.width-20},d.createElement(vo,{autoFocus:!0,highlight:!1,validatedSelection:a,value:s,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:r}),d.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${m}`,onClick:()=>l(t)},d.createElement(Rs,null))):d.createElement(fa,{targetWidth:i.width},d.createElement(zs,{contents:s,createNode:o}),!c&&d.createElement(d.Fragment,null,d.createElement("div",{className:"spacer"}),d.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${m}`,onClick:p},d.createElement(ri,null))),d.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},bh={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:pe.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:Bn,measure:(e,t,r)=>{let n=t.data.split(`
`)[0];return e.measureText(n).width+2*r.cellHorizontalPadding},draw:e=>Sr(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{let{onChange:t,value:r,target:n,onFinishedEditing:o,markdownDivCreateNode:i,forceEditMode:l,validatedSelection:a}=e;return d.createElement(yh,{onFinish:o,targetRect:n,value:r,validatedSelection:a,onChange:s=>t({...r,data:s.target.value}),forceEditMode:l,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},xh={getAccessibilityString:e=>e.row.toString(),kind:$r.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Ch,measure:()=>44,draw:e=>kh(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{let{bounds:t,cell:r,posX:n,posY:o}=e,{width:i,height:l}=t,a=r.drawHandle?7+(i-7)/2:i/2,s=l/2;if(Math.abs(n-a)<=10&&Math.abs(o-s)<=10)return{...r,checked:!r.checked}},onPaste:()=>{}};function Ch(e,t){let{ctx:r,theme:n}=e,o=n.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==o&&(r.font=o,i.font=o),i.deprep=Sh,r.textAlign="center",i}function Sh(e){let{ctx:t}=e;t.textAlign="start"}function kh(e,t,r,n,o,i){let{ctx:l,rect:a,hoverAmount:s,theme:c}=e,{x:u,y:f,width:p,height:m}=a,h=r?1:n==="checkbox-visible"?.6+.4*s:s;if(n!=="number"&&h>0){l.globalAlpha=h;let v=7*(r?s:1);if(mi(l,c,r,o?u+v:u,f,o?p-v:p,m,!0,void 0,void 0,18,"center",i),o){l.globalAlpha=s,l.beginPath();for(let S of[3,6])for(let M of[-5,-1,3])l.rect(u+S,f+m/2+M,2,2);l.fillStyle=c.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(n==="number"||n==="both"&&!r){let v=t.toString(),S=c.markerFontFull,M=u+p/2;n==="both"&&s!==0&&(l.globalAlpha=1-s),l.fillStyle=c.textLight,l.font=S,l.fillText(v,M,f+m/2+Hr(l,S)),s!==0&&(l.globalAlpha=1)}}const Mh={getAccessibilityString:()=>"",kind:$r.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Rh(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Rh(e,t,r){let{ctx:n,rect:o,hoverAmount:i,theme:l,spriteManager:a}=e,{x:s,y:c,width:u,height:f}=o;n.beginPath(),n.globalAlpha=i,n.rect(s+1,c+1,u,f-2),n.fillStyle=l.bgHeaderHovered,n.fill(),n.globalAlpha=1,n.beginPath();let p=t!=="",m=0;if(r!==void 0){let h=f-8,v=s+8/2,S=c+8/2;a.drawSprite(r,"normal",n,v,S,h,l,p?1:i),m=h}else{m=24;let h=p?12:i*12,v=p?0:(1-i)*12*.5,S=l.cellHorizontalPadding+4;h>0&&(n.moveTo(s+S+v,c+f/2),n.lineTo(s+S+v+h,c+f/2),n.moveTo(s+S+v+h*.5,c+f/2-h*.5),n.lineTo(s+S+v+h*.5,c+f/2+h*.5),n.lineWidth=2,n.strokeStyle=l.bgIconHeader,n.lineCap="round",n.stroke())}n.fillStyle=l.textMedium,n.fillText(t,m+s+l.cellHorizontalPadding+.5,c+f/2+Hr(n,l)),n.beginPath()}function ga(e,t,r,n,o,i,l){e.textBaseline="alphabetic";let a=Eh(e,o,n,t,(r==null?void 0:r.fullSize)??!1);e.beginPath(),gr(e,a.x,a.y,a.width,a.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(r==null?void 0:r.bgColor)??gn(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function Eh(e,t,r,n,o){let i=n.cellHorizontalPadding,l=n.cellVerticalPadding;if(o)return{x:t.x+i/2,y:t.y+l/2+1,width:t.width-i,height:t.height-l-1};let a=wn(r,e,n.baseFontFull,"alphabetic"),s=t.height-l,c=Math.min(s,a.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-c)/2+1,width:a.width+i*3,height:c-1}}var Ih=d.lazy(async()=>await Ja(()=>import("./number-overlay-editor-Ausf18nY.js").then(async e=>(await e.__tla,e)),__vite__mapDeps([7,4,5,2,3]),import.meta.url));const Th={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:pe.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:Bn,draw:e=>{let{hoverAmount:t,cell:r,ctx:n,theme:o,rect:i,overrideCursor:l}=e,{hoverEffect:a,displayData:s,hoverEffectTheme:c}=r;a===!0&&t>0&&ga(n,o,c,s,i,t,l),Sr(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,r)=>e.measureText(t.displayData).width+r.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{let{isHighlighted:t,onChange:r,value:n,validatedSelection:o}=e;return d.createElement(d.Suspense,{fallback:null},d.createElement(Ih,{highlight:t,disabled:n.readonly===!0,value:n.data,fixedDecimals:n.fixedDecimals,allowNegative:n.allowNegative,thousandSeparator:n.thousandSeparator,decimalSeparator:n.decimalSeparator,validatedSelection:o,onChange:i=>r({...n,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,r)=>{let n=typeof r.rawValue=="number"?r.rawValue:Number.parseFloat(typeof r.rawValue=="string"?r.rawValue:e);if(!(Number.isNaN(n)||t.data===n))return{...t,data:n,displayData:r.formattedString??t.displayData}}},Oh={getAccessibilityString:()=>"",measure:()=>108,kind:pe.Protected,needsHover:!1,needsHoverPosition:!1,draw:Ph,onPaste:()=>{}};function Ph(e){let{ctx:t,theme:r,rect:n}=e,{x:o,y:i,height:l}=n;t.beginPath();let a=2.5,s=o+r.cellHorizontalPadding+a,c=i+l/2,u=Math.cos(Qi(30))*a,f=Math.sin(Qi(30))*a;for(let p=0;p<12;p++)t.moveTo(s,c-a),t.lineTo(s,c+a),t.moveTo(s+u,c-f),t.lineTo(s-u,c+f),t.moveTo(s-u,c-f),t.lineTo(s+u,c+f),s+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=r.textLight,t.stroke()}const Hh={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:pe.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>Bn(e,t,e.theme.textLight),draw:e=>Sr(e,e.cell.data,e.cell.contentAlign),measure:(e,t,r)=>e.measureText(t.data).width+r.cellHorizontalPadding*2,provideEditor:()=>e=>{let{isHighlighted:t,onChange:r,value:n,validatedSelection:o}=e;return d.createElement(vo,{highlight:t,autoFocus:n.readonly!==!0,disabled:n.readonly!==!1,value:n.data,validatedSelection:o,onChange:i=>r({...n,data:i.target.value})})},onPaste:()=>{}},Dh={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:pe.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:Bn,useLabel:!0,draw:e=>{let{cell:t,hoverAmount:r,hyperWrapping:n,ctx:o,rect:i,theme:l,overrideCursor:a}=e,{displayData:s,contentAlign:c,hoverEffect:u,allowWrapping:f,hoverEffectTheme:p}=t;u===!0&&r>0&&ga(o,l,p,s,i,r,a),Sr(e,s,c,f,n)},measure:(e,t,r)=>{let n=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1),o=0;for(let i of n)o=Math.max(o,e.measureText(i).width);return o+2*r.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{let{isHighlighted:r,onChange:n,value:o,validatedSelection:i}=t;return d.createElement(vo,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:r,autoFocus:o.readonly!==!0,disabled:o.readonly===!0,altNewline:!0,value:o.data,validatedSelection:i,onChange:l=>n({...o,data:l.target.value})})}}),onPaste:(e,t,r)=>e===t.data?void 0:{...t,data:e,displayData:r.formattedString??t.displayData}},zh=Jt("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1});var Ah=e=>{let{uri:t,onChange:r,forceEditMode:n,readonly:o,validatedSelection:i,preview:l}=e,[a,s]=d.useState(!o&&(t===""||n)),c=d.useCallback(()=>{s(!0)},[]);return a?d.createElement(vo,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:r}):d.createElement(zh,null,d.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!o&&d.createElement("div",{className:"gdg-edit-icon",onClick:c},d.createElement(ri,null)),d.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function pa(e,t,r,n){let o=r.cellHorizontalPadding,i=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,a=e.actualBoundingBoxAscent;return n==="right"?o=t.width-l-r.cellHorizontalPadding:n==="center"&&(o=t.width/2-l/2),{x:o,y:i,width:l,height:a}}function ma(e){let{cell:t,bounds:r,posX:n,posY:o,theme:i}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;let a=dl(l,i.baseFontFull);if(a===void 0)return!1;let s=pa(a,r,i,t.contentAlign);return qr({x:s.x-4,y:s.y-4,width:s.width+8,height:s.height+8},n,o)}const Lh=[xh,Mh,th,ih,uh,gh,vh,bh,Th,Oh,Hh,Dh,{getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:pe.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:Bn,draw:e=>{let{cell:t,theme:r,overrideCursor:n,hoverX:o,hoverY:i,rect:l,ctx:a}=e,s=t.displayData??t.data,c=t.hoverEffect===!0;if(n!==void 0&&c&&o!==void 0&&i!==void 0){let{x:u,y:f,width:p,height:m}=pa(wn(s,a,r.baseFontFull),l,r,t.contentAlign);if(o>=u-4&&o<=u-4+p+8&&i>=f-4&&i<=f-4+m+8){let h=Hr(a,r.baseFontFull);n("pointer");let v=f-h;a.beginPath(),a.moveTo(l.x+u,Math.floor(l.y+v+m+5)+.5),a.lineTo(l.x+u+p,Math.floor(l.y+v+m+5)+.5),a.strokeStyle=r.linkColor,a.stroke(),a.save(),a.fillStyle=e.cellFillColor,Sr({...e,rect:{...l,x:l.x-1}},s,t.contentAlign),Sr({...e,rect:{...l,x:l.x-2}},s,t.contentAlign),Sr({...e,rect:{...l,x:l.x+1}},s,t.contentAlign),Sr({...e,rect:{...l,x:l.x+2}},s,t.contentAlign),a.restore()}}a.fillStyle=c?r.linkColor:r.textDark,Sr(e,s,t.contentAlign)},onSelect:e=>{ma(e)&&e.preventDefault()},onClick:e=>{var r;let{cell:t}=e;ma(e)&&((r=t.onClickUri)==null||r.call(t,e))},measure:(e,t,r)=>e.measureText(t.displayData??t.data).width+r.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{let{onChange:r,value:n,forceEditMode:o,validatedSelection:i}=t;return d.createElement(Ah,{forceEditMode:n.readonly!==!0&&(o||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:n.data,preview:n.displayData??n.data,validatedSelection:i,readonly:n.readonly===!0,onChange:l=>r({...n,data:l.target.value})})},onPaste:(e,t,r)=>e===t.data?void 0:{...t,data:e,displayData:r.formattedString??t.displayData}}];var Fh=Gt(X(((e,t)=>{var r=ti(),n=ho(),o="Expected a function";function i(l,a,s){var c=!0,u=!0;if(typeof l!="function")throw TypeError(o);return n(s)&&(c="leading"in s?!!s.leading:c,u="trailing"in s?!!s.trailing:u),r(l,a,{leading:c,maxWait:a,trailing:u})}t.exports=i}))(),1),ki=[],jh=class extends vl{constructor(){super(...arguments);tt(this,"imageLoaded",()=>{});tt(this,"loadedLocations",[]);tt(this,"cache",{});tt(this,"sendLoaded",(0,Fh.default)(()=>{this.imageLoaded(new $n(this.loadedLocations)),this.loadedLocations=[]},20));tt(this,"clearOutOfWindow",()=>{let t=Object.keys(this.cache);for(let r of t){let n=this.cache[r],o=!1;for(let i=0;i<n.cells.length;i++){let l=n.cells[i];if(this.isInWindow(l)){o=!0;break}}o?n.cells=n.cells.filter(this.isInWindow):(n.cancel(),delete this.cache[r])}})}setCallback(t){this.imageLoaded=t}loadImage(t,r,n,o){let i=!1,l=ki.pop()??new Image,a=!1,s={img:void 0,cells:[or(r,n)],url:t,cancel:()=>{a||(a=!0,ki.length<12?ki.unshift(l):i||(l.src=""))}},c=new Promise(u=>l.addEventListener("load",()=>u(null)));requestAnimationFrame(async()=>{try{l.src=t,await c,await l.decode();let u=this.cache[o];if(u!==void 0&&!a){u.img=l;for(let f of u.cells)this.loadedLocations.push(ui(f));i=!0,this.sendLoaded()}}catch{s.cancel()}}),this.cache[o]=s}loadOrGetImage(t,r,n){let o=t,i=this.cache[o];if(i!==void 0){let l=or(r,n);return i.cells.includes(l)||i.cells.push(l),i.img}else this.loadImage(t,r,n,o)}};const _h=d.forwardRef((e,t)=>{let r=d.useMemo(()=>({...Pc,...e.headerIcons}),[e.headerIcons]),n=d.useMemo(()=>e.imageWindowLoader??new jh,[e.imageWindowLoader]);return d.createElement(eh,{...e,renderers:Lh,headerIcons:r,ref:t,imageWindowLoader:n})});function Nh(e){switch(e){case"string":return pe.Text;case"number":return pe.Number;case"boolean":return pe.Boolean;default:return pe.Text}}function Wh(e){switch(e){case"string":return Vr.HeaderString;case"number":case"integer":return Vr.HeaderNumber;case"boolean":return Vr.HeaderBoolean;case"date":case"datetime":return Vr.HeaderDate;case"time":return Vr.HeaderTime;case"unknown":return Vr.HeaderString;default:return Va(e),Vr.HeaderString}}function va(e){return"rowIdx"in e&&"columnId"in e&&"value"in e}function Bh(e){return"rowIdx"in e&&"type"in e}function $h(e){return"columnIdx"in e&&"type"in e}function Vh(e){let{selection:t,data:r,setData:n,onAddEdits:o,columns:i,editableColumns:l}=e;if(!t.current)return;let{range:a}=t.current,{x:s,y:c}=a;navigator.clipboard.readText().then(u=>{if(!u.trim())return;let f=u.split(`
`).filter(h=>h.trim()),p=[];for(let h of f){let v=h.split("	");p.push(v)}if(p.length===0)return;let m=[];for(let[h,v]of p.entries()){if(!v)continue;let S=c+h;if(S>=r.length)break;for(let[M,y]of v.entries()){if(y===void 0)continue;let k=s+M;if(!i||k>=i.length)break;let I=i[k],O=I.dataType;if(!(l==="all"||l.includes(I.title)))continue;let E=y;switch(O){case"integer":case"number":{let F=Number(y);if(Number.isNaN(F))continue;E=F;break}case"boolean":{let F=y.toLowerCase();E=F==="true"||F==="1";break}}let A=i[k].title;m.push({rowIdx:S,columnId:A,value:E})}}m.length>0&&(o(m),n(h=>{let v=[...h];for(let S of m)if(va(S)){let M=S.rowIdx,y=S.columnId;if(M<v.length){let k=v[M];y in k&&(k[y]=S.value)}}return v}))}).catch(u=>{Wi.error("Failed to read clipboard data",u)})}function Kh(e){return e==="light"?{lineHeight:1.25}:{lineHeight:1.25,accentColor:"#7c3aed",accentLight:"rgba(124, 58, 237, 0.15)",textDark:"#f4f4f5",textMedium:"#a1a1aa",textLight:"#71717a",textBubble:"#f4f4f5",bgIconHeader:"#a1a1aa",fgIconHeader:"#18181b",textHeader:"#d4d4d8",textHeaderSelected:"#18181b",bgCell:"#18181b",bgCellMedium:"#27272a",bgHeader:"#27272a",bgHeaderHasFocus:"#3f3f46",bgHeaderHovered:"#3f3f46",bgBubble:"#27272a",bgBubbleSelected:"#7c3aed",bgSearchResult:"#312e81",borderColor:"#27272a",drilldownBorder:"#7c3aed",linkColor:"#818cf8",headerFontStyle:"bold 14px",baseFontStyle:"13px"}}var wa=M0(),Fe=Gt(I0(),1);const Yh=e=>{let t=(0,wa.c)(19),{currentColumnName:r,onRename:n,onCancel:o}=e,[i,l]=(0,d.useState)(""),a;t[0]!==r||t[1]!==i||t[2]!==n?(a=()=>{i.trim()&&(n(i.trim()),l(r))},t[0]=r,t[1]=i,t[2]=n,t[3]=a):a=t[3];let s=a,c;t[4]!==s||t[5]!==o?(c=y=>{y.key==="Enter"?s():y.key==="Escape"&&o()},t[4]=s,t[5]=o,t[6]=c):c=t[6];let u=c,f;t[7]===Symbol.for("react.memo_cache_sentinel")?(f=(0,Fe.jsxs)(Ua,{children:[(0,Fe.jsx)(_0,{className:"mr-2 h-3.5 w-3.5"}),"Rename column"]}),t[7]=f):f=t[7];let p;t[8]===Symbol.for("react.memo_cache_sentinel")?(p=(0,Fe.jsx)(Vi,{htmlFor:"rename-input",children:"Column name"}),t[8]=p):p=t[8];let m;t[9]===Symbol.for("react.memo_cache_sentinel")?(m=y=>l(y.target.value),t[9]=m):m=t[9];let h;t[10]!==u||t[11]!==i?(h=(0,Fe.jsxs)("div",{children:[p,(0,Fe.jsx)(Za,{value:i,onChange:m,placeholder:"Enter new column name",className:"mt-1",onKeyDown:u})]}),t[10]=u,t[11]=i,t[12]=h):h=t[12];let v=!i.trim(),S;t[13]!==s||t[14]!==v?(S=(0,Fe.jsx)($i,{onClick:s,disabled:v,size:"sm",className:"w-full",children:"Rename"}),t[13]=s,t[14]=v,t[15]=S):S=t[15];let M;return t[16]!==h||t[17]!==S?(M=(0,Fe.jsxs)(qa,{children:[f,(0,Fe.jsx)(Xa,{children:(0,Fe.jsx)(Ga,{className:"w-64 p-4",children:(0,Fe.jsxs)("div",{className:"space-y-3",children:[h,S]})})})]}),t[16]=h,t[17]=S,t[18]=M):M=t[18],M},ya=e=>{let t=(0,wa.c)(77),{direction:r,onAdd:n,onCancel:o}=e,[i,l]=(0,d.useState)(""),[a,s]=(0,d.useState)("string"),c,u,f,p,m,h,v,S,M,y,k,I,O,E,A;if(t[0]!==i||t[1]!==a||t[2]!==r||t[3]!==n||t[4]!==o){let J=["string","number","boolean","datetime"],_;t[20]!==i||t[21]!==a||t[22]!==n?(_=()=>{i.trim()&&(n(i.trim(),a),l(""),s("string"))},t[20]=i,t[21]=a,t[22]=n,t[23]=_):_=t[23],h=_;let Z;t[24]!==h||t[25]!==o?(Z=te=>{te.key==="Enter"?h():te.key==="Escape"&&o()},t[24]=h,t[25]=o,t[26]=Z):Z=t[26];let ee=Z;m=qa;let V;t[27]===Symbol.for("react.memo_cache_sentinel")?(V=(0,Fe.jsx)(N0,{className:"mr-2 h-3.5 w-3.5"}),t[27]=V):V=t[27],t[28]===r?A=t[29]:(A=(0,Fe.jsxs)(Ua,{children:[V,"Add column to the ",r]}),t[28]=r,t[29]=A),p=Xa,f=Ga,E="w-64 p-4",I="space-y-3";let ae=`add-column-input-${r}`,ne;t[30]===ae?ne=t[31]:(ne=(0,Fe.jsx)(Vi,{htmlFor:ae,children:"Column name"}),t[30]=ae,t[31]=ne);let ce=`add-column-input-${r}`,ue;t[32]===Symbol.for("react.memo_cache_sentinel")?(ue=te=>l(te.target.value),t[32]=ue):ue=t[32];let G;t[33]!==i||t[34]!==ee||t[35]!==ce?(G=(0,Fe.jsx)(Za,{id:ce,value:i,onChange:ue,placeholder:"Enter column name",className:"mt-1",onKeyDown:ee}),t[33]=i,t[34]=ee,t[35]=ce,t[36]=G):G=t[36],t[37]!==ne||t[38]!==G?(O=(0,Fe.jsxs)("div",{children:[ne,G]}),t[37]=ne,t[38]=G,t[39]=O):O=t[39];let ye=`add-column-type-${r}`;t[40]===ye?k=t[41]:(k=(0,Fe.jsx)(Vi,{htmlFor:ye,children:"Data type"}),t[40]=ye,t[41]=k),u=A0,S=a,t[42]===Symbol.for("react.memo_cache_sentinel")?(M=te=>s(te),t[42]=M):M=t[42];let Q=`add-column-type-${r}`,ie;t[43]===Symbol.for("react.memo_cache_sentinel")?(ie=(0,Fe.jsx)(P0,{}),t[43]=ie):ie=t[43],t[44]===Q?y=t[45]:(y=(0,Fe.jsx)(z0,{id:Q,className:"mt-1",children:ie}),t[44]=Q,t[45]=y),c=D0,v=J.map(Gh),t[0]=i,t[1]=a,t[2]=r,t[3]=n,t[4]=o,t[5]=c,t[6]=u,t[7]=f,t[8]=p,t[9]=m,t[10]=h,t[11]=v,t[12]=S,t[13]=M,t[14]=y,t[15]=k,t[16]=I,t[17]=O,t[18]=E,t[19]=A}else c=t[5],u=t[6],f=t[7],p=t[8],m=t[9],h=t[10],v=t[11],S=t[12],M=t[13],y=t[14],k=t[15],I=t[16],O=t[17],E=t[18],A=t[19];let F;t[46]!==c||t[47]!==v?(F=(0,Fe.jsx)(c,{children:v}),t[46]=c,t[47]=v,t[48]=F):F=t[48];let C;t[49]!==u||t[50]!==F||t[51]!==S||t[52]!==M||t[53]!==y?(C=(0,Fe.jsxs)(u,{value:S,onValueChange:M,children:[y,F]}),t[49]=u,t[50]=F,t[51]=S,t[52]=M,t[53]=y,t[54]=C):C=t[54];let R;t[55]!==C||t[56]!==k?(R=(0,Fe.jsxs)("div",{children:[k,C]}),t[55]=C,t[56]=k,t[57]=R):R=t[57];let L=!i.trim(),x;t[58]!==h||t[59]!==L?(x=(0,Fe.jsx)($i,{onClick:h,disabled:L,size:"sm",className:"w-full",children:"Add"}),t[58]=h,t[59]=L,t[60]=x):x=t[60];let w;t[61]!==R||t[62]!==x||t[63]!==I||t[64]!==O?(w=(0,Fe.jsxs)("div",{className:I,children:[O,R,x]}),t[61]=R,t[62]=x,t[63]=I,t[64]=O,t[65]=w):w=t[65];let T;t[66]!==f||t[67]!==w||t[68]!==E?(T=(0,Fe.jsx)(f,{className:E,children:w}),t[66]=f,t[67]=w,t[68]=E,t[69]=T):T=t[69];let P;t[70]!==p||t[71]!==T?(P=(0,Fe.jsx)(p,{children:T}),t[70]=p,t[71]=T,t[72]=P):P=t[72];let b;return t[73]!==m||t[74]!==P||t[75]!==A?(b=(0,Fe.jsxs)(m,{children:[A,P]}),t[73]=m,t[74]=P,t[75]=A,t[76]=b):b=t[76],b};function Gh(e){return(0,Fe.jsx)(H0,{value:e,children:R0(e)},e)}function ba(e,t){return e.map(r=>{let n=r,o=Object.keys(n);if(t<0||t>=o.length)return n;let i=o[t],{[i]:l,...a}=n;return a})}function xa(e,t){return t?e.map(r=>({...r,[t]:""})):e}function Ca(e,t,r){return!t||!r||t===r?e:e.map(n=>{let o=n,{[t]:i,...l}=o;return{...l,[r]:o[t]}})}function xn(e){var l;let{columnFields:t,columnIdx:r,type:n,dataType:o,newColumnName:i}=e;switch(n){case"insert":{if(!i)return Wi.error("newName is required for insert"),t;let a=Object.entries(t),s=[...a.slice(0,r),[i,o||"string"],...a.slice(r)];return Object.fromEntries(s)}case"remove":{if(r<0||r>=Object.keys(t).length)return t;let a=(l=Object.entries(t)[r])==null?void 0:l[0];if(a){let{[a]:s,...c}=t;return c}return t}case"rename":{if(!i)return Wi.error("newName is required for rename"),t;if(r<0||r>=Object.keys(t).length)return t;let a=Object.entries(t),s=[...a.slice(0,r),[i,o||"string"],...a.slice(r+1)];return Object.fromEntries(s)}}}Ui=({data:e,setData:t,columnFields:r,setColumnFields:n,editableColumns:o,edits:i,onAddEdits:l,onAddRows:a,onDeleteRows:s,onRenameColumn:c,onDeleteColumn:u,onAddColumn:f})=>{let{theme:p}=$0(),m=(0,d.useRef)(null),[h,v]=(0,d.useState)(),[S,M]=(0,d.useState)(!1),[y,k]=d.useState({columns:nt.empty(),rows:nt.empty()}),[I,O]=(0,d.useState)({}),E=O0(),A=(0,d.useRef)(!1),F=(0,d.useMemo)(()=>{let Q=[];for(let[ie,te]of Object.entries(r)){let de=o==="all"||o.includes(ie);Q.push({id:ie,title:ie,width:I[ie],icon:de?Wh(te):Vr.ProtectedColumnOverlay,style:"normal",kind:Nh(te),dataType:te,hasMenu:!0,themeOverride:de?void 0:{bgCell:p==="light"?"#F9F9FA":"#1e1e21"}})}return Q},[r,I,o,p]);(0,d.useEffect)(()=>{if(A.current||e.length===0||(A.current=!0,i.length===0))return;let Q=new Map;for(let te of i)if(va(te))if(te.rowIdx>=e.length){Q.has(te.rowIdx)||Q.set(te.rowIdx,{});let de=Q.get(te.rowIdx);de&&(de[te.columnId]=te.value)}else t(de=>{let Pe=[...de];return Pe[te.rowIdx][te.columnId]=te.value,Pe});else if(Bh(te)&&te.type===Xo.Remove)t(de=>de.filter((Pe,be)=>be!==te.rowIdx));else if($h(te))switch(te.type){case Xo.Remove:t(de=>ba(de,te.columnIdx)),n(de=>xn({columnFields:de,columnIdx:te.columnIdx,type:"remove"}));break;case Xo.Insert:n(de=>xn({columnFields:de,columnIdx:te.columnIdx,type:"insert",newColumnName:te.newName})),t(de=>xa(de,te.newName));break;case Xo.Rename:{let de=F[te.columnIdx].title,Pe=te.newName;if(!de||!Pe)return;n(be=>xn({columnFields:be,columnIdx:te.columnIdx,type:"rename",newColumnName:Pe})),t(be=>Ca(be,de,Pe));break}}let ie=[...Q.entries()].sort(([te],[de])=>te-de).map(([,te])=>te);ie.length>0&&t(te=>[...te,...ie]),E()},[e.length]);let C=(0,d.useCallback)(Q=>{let[ie,te]=Q,de=e[te][F[ie].title],Pe=F[ie].kind,be=o==="all"||o.includes(F[ie].title);if(Pe===pe.Boolean){let De=!!de;return{kind:pe.Boolean,allowOverlay:!1,readonly:!be,data:De}}return Pe===pe.Number&&typeof de=="number"?{kind:pe.Number,allowOverlay:be,readonly:!be,displayData:String(de),data:de}:{kind:pe.Text,allowOverlay:be,readonly:!be,displayData:String(de),data:String(de)}},[F,e,o]),R=(0,d.useCallback)((Q,ie)=>{let[te,de]=Q,Pe=F[te],be=Pe.title,De=ie.data;(Pe.dataType==="number"||Pe.dataType==="integer")&&(ie.data===void 0||ie.data==="")&&(De=null),t(Ie=>{let st=[...Ie];return st[de][be]=De,st}),l([{rowIdx:de,columnId:be,value:De}])},[F,l,t]),L=(0,d.useCallback)((Q,ie)=>{O(te=>({...te,[Q.title]:ie}))},[]),x=(0,d.useCallback)((Q,ie,te)=>{let[de,Pe]=Q;switch(r[F[de].title]){case"number":case"integer":if(Number.isNaN(Number(ie.data)))return!1;break;case"boolean":if(typeof ie.data!="boolean")return!1;break}return!0},[r,F]),w=(0,d.useCallback)(Q=>{if(m.current){if(Bi.isMetaOrCtrl(Q)&&Q.key==="c"){m.current.emit("copy");return}if(Bi.isMetaOrCtrl(Q)&&Q.key==="v"){Vh({selection:y,data:e,setData:t,columns:F,editableColumns:o,onAddEdits:l});return}if(Bi.isMetaOrCtrl(Q)&&Q.key==="f"){M(ie=>!ie),Q.stopPropagation(),Q.preventDefault();return}if(Q.key==="Escape"){M(!1);return}}},[F,e,o,l,y,t]),T=(0,d.useCallback)(()=>{let Q=Object.fromEntries(F.map(ie=>{let te=ie.dataType;switch(te){case"boolean":return[ie.title,!1];case"number":case"integer":return[ie.title,null];case"date":case"datetime":case"time":return[ie.title,new Date];case"string":case"unknown":return[ie.title,""];default:return Va(te),[ie.title,""]}}));a([Q]),t(ie=>[...ie,Q])},[F,a,t]),P=()=>{let Q=y.rows.toArray();s(Q);let ie=0;for(let te of Q){let de=te-ie;t(Pe=>Pe.filter((be,De)=>De!==de)),ie++}k({columns:nt.empty(),rows:nt.empty()})},b=k0((Q,ie)=>{v({col:Q,bounds:ie})}),J=async()=>{if(h){let Q=F[h.col].title;await V0(Q),v(void 0)}};function _(Q){B0({title:`Column '${Q}' already exists`,description:"Please enter a different column name",variant:"danger"})}let Z=Q=>{if(h){let ie=F[h.col].title;if(r[Q]){_(Q);return}let te=F[h.col].dataType;c(h.col,Q),n(de=>xn({columnFields:de,columnIdx:h.col,type:"rename",dataType:te,newColumnName:Q})),t(de=>Ca(de,ie,Q)),v(void 0)}},ee=()=>{h&&(u(h.col),n(Q=>xn({columnFields:Q,columnIdx:h.col,type:"remove"})),t(Q=>ba(Q,h.col)),v(void 0))},V=Q=>{let{direction:ie,columnName:te,dataType:de}=Q;if(h){let Pe=h.col+(ie==="left"?0:1),be=Math.max(0,Math.min(Pe,F.length));if(r[te]){_(te);return}f(be,te),n(De=>xn({columnFields:De,columnIdx:be,type:"insert",dataType:de,newColumnName:te})),t(De=>xa(De,te)),v(void 0)}},ae=(h==null?void 0:h.col)===F.length-1,ne=h!==void 0,ce="mr-2 h-3.5 w-3.5",ue={hint:"New row",sticky:!0,tint:!0},G=e.length>1e5,ye=o==="all";return(0,Fe.jsxs)("div",{className:"relative w-full min-w-0",children:[(0,Fe.jsx)(E0,{children:(0,Fe.jsx)(_h,{ref:m,getCellContent:C,columns:F,gridSelection:y,onGridSelectionChange:k,rows:e.length,overscrollX:50,smoothScrollX:!G,smoothScrollY:!G,validateCell:x,getCellsForSelection:!0,onPaste:!0,showSearch:S,fillHandle:!0,allowedFillDirections:"vertical",onKeyDown:w,height:e.length>10?450:void 0,width:"100%",rowMarkers:{kind:"both"},rowSelectionMode:"multi",onCellEdited:R,onColumnResize:L,onHeaderMenuClick:b,theme:Kh(p),trailingRowOptions:ue,onRowAppended:T,maxColumnAutoWidth:600,maxColumnWidth:600})}),(()=>{if(!ne)return;let Q=(0,Fe.jsxs)(Fe.Fragment,{children:[ye&&(0,Fe.jsx)(Yh,{currentColumnName:F[h.col].title,onRename:Z,onCancel:()=>v(void 0)}),(0,Fe.jsx)(Ya,{}),(0,Fe.jsx)(ya,{direction:"left",onAdd:(ie,te)=>V({direction:"left",columnName:ie,dataType:te}),onCancel:()=>v(void 0)}),(0,Fe.jsx)(ya,{direction:"right",onAdd:(ie,te)=>V({direction:"right",columnName:ie,dataType:te}),onCancel:()=>v(void 0)}),(0,Fe.jsx)(Ya,{}),!ae&&ye&&(0,Fe.jsxs)(Ka,{onClick:ee,className:"text-destructive focus:text-destructive",children:[(0,Fe.jsx)(W0,{className:ce}),"Delete column"]})]});return(0,Fe.jsx)(F0,{open:ne,onOpenChange:ie=>!ie&&v(void 0),children:(0,Fe.jsxs)(L0,{style:{left:(h==null?void 0:h.bounds.x)??0,top:((h==null?void 0:h.bounds.y)??0)+((h==null?void 0:h.bounds.height)??0)},className:"fixed w-52",children:[(0,Fe.jsxs)(Ka,{onClick:J,children:[(0,Fe.jsx)(j0,{className:ce}),"Copy column name"]}),!G&&Q]})})})(),(0,Fe.jsx)("div",{className:"absolute bottom-1 right-2 w-26",children:(0,Fe.jsx)($i,{variant:"destructive",size:"sm",disabled:y.rows.length===0,className:"right-2 h-7",onClick:P,children:y.rows.length<=1?"Delete row":"Delete rows"})})]})},fs=Ui})();export{Ui as GlideDataEditor,nf as __tla,fs as default};
